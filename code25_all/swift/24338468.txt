import Cocoa

@IBDesignable class PreviousTrackButton: NSButton {

    @IBInspectable var dx: CGFloat = 10
    @IBInspectable var dy: CGFloat = 10

    override func awakeFromNib() {
        super.awakeFromNib()

        var imageframe = NSInsetRect(self.bounds, dx, dy)

        let buttonImage = NSImage(size: imageframe.size, flipped: false, drawingHandler: {imageframe in

        NSGraphicsContext.saveGraphicsState()

        var fillColor = NSColor.whiteColor()

        println("000") // log does not in consol. 

        let point1 = NSPoint(x: NSMinX(imageframe), y: NSMidY(imageframe))
        let point2 = NSPoint(x: NSMidX(imageframe), y: NSMaxY(imageframe))
        let point3 = NSPoint(x: NSMidX(imageframe), y: NSMidY(imageframe))
        let point4 = NSPoint(x: NSMaxX(imageframe), y: NSMaxY(imageframe))
        let point5 = NSPoint(x: NSMaxX(imageframe), y: NSMinY(imageframe))
        let point6 = NSPoint(x: NSMidX(imageframe), y: NSMinY(imageframe))

        let path = NSBezierPath()
        path.moveToPoint(point1)
        path.lineToPoint(point2)
        path.lineToPoint(point3)
        path.lineToPoint(point4)
        path.lineToPoint(point5)
        path.lineToPoint(point3)
        path.lineToPoint(point6)
        path.lineToPoint(point1)
        path.closePath()
        fillColor.setFill()
        path.fill()

        NSGraphicsContext.restoreGraphicsState()

        return true
            })
        self.image = buttonImage
        println("buttonImage")  // buttonImage not nil and have an appropriate size

    }

}

