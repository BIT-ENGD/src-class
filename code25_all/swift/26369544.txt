func addPubNubMessageToThread(notification: NSNotification) {
    if let info = notification.userInfo as? Dictionary<String, AnyObject> {

        var embeddedMessage = Message(json: (info["data"] as? NSDictionary)!)

        let threadId = (info["thread"]! as String)

        // Persist the message to Realm for future use
        var respectiveThread = Thread(forPrimaryKey: threadId)
        let realm = RLMRealm.defaultRealm()
        realm.beginWriteTransaction()
        respectiveThread.conversation.insertObject(embeddedMessage, atIndex: UInt(0)) // Always fails here in XCode with the error below
        realm.addOrUpdateObject(respectiveThread)
        realm.commitWriteTransaction()
    }
}

 *** Terminating app due to uncaught exception 'RLMException', reason: 'Setting unique property '_id' with existing value '540729b543dd5d1868a42b5d''

class Message: RLMObject {
    dynamic var _id = ""
    dynamic var type = ""
    dynamic var text = ""
    dynamic var author = User()
    dynamic var created = NSDate()
    dynamic var lastUpdated = NSDate()
}

class Thread: RLMObject {
    dynamic var _id = ""
    dynamic var name = ""
    dynamic var conversation = RLMArray(objectClassName: Message.className())
    dynamic var participants = RLMArray(objectClassName: User.className())
    dynamic var created = NSDate()
    dynamic var lastUpdated = NSDate()
}

class User: RLMObject {
    dynamic var _id = ""
    dynamic var name = ""
    dynamic var firstName = ""
    dynamic var lastName = ""
    dynamic var email = ""
    dynamic var phone = ""
    dynamic var username = ""
    dynamic var avatar = NSData()
    dynamic var created = NSDate()
    dynamic var lastUpdated = NSDate()
}

_id
_id
override class func primaryKey() -> String {
    return "_id"
}

_id
