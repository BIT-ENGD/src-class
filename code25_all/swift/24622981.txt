import UIKit
import CoreMotion
import MediaPlayer
import SpriteKit

class MainViewController: UIViewController, UICollectionViewDataSource, UICollectionViewDelegate {


    var containerView : UIView?        
    var collectionView : UICollectionView?        

    var card : UIView?
    var fishArray = NSMutableArray()

    var cellCount = 20

    init(nibName nibNameOrNil: String?, bundle nibBundleOrNil: NSBundle?) {
        super.init(nibName: nibNameOrNil, bundle: nibBundleOrNil)
    }

    override func viewDidLoad() {
        super.viewDidLoad()

        self.view.backgroundColor = UIColor.blackColor()


        ////// COLLECTION VIEW

        var tapGestureRecognizer = UITapGestureRecognizer(target: self, action: "tappiDiTap:")

        var layout = FishFlowLayout()
        collectionView = UICollectionView(frame: CGRectMake(96/2,352/2,1857/2,1117/2), collectionViewLayout: layout)
        collectionView!.delegate = self
        collectionView!.dataSource = self
        collectionView!.addGestureRecognizer(tapGestureRecognizer)
        collectionView!.registerClass(FishCollectionViewCell.self, forCellWithReuseIdentifier: "cellID")
        self.view.insertSubview(collectionView!, belowSubview:scaleBackground!)

        for i in 0..9 {
            fishArray.addObject("Fish: \(i)")
        }


    }


    func tappiDiTap(tapGestureRecognizer : UITapGestureRecognizer) {
        if (tapGestureRecognizer.state == .Ended) {
            var initialPinchPoint : CGPoint = tapGestureRecognizer.locationInView(self.collectionView)
            var tappedCellPath : NSIndexPath = self.collectionView!.indexPathForItemAtPoint(initialPinchPoint)

            if (tappedCellPath==nil) {
                self.cellCount = self.cellCount+1
                self.collectionView!.backgroundColor = UIColor.blackColor()
            } else  {
                self.collectionView!.backgroundColor = UIColor.blueColor()
                println(slef.collectionView!.numberOfSections)
            }
        }
    }

    //////////////////COLLECTIONVIEW DELEGATE METHODS

    func collectionView(collectionView : UICollectionView!, numberOfItemsInSection section: Int) -> Int {
        return cellCount
    }

    func collectionView(collectionView : UICollectionView!, cellForItemAtIndexPath indexPath: NSIndexPath!) -> UICollectionViewCell! {
        var cell = collectionView.dequeueReusableCellWithReuseIdentifier("cellID", forIndexPath: indexPath) as FishCollectionViewCell
        return cell
    }

    override func didReceiveMemoryWarning() {
        super.didReceiveMemoryWarning()
    }
}

import UIKit

class FishFlowLayout: UICollectionViewFlowLayout {

    init() {
        super.init()

        self.scrollDirection = UICollectionViewScrollDirection.Vertical
        self.itemSize = CGSizeMake(220,270)
       self.minimumLineSpacing = 18
        self.sectionInset = UIEdgeInsetsMake(0,0,0,0)
    }

}

import UIKit

class FishCollectionViewCell: UICollectionViewCell {

    init(frame: CGRect) {
        super.init(frame: frame)
        self.layer.cornerRadius = 5

        var card = Card(frame: self.bounds)
        self.addSubview(card)
    }

}

