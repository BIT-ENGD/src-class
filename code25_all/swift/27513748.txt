func scrollViewDidScroll(scrollview: UIScrollView) {
    // Get image offset
    var pageSize: Float = Float(scrollView.bounds.size.width)
    var page: Float = floorf((Float(scrollview.contentOffset.x) - pageSize / 2.0) / pageSize) + 1

    if (page >= Float(levelPagesCount)) {
        page = Float(levelPagesCount) - 1;
    }
    else if (page < 0) {
        page = 0;
    }
    pageControl.currentPage = Int(page)

    var dx = scrollview.contentOffset.x

    // When we know offset - we can crop an image and get necessary part of it
    let queue = NSOperationQueue()
    var cgimg: CGImageRef?
    var drawn = false

    // Crop an image in another thread
    queue.addOperationWithBlock() {
        if(!self.locked) {
            self.locked = true
            cgimg = self.imageClass!.getImage(dx)
            drawn = true
        }

        NSOperationQueue.mainQueue().addOperationWithBlock() {
            if(drawn) {
                self.myImageView!.layer.contents = cgimg
                self.locked = false
            }
        }
    } 
}

public func getImage(xOffset: CGFloat) -> CGImage {
    // Here 'img' is my wide image
    return CGImageCreateWithImageInRect(img, CGRectMake(xOffset, 0, imgWidth, imgHeight))!
}

