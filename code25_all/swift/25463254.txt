func URLSession(session: NSURLSession!, downloadTask: NSURLSessionDownloadTask!, didWriteData bytesWritten: Int64, totalBytesWritten: Int64, totalBytesExpectedToWrite: Int64) {

    if(totalBytesExpectedToWrite == NSURLSessionTransferSizeUnknown) {

        println("Unknow File Size!")

    } else {

        let index:Int = self.getFileDownloadInfoIndexWithTaskIdentifier(downloadTask.taskIdentifier)

        let fdi = self.arrFileDownloadData.objectAtIndex(index) as FileDownloadInfo

        NSOperationQueue.mainQueue().addOperationWithBlock({

            fdi.downloadProgress = Float(totalBytesWritten) / Float(totalBytesExpectedToWrite)

            // Get the progress view of the appropriate cell and update its progress.

            let indexPath = NSIndexPath(forRow: index, inSection: 0)

            let cell = self.tableView.cellForRowAtIndexPath(indexPath) as CustomTableViewCell

            var progressView:UIProgressView = cell.viewWithTag(40) as UIProgressView;

            progressView.progress = fdi.downloadProgress

        })

    }

}

