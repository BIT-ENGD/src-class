let bufferSize = 154000
var buffer = [UInt8](count: bufferSize, repeatedValue: 0)
var bytesRead = inputStream?.read(&buffer, maxLength: bufferSize)
if bytesRead > 0 {

var bytesWrittenSoFar = 0
do {
    var diffbytes = bytesRead! - bytesWrittenSoFar

    fileStream?.open()
    fileStream?.write(UnsafePointer(&buffer[bytesWrittenSoFar]), maxLength: diffbytes)

} while (bytesWrittenSoFar != bytesRead);

