class EventTableViewCell: UITableViewCell {

func loadItem (#date:String, title:String, description:String, image:UIImage) {

    dateLabel.text = date
    titleLabel.text = title
    eventImage.image = image
    eventDescription.text = description

    titleLabel.setTranslatesAutoresizingMaskIntoConstraints(false)
    titleLabel.numberOfLines = 0
    self.contentView.addSubview(titleLabel)


    eventDescription.setTranslatesAutoresizingMaskIntoConstraints(false)
    eventDescription.numberOfLines = 0
    self.contentView.addSubview(eventDescription)

}


@IBOutlet weak var eventImage: UIImageView!

@IBOutlet weak var dateLabel: UILabel!

@IBOutlet weak var titleLabel: UILabel!


@IBOutlet weak var eventDescription: UILabel!

override func awakeFromNib() {
    super.awakeFromNib()
    // Initialization code
}

class Contacts: UITableViewController, UITableViewDataSource, UITableViewDelegate {



var eventData:[AnyObject] = []


override func tableView(tableView: UITableView, numberOfRowsInSection section: Int) -> Int {
    return eventData.count
}
override func tableView(tableView: UITableView, cellForRowAtIndexPath indexPath: NSIndexPath) -> UITableViewCell {


    let cell = tableView.dequeueReusableCellWithIdentifier("customCell", forIndexPath: indexPath) as EventTableViewCell

    if (eventData.count != 0) {
        var event: AnyObject? = eventData[indexPath.row]
        if let unwrappedEvent: AnyObject = event {
            let eventTitle = unwrappedEvent["title"] as? String
            let eventDate = unwrappedEvent["date"] as? String
            let eventDescription = unwrappedEvent["description"] as String
            let eventImage = unwrappedEvent["image"] as? UIImage


            if (eventImage != nil){

                cell.loadItem(date: eventDate!, title: eventTitle!, description: eventDescription, image: eventImage!)}


            else {


                let testImage: UIImage = UIImage(named: "test-image.png")

                cell.loadItem(date: eventDate!, title: eventTitle!, description: eventDescription, image: testImage )
            }

        }
    }
    return cell
}

override func viewDidLoad() {
    super.viewDidLoad()


    var nib = UINib(nibName: "CustomTableViewCell", bundle: nil)
    tableView.registerNib(nib, forCellReuseIdentifier: "customCell")

    let manager = AFHTTPRequestOperationManager()

    manager.GET( "http://[my-json-file].json",
        parameters: nil,


        success: {
            (operation: AFHTTPRequestOperation!,responseObject: AnyObject!) in
            println("JSON: " + responseObject.description)
            self.eventData = responseObject!["events"] as [AnyObject]
            self.tableView.reloadData()
        },
        failure: { (operation: AFHTTPRequestOperation!,error: NSError!) in
            println("Error: " + error.localizedDescription)
    })

}

