override func viewDidLoad() {
    super.viewDidLoad()

    sharedLightsManager.delegate = self
    sharedLightsManager.loadNetworkContext()

    dataSource = MainMenuTableViewDataSource(sharedLightsManager: sharedLightsManager)
    tableView.dataSource = dataSource
    tableView.delegate = dataSource

    title = "test"

}
//This method fires each time a change happens
func updateLights(){
    lights = sharedLightsManager.localNetworkContext.allLightsCollection.lights
    tableView.reloadData()
}

class MainMenuTableViewDataSource: NSObject, UITableViewDataSource, UITableViewDelegate
{
    let reuseIdentifier = "tableViewCell"
    var sharedLightsManager: SharedLightsManager?
    var lights = []

    init(sharedLightsManager: SharedLightsManager)
    {
        self.sharedLightsManager = sharedLightsManager
    }
    func numberOfSectionsInTableView(tableView: UITableView) -> Int {
        return 1
    }

    func tableView(tableView: UITableView, numberOfRowsInSection section: Int) -> Int {
        return lights.count
    }

    func tableView(tableView: UITableView, cellForRowAtIndexPath indexPath: NSIndexPath) -> UITableViewCell {
        let cell: UITableViewCell = tableView.dequeueReusableCellWithIdentifier("tableViewCell", forIndexPath: indexPath) as UITableViewCell
        var lights = sharedLightsManager!.localNetworkContext.allLightsCollection.lights
        var light = LFXLight()
        if lights.count == 0 {
        println("Lights array still loading...")
        } else {
            light = lights[indexPath.row] as LFXLight
        }
        return cell
    }

}

lights
lights.count
