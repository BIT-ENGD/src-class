class ContentViewController: UIViewController {

    private let homeViewController: HomeViewController!
    private let aboutViewController: AboutViewController!
    private let liveTVViewController: LiveTVViewController!
    private let programsViewController: ProgramsViewController!
    private var currentViewController: UIViewController!

    var userDeviceType: Int!

    override func viewDidLoad() {
        super.viewDidLoad()

        let viewController = viewControllerForSegmentIndex(0)
        self.addChildViewController(viewController)
        viewController.view.frame = self.view.bounds
        self.view.addSubview(viewController.view)
        currentViewController = viewController

        NSNotificationCenter.defaultCenter().addObserver(self, selector: "segmentChanged:", name: "SegmentChangedNotification", object: nil)

    }

    deinit {
        NSNotificationCenter.defaultCenter().removeObserver(self)
    }

    func segmentChanged(notification: NSNotification) {

        let userInfo = notification.userInfo as [String: AnyObject]
        let selectedIndex = userInfo["selectedIndex"] as Int

        let viewController = viewControllerForSegmentIndex(selectedIndex)

        self.addChildViewController(viewController)

        self.transitionFromViewController(currentViewController,
            toViewController: viewController,
            duration: 0.0,
            options: UIViewAnimationOptions.CurveEaseIn,
            animations: { () -> Void in

                self.currentViewController.view.removeFromSuperview()
                viewController.view.frame = self.view.bounds
                self.view.addSubview(viewController.view)

        }) { (finished: Bool) -> Void in

            viewController.didMoveToParentViewController(self)
            self.currentViewController.removeFromParentViewController()
            self.currentViewController = viewController

        }
    }


    func viewControllerForSegmentIndex(index: Int) -> UIViewController {

        var viewController: UIViewController

        if index == 0 {

            viewController = self.storyboard!.instantiateViewControllerWithIdentifier("HomePage") as HomeViewController
        (viewController as HomeViewController).userDeviceType = userDeviceType

        } else if index == 1 {
            viewController = self.storyboard!.instantiateViewControllerWithIdentifier("ProgramsPage") as ProgramsViewController
        }  else if index == 2 {
            viewController = self.storyboard!.instantiateViewControllerWithIdentifier("LiveTVPage") as LiveTVViewController
        }  else if index == 3 {
            viewController = self.storyboard!.instantiateViewControllerWithIdentifier("AboutPage") as AboutViewController
        } else {
            viewController = self.storyboard!.instantiateViewControllerWithIdentifier("HomePage") as HomeViewController
        }

        return viewController
    }

    override func didReceiveMemoryWarning() {
        super.didReceiveMemoryWarning()
    }

}

