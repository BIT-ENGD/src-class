import Foundation
import UIkit

// Protocolo a implementar por la clase que delegue esta
protocol WebServiceProtocolo {
    // funcion que implementará la clase delegada y que recibirá los datos de repuesta a la llamada
    func didReceiveResponse(respuesta : NSDictionary)
}

// PRUEBA DE CONEXIÓN CON WEBSERVICE A TRAVES DE AFNETWORKING
class webServiceCallAPI : NSObject {

    var delegate : WebServiceProtocolo?

    let manager : AFHTTPRequestOperationManager = AFHTTPRequestOperationManager()
    var responseObject : AnyObject?

    // Esta llamada devuelve una lista con los vendedores del sistema
    func obtenerVendedores()  {

       // var parametros = ["user":"b17e70697e2374","password":"3eaf2e91"]
       // var jsonDict : NSDictionary
        var jsonArray : NSArray!
        var error : NSError?
        manager.GET("http://losbarkitos.herokuapp.com/vendedores/", parameters: nil,
            success: {(operation: AFHTTPRequestOperation!, responseObject) in
                println("responseObject: \(responseObject)")
                var jsonDict = responseObject as NSDictionary
                self.delegate?.didReceiveResponse(jsonDict)},

            failure: {(operation: AFHTTPRequestOperation!, error: NSError!) in
                println("Error: \(error.localizedDescription))")})
      //  self.delegate?.didReceiveResponse(responseObject as NSDictionary)

    }
}

 (
        {
        codigo = 1;
        nombre = Celia;
    },
        {
        codigo = 2;
        nombre = Mikel;
    },
        {
        codigo = 3;
        nombre = Rafaela;
    },
        {
        codigo = 4;
        nombre = Miguel;
    }
)

  ---  var jsonDict = responseObject as NSDictionary  ---> Thread 1:EXC_BAD_ACCESS (Code 2, address...)

