typedef void (^RequestProductsCompletionHandler)(BOOL success, NSArray * products);

typealias RequestProductsCompletionHandler = (success : Bool, products : NSArray)

_completionHandler(true, skProducts)

- (id)initWithProductIdentifiers:(NSSet *)productIdentifiers {

if ((self = [super init])) {

    // Store product identifiers
    _productIdentifiers = productIdentifiers;

    // Check for previously purchased products
    _purchasedProductIdentifiers = [NSMutableSet set];
    for (NSString * productIdentifier in _productIdentifiers) {
        BOOL productPurchased = [[NSUserDefaults standardUserDefaults] boolForKey:productIdentifier];
        if (productPurchased) {
            [_purchasedProductIdentifiers addObject:productIdentifier];
            NSLog(@"Previously purchased: %@", productIdentifier);
        } else {
            NSLog(@"Not purchased: %@", productIdentifier);
        }
    }

}
return self;

for productIdentifier in _productIdentifiers {
        let productPurchased = NSUserDefaults.standardUserDefaults().boolForKey(productIdentifier)
        if productPurchased {
            _purchasedProductIdentifiers.addObject(productIdentifier)
        }
    }

