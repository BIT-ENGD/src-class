import UIKit
import QuartzCore

class GBPopupController: UIView {

var originalContainerCenterY = CGFloat()

@IBOutlet var continerConstraintCenterY: NSLayoutConstraint!
@IBOutlet var containerConstraintCenterX: NSLayoutConstraint!


var startingCenter = CGPoint()
@IBOutlet var contentView: UIView!
@IBOutlet var button: UIButton!


override func layoutSubviews() {
    super.layoutSubviews()
    contentView.layer.cornerRadius = 10
    button.layer.cornerRadius = 10

}

override func didMoveToSuperview() {
   self.beginViewAnimations()
}

func animatePopupIn() {

    UIView.animateWithDuration(1.0, delay: 0.0, usingSpringWithDamping: 0.6, initialSpringVelocity: 0.7, options: UIViewAnimationOptions.CurveEaseIn, animations: {

        self.contentView.layer.transform = CATransform3DIdentity

        }, completion: {finished in
    })
}

func beginViewAnimations() {
    var transform = CATransform3DIdentity;
    transform = CATransform3DMakeTranslation(0, -self.frame.size.height, 0)

    self.contentView.layer.transform = transform

    UIView.animateWithDuration(0.4, delay: 0.0, options: UIViewAnimationOptions.TransitionCrossDissolve, animations: {

        self.backgroundColor = UIColor(white: 0.0, alpha: 0.5)

        }, completion: {finished in

            self.animatePopupIn()
    })


}

func removeViewFromSuperView() {
    UIView.animateWithDuration(0.5, delay: 0.0, options: UIViewAnimationOptions.TransitionCrossDissolve, animations: {

        var transform = CATransform3DIdentity;
        transform = CATransform3DMakeTranslation(0, -self.frame.size.height, 0)
        self.contentView.layer.transform = transform

        }, completion: {finished in

            UIView.animateWithDuration(0.4, delay: 0.0, options: UIViewAnimationOptions.TransitionCrossDissolve, animations: {
                self.backgroundColor = UIColor.clearColor()

                }, completion: {finished in
                    self.removeViewAnimation()
            })

    })
}

func removeViewAnimation() {
    self.removeFromSuperview()

}

