ApiClient
success
NSError
failure
import Foundation

public class ApiClient {

    public func login(#username: String, password: String, success: (data: AnyObject!) -> Void, failure: (error: NSError) -> Void) {

        if username == "isuru" && password == "123" {
            let jsonResponse = "Login Successful"
            let data = jsonResponse.dataUsingEncoding(NSUTF8StringEncoding, allowLossyConversion: false)
            success(data: data!)
        } else {
            let userInfo = [
                NSLocalizedDescriptionKey: NSLocalizedString("Login Unsuccessful", comment: ""),
                NSLocalizedFailureReasonErrorKey: NSLocalizedString("Wrong Email or Password", comment: ""),
                NSLocalizedRecoverySuggestionErrorKey: NSLocalizedString("Please Try Again", comment: "")]
            let error = NSError(domain: "AppErrorDomain", code: 1200, userInfo: userInfo)
            failure(error: error)
        }
    }
}

LoginViewModel
LoginViewController
ApiClient
import Foundation

protocol LoginDelegate {
    func loginCallFinished(status: Bool, error: NSError?)
}

class LoginViewModel {

    private let api = ApiClient()

    var delegate: LoginDelegate?

    init() { }

    func login(#username: String, password: String) {

        api.login(username: username, password: password, success: { (data) -> Void in
            if let delegate = self.delegate {
                delegate.loginCallFinished(true, error: nil)
            } else {
                fatalError("Have you set the LoginDelegate?")
            }
        }) { (error) -> Void in
            if let delegate = self.delegate {
                delegate.loginCallFinished(false, error: error)
            } else {
                fatalError("Have you set the LoginDelegate?")
            }
        }
    }
}

LoginViewController
login()
LoginViewModel
LoginDelegate
loginCallFinished()
import UIKit

class LoginViewController: UIViewController, LoginDelegate {

    private let loginViewModel = LoginViewModel()

    override func viewDidLoad() {
        super.viewDidLoad()

        loginViewModel.delegate = self

        loginViewModel.login(username: "isuru", password: "12")
    }

    // MARK: - LoginDelegate
    func loginCallFinished(status: Bool, error: NSError?) {
        if status {
            println("Login Successful!")
        } else {
            if let error = error {
                let alert = UIAlertView(title: error.localizedDescription, message: "\(error.localizedFailureReason)\n\(error.localizedRecoverySuggestion)", delegate: nil, cancelButtonTitle: "OK")
                alert.show()
            }
        }
    }
}

login()
ApiClient
LoginViewController
UIAlertView
if let error = error {
    let alert = UIAlertView(title: error.localizedDescription, message: "\(error.localizedFailureReason)\n\(error.localizedRecoverySuggestion)", delegate: nil, cancelButtonTitle: "OK")
    alert.show()
}

error
