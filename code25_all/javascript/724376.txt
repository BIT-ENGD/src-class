var imagePath = imagePaths[nextImage];
var imageLabel = imageLabels[nextImage];
var imageSpan = document.getElementById('' + nextImage);
var imageElement;

if (nextImage < imagePaths.length){
    var flag=imagePath.lastIndexOf(".");
    var extension="";
    if(flag!=-1){
        extension=imagePath.substr(flag+1).toLowerCase();
        switch(extension){
            case "swf":
             imageElement = document.createElement("embed");
                break;
            default:
                imageElement = document.createElement("img");
        }

    }
    imageElement.style.visibility = "hidden";
    imageElement.style.position = "absolute";
    imageElement.style.left = "-9999px";
    imageElement.style.top = "-9999px";
    imageElement.style.border = "solid black 1px";
    imageElement.setAttribute("id", imagePath);
    imageElement.setAttribute("src", 'file://' + imagePath);
    imageElement.addEventListener("load", imageLoaded)
    imageElement.label = imageLabel;
    imageSpan.appendChild(imageElement);
}
     nextImage++;
    if (nextImage < imagePaths.length)
    setTimeout('showImages()', 1);

