var index = 0;

function setup() {
    window.setInterval(PingWebSite, (10 * 1000));
}

function PingWebSite() {

    var http_request = new XMLHttpRequest();
    try {
        http_request.open("GET", "http://www.google.com", true);
        http_request.onreadystatechange = function() {
            if (http_request.readyState == 4) {
                if (http_request.status == 200) {
                    MonitorInformation.innerText = "http://www.google.com" + " Connection ok";
                    alert("ok");
                }
                else {
                    alert("fail");
                }
                http_request = null;
            } // if if (http_request.readyState == 4)
            else {
                // if execute here, no exception will be thrown
                alert("connecting");
            }
        }  // end of function
        http_request.send(null);
    } // try
    catch (e) {
        alert("service is not available");
    }
}

var index = 0;
var http_request;
var xhrTimeout;
var chkConn;

function setup() {
    chkConn = window.setInterval(PingWebSite, (10 * 1000));
}

function WebMonitorTimeout() {
    http_request.abort();
    alert("timeout");
    index = index + 1;
}

function PingWebSite() {

    http_request = new XMLHttpRequest();
    http_request.open("GET", "http://www.google.com", true);

    http_request.onreadystatechange = function()
    {
        if (http_request.readyState == 4) {
            if (chkConn) { clearInterval(chkConn); }
            if (http_request.status == 200) {
                alert("ok");
                index = index + 1;
                if (xhrTimeout) { clearTimeout(xhrTimeout); }
            }
            else {
                alert("fail");
                index = index + 1;
                if (xhrTimeout) { clearTimeout(xhrTimeout); }
                }

                http_request = null;
            } //if (http_request.readyState == 4)

    }    // end of event function
    http_request.send(null);
    xhrTimeout = setTimeout("WebMonitorTimeout();", 30000);
    alert(index);
    chkConn = window.setInterval(PingWebSite, (30 * 1000));
}

