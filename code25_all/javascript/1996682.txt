$(document).ready(function(){
    var loadedNum = 1;
    var loadInterval = 10;
    function loadMoreItems(){
        for(i=loadedNum; i<loadedNum+loadInterval; i++){
            $.get("ajax.html", function(data){
                $("#loader").append($("li:nth-child("+loadedNum+")",data));
                loadedNum++;
            });
        }
    }
    loadMoreItems();
    $(this).scroll( function(){
        var positionNum = $(this).scrollTop();
        var heightNum = $("#container").height();
        var topNum = $("#loader").position();
        var windowNum = $(window).height();

        var totalHeight = topNum.top+heightNum;
        var totalScrolled = positionNum+windowNum;

        if(totalHeight-totalScrolled<100){
            $.get("ajax.html", function(data){
                $("#loader").append($("li:nth-child("+loadedNum+")",data));
                loadedNum++;
            }); 
        }
        $("#position").css("top",totalScrolled-20);
        $("#position").text("total left is "+(totalHeight-totalScrolled)+"px");
    });
});

