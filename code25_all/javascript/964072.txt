if (window.opener && !window.opener.closed)
{
     window.opener.document.getElementById(strFieldName).value = FieldValue;
     window.opener.document.getElementById(strhidFieldName).value = FieldId;
     window.opener.document.getElementById(strFieldName).focus();
     window.close();
}

function openPopup(hidfield_name,field_name,SType) 
{
    url = location.protocol+'//'+ location.host + '/User/Search.aspx?refId='+field_name+'&SearchType='+SType+'&hidid='+hidfield_name;
    if (!newwindow.closed && newwindow.location)
     {
        newwindow.location.href = url;
    }
    else
     {
     GetCenterWindowParams();

        newwindow=window.open(url,'winLOV', 'scrollbars=yes,resizable=yes,width=470,height=400,screenX='+xOffset+',screenY='+yOffset+',top='+yOffset+',left='+xOffset+'');
        if (!newwindow.opener) newwindow.opener = self;
    }
    if (window.focus) {newwindow.focus()}
    return false;

}

  currentCell.Attributes.Add("OnClick", "javascript:PassBack('" & CType(e.Item.DataItem, DataRowView).Row(0) & "','" & str.Trim & "');")

