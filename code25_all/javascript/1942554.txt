    HtmlGenericControl SkypeObject = new HtmlGenericControl("object");
    SkypeObject.Attributes.Add("id", "Skype");
    SkypeObject.Attributes.Add("codeBase", "http://ip/Skype4COM.dll");
    SkypeObject.Attributes.Add("classid", "clsid:830690FC-BF2F-47A6-AC2D-330BCB402664");
    SkypeObject.Attributes.Add("name", "Skype");

    string SkypeAsyncCallbackOnEvent = ClientScript.GetCallbackEventReference(this, "values", ClientScriptName, "context", true);

    string SkypeCallbackFunction = "\n<script>\n";
    SkypeCallbackFunction += "function SkypeCallback(values,context) {\n";
    SkypeCallbackFunction += SkypeAsyncCallbackOnEvent + "\n}\n";
    SkypeCallbackFunction += "</script>";

        string SkypeOnUserStatusChange = "\n<script for=\"Skype\" event=\"UserStatus(Status)\">\n";
    SkypeOnUserStatusChange += "var values = {\"StatusInfo\" : Status};\n";
    SkypeOnUserStatusChange += "var myArray = {\"key\" : \"Status\", \"values\" : values};\n";
    SkypeOnUserStatusChange += "var s=JSON.stringify(myArray);";
    SkypeOnUserStatusChange += "SkypeCallback(s,null);\n";
    SkypeOnUserStatusChange += "</script>";

