<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<script type="text/javascript">
                //<![CDATA[
                    var myListener = new Object();

                    /**
                     * Initialisation
                     */
                    myListener.onInit = function()
                    {
                        this.position = 0;
                    };
                    /**
                     * Update
                     */
                    myListener.onUpdate = function()
                    {                           
                        var isPlaying = (this.isPlaying == "true");
                        document.getElementById("playerplay").style.display = (isPlaying)?"none":"block";
                        document.getElementById("playerpause").style.display = (isPlaying)?"block":"none";
                    };

                    function getFlashObject()
                    {
                        return document.getElementById("myFlash");
                    }
                    function play()
                    {
                        if (myListener.position == 0) {
                            getFlashObject().SetVariable("method:setUrl", "/appsite/Files/Clips/$story.Value.ClipPath");
                        }
                        getFlashObject().SetVariable("method:play", "");
                        getFlashObject().SetVariable("enabled", "true");
                    }
                    function pause()
                    {
                        getFlashObject().SetVariable("method:pause", "");
                    }
                    function stop()
                    {
                        getFlashObject().SetVariable("method:stop", "");
                    }
                    function setPosition()
                    {
                        var position = document.getElementById("inputPosition").value;
                        getFlashObject().SetVariable("method:setPosition", position);
                    }
                    function setVolume()
                    {
                        var volume = document.getElementById("inputVolume").value;
                        getFlashObject().SetVariable("method:setVolume", volume);
                    }
                //]]>
                </script>
                <!--[if IE]>
                <script type="text/javascript" event="FSCommand(command,args)" for="myFlash">
                eval(args);
                </script>
                <![endif]-->

                <object class="playerpreview" id="myFlash" type="application/x-shockwave-flash" data="$siteroot/content/player_mp3_js.swf" width="1" height="1">
                    <param name="movie" value="$siteroot/content/player_mp3_js.swf" />
                    <param name="AllowScriptAccess" value="always" />
                    <param name="FlashVars" value="listener=myListener&amp;interval=500" />
                </object>

                <li><div id="playercontroller">
                    <div id="playerplay"><a href="javascript:play()" ><img src="$siteroot/content/images/clipplay.png" style="vertical-align: middle;"/></a> Play a short clip.</div>
                    <div id="playerpause" style="display:none;"><a href="javascript:pause()"><img src="$siteroot/content/images/clippause.png" style="vertical-align: middle;"/></a> Pause clip.</div>
                </div></li> 

