var conn;
conn.Open = 'Provider=ADsDSOObject;';
var command = '<LDAP://CN=Partitions,CN=Configuration,DC=domain,DC=com>;(&(objectcategory=crossRef)(systemFlags=3));name,nETBIOSName,nCName,canonicalName;onelevel';
var ado = new ActiveXObject('ADODB.Command');
ado.ActiveConnection = conn;
ado.CommandText = command;
var records = ado.Execute;

while (!records.Eof){
  ...

  records.MoveNext();
}

var cn = records.Fields('canonicalName').Value;

for (var i in cn) { alert(cn[i]); }

for (i = 0; i < cn.length; i++) { alert(cn[i]); }

