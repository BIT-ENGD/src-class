hsb.s = max != 0 ? 255 * delta / max : 0;

?
:
