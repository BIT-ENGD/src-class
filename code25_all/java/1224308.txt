public class RPCHandler
{


  public RPCHandler(String method,String[] argumentsName,
  String[][] argumentsValues)
  {
    this.method = method;
    this.argumentsName = argumentsName;
    this.argumentsValues = argumentsValues;
  }



  /**
   * Method that creates a RPC request using JSON in a POST
   * 
   */
  public void rpcRequest(){
    if(currentState == HandlerState.WAITING_RESPONSE)return;


    currentState = HandlerState.WAITING_RESPONSE;

    // Append watch list stock symbols to query URL.

    url = URL.encode(url);
    url += "action=";
    url += method;

    // Send request to server and catch any errors.
    RequestBuilder builder = new RequestBuilder(RequestBuilder.POST, url);

    String requestData = parseToJSON(argumentsName, argumentsValues);

    try{

    Request request = builder.sendRequest(requestData, new RequestCallback()
    {
      public void onError(Request request, Throwable exception)
      {
        setRPCException(new Exception("Error while saving. Action="+method));
        setCurrentState(HandlerState.ON_ERROR);
      }
      //Few other error, response received hander methods after this point.
  }

}

