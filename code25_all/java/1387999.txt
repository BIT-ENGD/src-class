   //userFolder is an Object of IMAPFolder
   Message[] messages = userFolder.getMessages();

   Arrays.sort(messages, new Comparator<Message>()
    {
        public int compare(Message message1, Message message2)
        {
            int returnValue = 0;
            try
            {
                if (sortCriteria == SORT_SENT_DATE)
                {
                    returnValue = message1.getSentDate().compareTo(message2.getSentDate());
                }
            } catch (Exception e)
            {
                System.out.println(e.getMessage());
                e.printStackTrace();
            }

            if (sortType == SORT_TYPE_DESCENDING)
            {
                returnValue = -returnValue;
            }

            return returnValue;
        }
    });

