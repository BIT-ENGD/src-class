import java.io.*;
import java.net.*;

class MyWebServer{

    static ServerSocket serSocket = null ;

    static{
        try {
            serSocket = new ServerSocket(80) ;
            System.out.println("Server started successfully....\n\n") ;
        } catch (IOException io) {
            System.out.println( io.getMessage() );
            System.exit(1) ;
        }
    }

    public static void main(String []args){

        while(true){
            try {
                new Thread( new ServingThread( serSocket.accept() ) ).start() ;
            } catch (IOException io) {
                System.out.println(io.getMessage());
            }
        }
    }
}

class ServingThread implements Runnable{
    private Socket socket ;

    public ServingThread(Socket socket){
        this.socket = socket ;
        System.out.println("Receives a new browser request from " + socket);
    }

    public void run() {
        BufferedReader in = null ;
        PrintWriter out = null ;

        try {

            //reading request headers from browser starts here
            in = new BufferedReader(new InputStreamReader(socket.getInputStream()));
            String str = ".";
            while (!str.equals("")){
                str = in.readLine();
                //System.out.println(str);
            }
            System.out.println("\n\n");
            //reading request headers from browser ends here


            //writing output on outputstream starts here
            out = new PrintWriter( socket.getOutputStream(), true ) ;

            int i = (int) ( Math.random() * 10) ;
            out.println(i) ;
            System.out.println(i) ;
            //writing output on outputstream ends here

            socket.close() ;
            System.out.println("Request successfully fulfilled.\n") ;
        }
        catch (IOException io) {
            System.out.println(io.getMessage());
        }
    }
}

