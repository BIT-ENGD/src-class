public class ItemComponent extends JComponent implements ItemView {

    private static final Color COLOR_FILL_NORMAL = new Color(0x008080ff);
    private static final Color COLOR_FILL_TARGET = Color.LIGHT_GRAY;
    private static final Color COLOR_OUTLINE = new Color(0x00333333);

    Item item;
    RoundRectangle2D rect;
    State state = State.NORMAL;
    float alpha = 1.0f;

    public ItemComponent(Item item) {
        this.item = item;
        this.rect = new RoundRectangle2D.Double(0, 0, 0, 0, 5, 5);
        item.setView(this);
    }

    public void setState(State state) {
        this.state = state;
    }

    public void update() {
        System.out.println("ItemComponent.update");
        setLocation(item.getLeft(), 1);
        setSize(item.getWidth(), getParent().getHeight()-1);
        rect.setRoundRect(0, 0, getWidth()-1, getHeight()-1, 5, 5);

        repaint();
        //paintImmediately(getBounds());
    }

    @Override
    public void addNotify() {
        update();
    }

    @Override
    public void paint(Graphics g) {
        System.out.println("paint");

        Graphics2D g2 = (Graphics2D)g;

        g2.setComposite(AlphaComposite.getInstance(AlphaComposite.SRC_OVER, alpha));

        if (state == State.NORMAL) {
            System.out.println("draw normal");
            g2.setPaint(COLOR_FILL_NORMAL); // light blue
            g2.fill(rect);

            g2.setPaint(COLOR_OUTLINE);
            g2.draw(rect);
        }
        else if (state == State.TARGET) {
            System.out.println("draw target");
            g2.setPaint(COLOR_FILL_TARGET);
            g2.fill(rect);

            float[] dashPattern = { 8, 5 };
            g2.setStroke(new BasicStroke(2, BasicStroke.CAP_BUTT, BasicStroke.JOIN_MITER, 10, dashPattern, 0));
            g.setColor(COLOR_OUTLINE);
            g2.draw(rect);
        }
    }
}

