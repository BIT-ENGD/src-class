while (true) {
    Object received = oisFromOtherMachine.readUnshared();
    dispatch(received);
}

synchronized void sendMessage(Message m) {
    oosToOtherMachine.writeObject(m);
    oosToOtherMachine.flush();
    oosToOtherMachine.reset();
}

try {/* message loop */ } catch (RuntimeException) { /* resync appstate and continue*/ } 

