"512" --> 512
"24"  --> 24.0
"5"   --> 5.00

function f(value, w)    
    local p = math.ceil(math.log10(value))
    local prec = value <= 1 and w - 1 or p > w and 0 or w - p
    return string.format('%.' .. prec .. 'f', value)
end

print(f(12, 3))

