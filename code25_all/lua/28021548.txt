local state = {{},{}}
state["red"]["blue"] = function()
   stop_a_timer() 
   return "purple"
end
state["blue"]["green"] = function()
   call_a_function()
   return "cyan"
end
state["green"]["red"] = function()
   call_another_function()
   return ("yellow")
end

function state_handler(old_state, new_state) 
   if not (state[old_state][new_state]()) then
     return false
   end
end

(old_state == "green") and (new_state != "blue")

state["green"][(not "blue")] = function () whatever end

