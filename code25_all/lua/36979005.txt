key  
===  
20160429 
20160430 
20160501
20160502

local data = {};
local keyslist = redis.call('keys', 'stats:day:*');
local key, users, redisData;
-- keyslist = #keyslist.sort(#keyslist, function(a, b) return a[2] > b[2] end);
-- keyslist = #keyslist.sort(#keyslist, function(a,b) if a>b then return true; else return false; end end); 
for iCtr = 1, #keyslist do

    key = string.gsub(keyslist[iCtr], 'stats:day:','');
    redisData = redis.call('hmget', keyslist[iCtr], 'image','video');
    table.insert(data, {date=key, imgctr=redisData[1], vidctr=redisData[2]});
    if iCtr == 2 then break end
end

20160501
20160502

