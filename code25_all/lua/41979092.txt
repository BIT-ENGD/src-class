/home/maochengzhi/torch/install/bin/luajit: ...maochengzhi/torch/install/share/lua/5.1/nn/Container.lua:67: 
In 1 module of nn.Sequential:
In 2 module of nn.ConcatTable:
/home/maochengzhi/torch/install/share/lua/5.1/nn/utils.lua:141: bad argument #1 to 'resizeAs' (torch.CudaByteTensor expected, got torch.CudaTensor)
stack traceback:
    [C]: in function 'resizeAs'
    /home/maochengzhi/torch/install/share/lua/5.1/nn/utils.lua:141: in function 'recursiveCopy'
    ...ochengzhi/torch/install/share/lua/5.1/nn/SelectTable.lua:54: in function 'updateGradInput'
    /home/maochengzhi/torch/install/share/lua/5.1/nn/Module.lua:31: in function </home/maochengzhi/torch/install/share/lua/5.1/nn/Module.lua:29>
    [C]: in function 'xpcall'
    ...maochengzhi/torch/install/share/lua/5.1/nn/Container.lua:63: in function 'rethrowErrors'
    ...ochengzhi/torch/install/share/lua/5.1/nn/ConcatTable.lua:35: in function <...ochengzhi/torch/install/share/lua/5.1/nn/ConcatTable.lua:30>
    [C]: in function 'xpcall'
    ...maochengzhi/torch/install/share/lua/5.1/nn/Container.lua:63: in function 'rethrowErrors'
    ...aochengzhi/torch/install/share/lua/5.1/nn/Sequential.lua:88: in function 'backward'
    torch_debug.lua:29: in main chunk
    [C]: in function 'dofile'
    ...gzhi/torch/install/lib/luarocks/rocks/trepl/scm-1/bin/th:150: in main chunk
    [C]: at 0x00406670

WARNING: If you see a stack trace below, it doesn't point to the place where this error occurred. Please use only the one above.
stack traceback:
    [C]: in function 'error'
    ...maochengzhi/torch/install/share/lua/5.1/nn/Container.lua:67: in function 'rethrowErrors'
    ...aochengzhi/torch/install/share/lua/5.1/nn/Sequential.lua:88: in function 'backward'
    torch_debug.lua:29: in main chunk
    [C]: in function 'dofile'
    ...gzhi/torch/install/lib/luarocks/rocks/trepl/scm-1/bin/th:150: in main chunk
    [C]: at 0x00406670

require 'nn'
require 'cudnn'

mo=nn.Sequential()
b=nn.Sequential():add(cudnn.SpatialConvolution(3,8,1,1,1,1,0,0))
c=b
mo:add(nn.Concat(2):add(b):add(c))
mo:add(cudnn.SpatialConvolution(16,3,1,1,1,1,0,0))

model = nn.Sequential()
   :add(nn.ConcatTable(2)
      :add(nn.Sequential():add(nn.SelectTable(1)):add(mo))
      :add(nn.SelectTable(2))
   )
   :add(nn.MaskedSelect())

model:cuda()
print(model)
i=torch.CudaTensor(1,3,10,10)
mask = torch.ByteTensor(1,1,10,10):bernoulli()
mask ={mask, mask, mask}
mask = torch.ByteTensor.cat(mask,2):view(1,3,10,10)
mask = torch.CudaByteTensor(1,3,10,10):copy(mask)

out = model:forward({i,mask}) 
print (out)
print (out:type())

g = model:backward({i,mask},out)----here get the error

