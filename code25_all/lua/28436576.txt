local buffer = ""

function action(input)
    buffer = buffer..input
    parse_data(buffer)
end  

function parse_data(data)
     obj = ""
     obj_var = buffer:match("(%d).*")
     if obj_var == 1 then
         obj = do_some_function()
     else
         obj = do_some_other_function()
     end
     buffer = ""
end

function do_some_function()
     some action
end

function do_some_other_function()
     some chunk
end

buffer
buffer = ""
function string(buffer)
