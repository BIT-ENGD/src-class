local physics = require "physics"
physics.start()
local h = display.actualContentHeight
local w = display.actualContentWidth
local cx = display.contentCenterX
local cy = display.contentCenterY
local dnir = display.newImageRect
local dnr = display.newRect
local mr = math.random
--local egg 
local bask
local idx = 0
local eggs = {}


---------BACKGROUND---------------
local bg = dnir("bg.png", w,h)
bg.x = cx 
bg.y = cy

----------DISPLAY BASKET------------
bask = dnir("basket.png", 100,50)
bask.x = cx
bask.y = cy
physics.addBody(bask,"kinematic")
bask.myName = "bask"


----- BASKET MOVE W/ MUSE FUNCTION -----
local function baskMove (e)

  bask.x = e.x
  bask.y = e.y
end

Runtime:addEventListener("mouse", baskMove)


----------------GROUND---------------
local grd = dnr(cx,h-470,w+50,10)
grd:setFillColor(.1, .8, .15,0)
grd.myName = "ground"
physics.addBody(grd, "static")
grd.collision = collision
grd:addEventListener("collision", grd)

----------****DELETE EGG FUNCTION****------------
--function loop () 
--  if egg and egg.y > 100 then
--    print("Delete")
--    display.remove(egg)
--  end
--end
--
--Runtime:addEventListener("enterFrame", loop)


-----------COLLISIONS FUNCTIION-------------
local function collision ( s, e )
  if e.phase == "began" then

    if e.target.myName == "bask"
      and e.other.myName == "egg"  then
      display.remove(e.other)
      table.remove(eggs, idx)
    end

    if e.target.myName == "egg"
      and e.other.myName == "bask" then
     display.remove(e.target)
     table.remove(eggs, idx)
    end

    if e.target.myName == "ground"
      and e.other.myName == "egg"  then
      display.remove(e.other)
      table.remove(eggs, idx)
    end

    if e.target.myName == "egg"
      and e.other.myName == "ground" then
     display.remove(e.target)
     table.remove(eggs, idx)
    end

  end
end
--

 --------------EGG---------------------
function theEgg ()
egg = dnir("egg.png", 50,50)
physics.addBody(egg,"dynamic")
egg.myName = "egg"  
idx = idx + 1
egg.x = mr(w)
egg.y = - 100


transition.to (egg, {y = h + 50, time= mr(1000,8000)})

eggs[idx] = egg
eggs[idx].idx = idx
print(eggs[idx])


--------EGG COLLISIION CB-------------
egg.collision = collision
egg:addEventListener("collision", egg)

end
--

-----------Spawn EGG-----------
function spawner()
  theEgg()
  print(#eggs)-- PRINT AMT IN TABLE
end
timer.performWithDelay(2000, spawner, 0)

