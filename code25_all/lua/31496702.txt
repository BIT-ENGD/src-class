package.path = pathsToAdd .. package.path
-- a bit of a hassle to amend the lua require paths
-- correctly; I boldly assume for now that these are not the
-- cause of the problem
require('moonscript')
require('config')

require('gears')

package.loaded.gears = myMockVersion

return
{
    client = require("awful.client");
    ...
}

...
local tag = require("awful.tag")
...
local client = {}
-- define lots of functions, register some signal handlers
return client

...
local capi =
{
    ...
    client = client,
    ...
}
...
capi.client.connect_signal(...)

attempt to index a nil value (field 'client')

