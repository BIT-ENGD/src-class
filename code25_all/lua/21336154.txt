--Include sqlite
local sqlite3 = require "sqlite3"
local widget = require "widget"

W=display.contentWidth
H=display.contentHeight

--Open library database file
local path = system.pathForFile("library", system.ResourceDirectory)
db = sqlite3.open( path )   

title = display.newText("LIBRARY", 0, 0, nil, 30)
title.x = W/2 title.y=50

--Access records of book table and display them as nx2 grid with title and cover.
xOffset = 10
yOffset = 100  
items = display.newGroup()
for row in db:nrows("SELECT * FROM book") do
   local text = row.bookName
   local img = display.newImageRect("img"..row.bookId..".jpg", 200, 200 )
   local t = display.newText(text, 0, 0, nil, 25)
   t.x = img.x
   t.y = img.contentBounds.yMax+50
   item = display.newGroup(img,t)
   item.anchorChildren = true
   items:insert(item)
   items.anchorChildren = true

   if(xOffset==10) then
     item.anchorX, item.anchorY = 0,0
     item.x = xOffset
     xOffset = W-10
     item.y = yOffset
     --t:setTextColor(0,255,0)
   else
     item.anchorX, item.anchorY = 1,0
     item.x = xOffset
     xOffset= 10
     item.y = yOffset
     yOffset = yOffset+item.contentBounds.yMax-50
     --t:setTextColor(255,0,0)
   end 
end

