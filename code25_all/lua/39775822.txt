require "vcl"

mainForm = VCL.Form("mainForm")

mainForm.Caption = "My first VCLua application"
mainForm._= { position="podesktopcenter", height=400, width=600}

mainForm.onclosequery = "onCloseQueryEventHandler" 

function onCloseQueryEventHandler(Sender)
    return true -- the form can be closed
end

mainMenu = VCL.MainMenu(mainForm,"mainMenu")
mainMenu:LoadFromTable({
    {name="mmfile", caption="&File", 
        submenu={
            {name="mmOpen", caption="Open...", onclick="onMenuOpenClick", shortcut="Ctrl+O"}, 
            {caption="-",},
            {caption="Exit", onclick="onMenuExitClick", shortcut="Alt+F4"}, 
        }
    },
    {name="mmhelp", caption="&Help", RightJustify=true, 
        submenu =  {
            {caption="Help", shortcut="F1", checked=true},
            {caption="-",},
        }
    }
})

mainMenu:Find("mmhelp"):Add("mmAbout")._=  {caption="About", onclick="onMenuAboutClick", enabled=false}

function onMenuExitClick()
    mainForm:Close()
end

mainToolbar = VCL.ToolBar(mainForm,"mainToolbar")
mainToolbar:LoadFromTable({
    {name="mtbOpen", onclick="onMenuOpenClick"},
    {name="mtbExit", onclick="onMenuExitClick"},
})

mainToolbar:Find("mtbOpen").enabled=false

mainForm:ShowModal()

mainForm:Free()

lua: error loading module 'vcl' from file 'C:\Users\Admin\Desktop\Programs\lua\vcl.dll':
