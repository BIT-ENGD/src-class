local Physics = require("physics")
Physics.start()


centerX = display.contentCenterX
centerY = display.contentCenterY



myScene = require("scene")
myHero = require("hero")
myGoomba = require("badguy")
myButtons = require("buttons")
myMenu = require("mainmenu")


myMenu.drawMainMenu()
playButton:addEventListener( "tap", myMenu.play )





--[[
function onCollision( event )
    if (event.phase == "began") then
        print("began: " .. "The " .. event.object1.name .. " hit the " .. event.object2.name .. ".")
        local youLose = display.newText("You Lose!", display.contentCenterX, 20, native.systemFont, 40)
        youLose:setFillColor(0, 0, 0)
    end
end
Runtime:addEventListener( "collision", onCollision )
]]

local mainmenu = {}

local Physics = require("physics")
Physics.start()


function mainmenu.drawMainMenu()

    menuTheme = audio.loadStream("Music/menuTheme.ogg")
    menuThemeChannel = audio.play( menuTheme, { channel=1, loops=-1, fadein=3000 } )

    background = display.newImage("menuBackground.png")
    background.x = display.contentCenterX
    background.y = display.contentCenterY
    background:scale(1.2, 1.2)

    playButton = display.newImage("playButton.png")
    playButton.x = display.contentCenterX
    playButton.y = display.contentCenterY - 75
    playButton:scale( .3, .3 )

end


function mainmenu.play()


    print("mainmenu - tap registered, preparing to load game..")

    playButton:removeEventListener( "tap", myMenu.play )

    audio.stop(1)

    myScene.sayHello()
    myScene.drawScene()


    myHero.sayHello()
    myHero.drawHero() 


    myGoomba.hello()
    myGoomba.drawBadGuy()


    myButtons.sayHello()
    myButtons.drawButtons()


    myGoomba.move()


    gameTheme = audio.loadStream("Music/playTheme.ogg")
    gameThemeChannel = audio.play( gameTheme, { channel=2, loops=-1, fadein=0 } )


    jumpButton:addEventListener("tap", myButtons.jump)
    backButton:addEventListener("tap", myButtons.goBack)



end



function mainmenu.sayHello()
    print("mainmenu - Hello....")
end


return mainmenu

local badguy = {}

local Physics = require("physics")
Physics.start()






function badguy.hello()
    print("badguy - hello...")
end


function badguy.drawBadGuy()

    obstacle = {}

    obstacle[1] = display.newImage( "asteroid.png")
    obstacle[1].x = 300
    obstacle[1].y = 275 
    obstacle[1]:scale(.7, .7)
    Physics.addBody(obstacle[1], "dynamic", {radius = 20, bounce = 0})

    obstacle[2] = display.newImage( "asteroid.png")
    obstacle[2].x = 400
    obstacle[2].y = 275
    obstacle[2]:scale(.7, .7)
    Physics.addBody(obstacle[2], "dynamic", {radius = 20, bounce = 0})

    obstacle[3] = display.newImage( "asteroid.png")
    obstacle[3].x = 500
    obstacle[3].y = 275
    obstacle[3]:scale(.7, .7)
    Physics.addBody(obstacle[3], "dynamic", {radius = 20, bounce = 0})


end



function badguy.move()

--get badguy to spawn back at start after they cross a certain x value and
--game should restart upon contact  

    for i = 1, #obstacle, 1 do
        obstacle[i]:setLinearVelocity( -200, 0 )

            if (obstacle[i].x < 100) then
                print("if statement activated")

                obstacle[i]:setLinearVelocity( 0, 0 )
            end

    end
end




function badguy.sayHello()
    print("badguy - Hello....")
end


return badguy

