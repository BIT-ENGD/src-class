ctr1=0
ctr2=0

local function doCmdChk()
    ctr1 = ctr1 + 1
    http.get( "http://192.168.2.38/ICmd.py?i=" .. ctr1 , nil, 
    function(rspCode, payload)
        tmr.start(1)
    end)
end

local function sendData()
    ctr2 = ctr2 + 1
    local msgBdy = '{"s":"' .. ctr2 .. '","i":"test23", "d":"heap='..node.heap()..'"}'

    http.post("http://192.168.2.38/DeviceScan.py", "Content-Type: text/json\r\n", msgBdy,
    function(rspCode, payload)
        tmr.start(2)
    end)
end

--mainline start:
tmr.alarm(1, 3000, tmr.ALARM_SEMI, doCmdChk)
tmr.alarm(2, 5000, tmr.ALARM_SEMI, sendData)

