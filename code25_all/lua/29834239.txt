local json = require("json");
local action = {};
local action_mt = { __index = action }

---------PRIVATE FUNCTIONS------------

function action:sendAction(values, networkListener)
    local data,pos,msg = "";
    local params = {}; params.body = "";
    for key,value in pairs(values) do
        params.body = params.body .. "&" .. key .."=" .. value
    end

    local function networkListener( event )
        if ( event.isError ) then
            print( "Network error!" );
        else
            data,pos,msg = json.decode( event.response );
            if (data.errors.count > 0) then
                print("errors");
            end
        end
        return data;
    end

    network.request( "http://127.0.0.1/action.php", "POST", networkListener, params )
end

------PUBLIC FUNCTIONS------
function action:new(action) 
    local newAction = { action = action };
    return setmetatable( newAction, action_mt )
end

function action:createSession()
    local data = action:sendAction( { action = "createSession" } );
    print(data);
end

return action;

