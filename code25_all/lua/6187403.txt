display.setStatusBar(display.HiddenStatusBar)
system.setAccelerometerInterval( 50 )

_W = display.contentWidth
_H = display.contentHeight

local bg = display.newImageRect("images/bg.png", 480, 320)
      bg:setReferencePoint(display.CenterReferencePoint)
      bg.x = _W/2
      bg.y = _H/2

local player = display.newImageRect("images/doodle.png", 128, 64)
     player:setReferencePoint(display.CenterReferencePoint)
     player.x = _W/2
     player.y = _H/2

-- Set up the Accelerometer values in Landscape

local motionX = 0
local motionY = 0                

local function onAccelerate( event )
     motionX = 10 * event.yGravity;
     motionY = 10 * event.xGravity;
end

Runtime:addEventListener ("accelerometer", onAccelerate);

-- Make the player move on tilt.

local function movePlayer (event)
    player.x = player.x + motionX;
    player.y = player.y + motionY;
end

Runtime:addEventListener("enterFrame", movePlayer)

    local function screenBoundaries (event)

        -- Left side boundaries
    if player.x < 0 + player.width/2 then 
       player.x = 0 + player.width/2
    end

        -- Right side boundaries
    if player.x > display.contentWidth - player.width/2 then
       player.x = display.contentWidth - player.width/2
    end

        -- Upper boundaries
    if player.y < 0 + player.height/2 then 
       player.y = 0 + player.height/2
    end

        -- Lower boundaries
    if player.y > display.contentHeight - player.height/2 then 
       player.y = display.contentHeight - player.height/2
    end
end

Runtime:addEventListener("enterFrame", screenBoundaries)

display.setStatusBar(display.HiddenStatusBar)
system.setAccelerometerInterval( 50 )

_W = display.contentWidth
_H = display.contentHeight

local ceil = math.ceil
local pi = math.pi
local atan2 = math.atan2
local playerRotation


 -- Put the doodle fish in the center if the screen.
    local player = display.newImageRect("images/doodle.png", 128, 64)
    player:setReferencePoint(display.CenterReferencePoint)
    player.x = _W/2
    player.y = _H/2

 -- My rotation function, not sure how to do it right.

    local function getPlayerRotationAngle(xGravity, yGravity)
    angle = math.atan2(xGravity, yGravity)

    angle = angle*(180/pi)

    playerRotate = ceil(360 - angle(xGravity, yGravity))

    return playerRotate
     end

 -- Set up the Accelerometer values in Landscape

    local motionX = 0
    local motionY = 0 

    local function onAccelerate( event )
          motionX = 5 * event.yGravity;
          motionY = 5 * event.xGravity;

          -- Should I put the rotation here or down in the movePlayer function?

          player.rotation = playerRotate(event.yGravity, event.xGravity);
    end

    Runtime:addEventListener ("accelerometer", onAccelerate);

 -- Make the player move on tilt.

    function movePlayer (event)

         player.x = player.x + motionX
         player.y = player.y + motionY


    end

    Runtime:addEventListener("enterFrame", movePlayer)

