function doTest( trade, test )
  -- inside the string 'test', I would like that any reference to 'trade'
  -- refer to the function parameter instead of a global variable
  if ( assert(load("return "..test))() ) then
    -- do something
  end
end

a_userdata = { version = 2 }
-- Calling the function above
doTest( a_userdata , "trade.version == 2" )

[string "return trade.version == 2"]:1: attempt to index global 'trade' (a nil value)
stack traceback:
    [string "return trade.version == 2"]:1: in main chunk
    stdin:2: in function 'doTest'
    stdin:1: in main chunk
    [C]: in ?

