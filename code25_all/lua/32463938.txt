a = LastLeapYearShort (if year is leap year make 4 years ago)
b = 366 + (365 * ((CurrentYearShort - 1) - LastLeapYearShort)
c = DayOfYear - DayOfMonth
d = DayOfMonth
e = (SecondOfMinute + (MinuteOfHour * 60))/1440
f = 36525
st = ((a + b + c + d + e)/f)*100000

separate x.y into x and y

if the century is greater than 19 add 1- to the beginning of x and get the first to digits of y

date = x.y

DayOfYear
function isLeapYear(year)
  return year%4==0 and (year%100~=0 or year%400==0)
end

function lastLeapYear(year)
  if(isLeapYear(year))
    result = strsub(year,2,4) - 4
  else
    year = year - 1
    if(isLeapYear(year))
      result = strsub(year,2,4)
    else
      year = year - 1
      if(isLeapYear(year))
        result = strsub(year,2,4)
      else
        year = year - 1
        if(isLeapYear(year))
          result = strsub(year,2,4)
        else
          result = "Invalid"
        end
      end
    end
  end
  return result
end

function stardate()
  yearf = os.date("%Y")
  yearh = os.date("%y")

  a = lastLeapYear(yearf)
  b = (366 + (365 * (yearh - a)))
  c = (!!DayOfYear!! - os.date("%d"))
  d = os.date("%d")
  e = (os.date("%S") + (os.date("%M") * 60))/1440
  f = 36525
  st = ((a + b + c + d + e)/f)*100000
  !!Separate st into x and y!!

  if(strsub(yearf,0,2) > 19)
    diff = strsub(yearf,0,2) - 19

    lead = diff "-" lead
  end

  return lead.dec
end

