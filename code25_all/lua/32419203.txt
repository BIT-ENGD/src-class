options.timeout = 120
options.subscribe = true

account1 = IMAP {
            server = ‘imap.gmail.com’,
            username = ‘username@gmail.com’,
            password = ‘password’,
            }

filter = function (mailbox, from, subject)
    return  mailbox:is_unseen() *
            mailbox:contain_from(from) *
            mailbox:contain_subject(subject)
    end

-- Get the status of a mailbox
account1.INBOX:check_status()

-- Get unseen, Safelert messages
results = filter(account1.INBOX, 'elertus.com', 'Alert')

-- WHAT IS THE PROPER CONDITIONAL STATEMENT 
-- OR STEPS TO CHECK FOR NO MATCH?
if not next(results) == nil then
      os.execute("sh $HOME/isy/all_off.sh")
end

-- Mark messages as seen.
results:mark_seen()
--results:unmark_seen()

-- Safelert
results = filter(account1.INBOX, 'elertus.com', 'Alert')
matches=0
for _, mesg in ipairs(results) do
    matches=matches+1
end
if (matches > 0) then
      os.execute(thrDON)
end
results:mark_seen()

