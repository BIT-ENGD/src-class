local function Block(...)
  local arg = {...}
  model:add(nn.SpatialConvolution(...))
  model:add(nn.SpatialBatchNormalization(arg[2],1e-3))
  model:add(nn.ReLU(true))
  return model
end

local function createModel()
  Block(3,64,3,3,1,1)
  model:add(nn.SpatialMaxPooling(2,2,2,2))
  Block(64,128,3,3,1,1)
  model:add(nn.SpatialMaxPooling(2,2,2,2))
  Block(128,256,3,3,1,1)
  Block(256,256,3,3,1,1)
  model:add(nn.SpatialMaxPooling(2,2,2,2))
  Block(256,512,3,3,1,1)
  BlocK(512,512,3,3,1,1)
  model:add(nn.SpatialMaxPooling(2,2,2,2))
  BlocK(512,512,3,3,1,1)
  BlocK(512,512,3,3,1,1)
  model:add(nn.SpatialMaxPooling(2,2,2,2))
  return model
end

createModel()
print(model)

