nehFragger_ReputationDB = {}   -- The actual database for my AddOn.
local tempKillLog = {}   -- A table that I use to link the different events.

function nehFraggerFrame_OnLoad(frame)
    frame:RegisterEvent("COMBAT_LOG_EVENT_UNFILTERED")
    frame:RegisterEvent("COMBAT_TEXT_UPDATE")
end

function nehFraggerFrame_OnEvent(frame, event, ...)

    local arg1, eventType, arg3, arg4, sourceName, arg6, arg7, destGUID, destName = select(1, ...)
    if (event == "COMBAT_LOG_EVENT_UNFILTERED") then
        if (eventType == "PARTY_KILL") then
            tempKillLog.creatureGUID = destGUID   -- The unique identifier of the creature.
            tempKillLog.creatureName = destName    -- The creature name that I need.
        end
    end

    local eventType, faction, reputation = select(1, ...)
    if (event == "COMBAT_TEXT_UPDATE") then
        if (eventType == "FACTION") then
            local GUID = TempKillLog.creatureGUID
            if (string.upper(string.sub(GUID, 1 , 8)) == "CREATURE") then   -- Make sure the link-table data really is a creature.
                local creatureName = tempKillLog.creatureName   -- The name from my link-table.
                local reputationGain = reputation   -- The reputation that I need.
                -- Simply store the stuff to the database table for this faction:
                nehFragger_ReputationDB[faction] = {}
                nehFragger_ReputationDB[faction].creatureName = creatureName
                nehFragger_ReputationDB[faction].reputationGain = reputationGain
            end
        end
    end

end

destGUID
COMBAT_LOG_EVENT
COMBAT_LOG_EVENT_UNFILTERED
COMBAT_TEXT_UPDATE
nehFragger_ReputationDB
GUID
