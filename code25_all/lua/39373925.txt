local function strsplit(str, sep)
    sep = sep or "%s";
    local tbl = {};
    local i = 1;
    for str in string.gmatch(str, "([^"..sep.."]+)") do
        tbl[i] = str;
        i = i + 1;
    end
    return tbl;
end

local function parser(path, tbl)
    local value;
    local keys = strsplit(path, ".");

    for _, key in pairs(keys) do
        value = (value and value[key]) or tbl[key];
    end
    return value;
end

local data = {
    colors = {
        r = 1, g = 1, b = 1
    }
}

local red = parser("colors.r", data);
print(red); -- prints 1 (correct!)

local data = {
    list = {
        50, 40, 30, 20, 10
    }
}

local value = parser("colors.list[2]", data);
print(value); -- should print 40

