entities = {}
idcounter = 0

Entity = {id = -1, test=0}
function Entity:new(o)
    o = o or {}
    setmetatable(o, self)
    self.__index = self
    self.id = idcounter
    idcounter = idcounter + 1
    entities[idcounter] = self
    return o
end

function Entity:GetID()
    return self.id
end

function Entity:SetTest(v)
    self.test = v
end

function Entity:GetTest()
    return self.test
end

test = Entity:new()
test2 = Entity:new()

print(test:GetID())
print(test2:GetID())
test.id = 10
print(test:GetID())
print(test2:GetID())
for k,v in pairs(entities) do
    print(test)
end
test3 = Entity:new()
print(test:GetID())
print(test2:GetID())
for k,v in pairs(entities) do
    print(test)
end

1
1
10
1
table: 00789020
table: 00789020
10
2
table: 00789020
table: 00789020
table: 00789020

