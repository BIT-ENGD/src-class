function test(A)
  local G = {}
  local mt = {} 
  mt.__index = function(self, i)
    self[i] = setmetatable({}, mt)
    return self[i]
  end

  setmetatable(G, mt)

  G[1] = 10 -- adds 10
  G[1][2][3] = 10 -- error, why?breaks on G[1]

  --but when i do it like this
  G[1][2][3] = 10 -- adds 10
  G[1] = 10 -- erases whole table and adds 10   
  print(G[1][2][3]) -- error  
end

