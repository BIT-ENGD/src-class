location
location /some-extension {
  rewrite ^/(.*) /$1 break;
  proxy_pass http://customers-app/$1/$args;
}

path1 url1 path-2 url2 ... pathn urln
location
proxy_pass
location / {
    content_by_lua '
      local target_path = ngx.var.uri;
      local name = nil

      if target_path:len() > 0 then
        startAt = target_path:find("/") + 1
        endAt = target_path:find("/", startAt) - 1
        name = target_path:sub(startAt,endAt)
        ngx.say(name)
      end

      if name then
        local custom_proxies = os.getenv("CUSTOM_PROXIES");
        inString = custom_proxies:find("another ")
        if not inString then
          ngx.say("not in string")
        else
          startAt = custom_proxies:find(" ", inString + 1) + 1
          endAt = custom_proxies:find(" ", startAt)

          url = custom_proxies:sub(startAt,endAt)
          ngx.say(url)

        end
      end

    ';
  }

content_by_lua
proxy_pass
