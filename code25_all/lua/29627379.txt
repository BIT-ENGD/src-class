function count01to10()
  for i = 1, 10 do
    coroutine.yield(i) 
  end
end

function printNumber(number)
  while number ~= nil do
    print("Counter: ", number)
    coroutine.yield()
  end  
end


function main()
  local number = 0

  print("Creating coroutines")
  local counter = coroutine.create(count01to10)
  local printer = coroutine.create(printNumber)

  print("Executing coroutines")
  while (10 > number) do
    isSuccessuful, number = coroutine.resume(counter)
    print("counter: ", coroutine.status(counter))
    coroutine.resume(printer, number)
    print("printer: ", coroutine.status(printer))
  end

  print("Finished")
end

main()

Creating coroutines
Executing coroutines
counter:    suspended
Counter:    1
printer:    suspended
counter:    suspended
Counter:    1
printer:    suspended
...
Counter:    1
printer:    suspended
Finished

