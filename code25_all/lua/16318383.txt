--Header file
require("TIMER")
require("IPBOX")
require("ANALOG_IN")
require("LOG")

function OnExit()
print("Exit code...do something")
end

function main()
timer = "Timer"
local analogsensor_1 = "AIR_1"
local analogsensor_2 = "AIR_2"
local timestr = os.data("%Y-%m-%d %H:%M:%S")


-- open the file for writing binary data
local filehandle = io.open("collection_of_data.txt", "a")


while true do 
    valueOfSensor_1 = ANALOG_IN.readAnalogIn(analogsensor_1);
    valueOfSensor_2 = ANALOG_IN.readAnalogIn(analogsensor_2);

    if (valueOfSensor_1 > 0 and valueOfSensor_2 > 0) then

        -- save values of sensors           
        filehandle:write(timestr, " -The Value of the Sensors: ", tostring(valueOfSensor_1), tostring(valueOfSensor_2)"\n");

        -- save values using rolling log appender:          
        LOG.log_event( ScenarioLoggerDevicenameInDeviceList, " -The Value of the Sensors: ", tostring(valueOfSensor_1), tostring(valueOfSensor_2), "any other string you wish to add", "etc", "etc")
        LOG.log_event( ScenarioLoggerDevicenameInDeviceList, " -The Value of the Sensors: ", tostring(valueOfSensor_1))
        print("Hello3"..valueOfSensor_1)
    end

TIMER.sleep(timer,500)
end

-- close the file
filehandle:close()

end 

print("start main")
main()

filehandle:write(timestr, " -The Value of the Sensors: ", tostring(valueOfSensor_1), tostring(valueOfSensor_2)"\n");

"attemp to index global 'filehandle' (a nil value)"

