P
Q
P
P
P
lpeg.match(P * lpeg.Cp(), str, i)
v1, v2, ..., j
lpeg.match(Q, str, i)
j, v1, v2, ...
P
function pos_then_captures(pattern)
    local function roll(..., pos)
        return pos, (...)
    end
    return (pattern * lpeg.Cp()) / roll
end

lpeg.Ct()
function pos_then_captures(pattern)
    -- exchange the order of two values and unpack the first parameter
    local function exch(a, b)
        return b, unpack(a)
    end
    return (lpeg.Ct(pattern) * lpeg.Cp()) / exch
end

lpeg.match
lpeg.Ct()
pos_then_captures
pattern
