function newCounter ()
  local t = 10
  local n = 0
  local k = 0

  return function ()
    l = t
    k = n
    n = n + 1
    return n
    end
end

counter = newCounter()
counter()
counter()


print("<==============>")
local i = 1

repeat
  name, val = debug.getupvalue(counter, i)
  if name then
    print ("index", i, name, "=", val)
    if (name == "n") then
      debug.setupvalue(counter,2,10)
    end
    i = i + 1
  end -- if
until not name

index   1   _ENV    =   table: 0x7f8203c03ea0
index   2   t   =   10
index   3   k   =   1
index   4   n   =   2

index   1   t   =   10
index   2   k   =   1
index   3   n   =   2
index   4   _ENV    =   table: 0x7f8203c03ea0

