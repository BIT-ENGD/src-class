-- Called when the scene's view does not exist.
-- 
-- INSERT code here to initialize the scene
-- e.g. add display objects to 'sceneGroup', add touch listeners, etc.
local sound = audio.loadStream("pudi.mp3")
audio.play(sound, { channel=1, loops=-1, fadein=3000})

local sceneGroup = self.view
-- create a grey rectangle as the backdrop
local background = display.newImageRect("background.jpg", screenW, screenH )
background.anchorX = 0
background.anchorY = 0

local finishline = display.newRect( 0, 450, 750, 5 )
physics.addBody(finishline,"static",{friction=2.0,bounce=0.3})
finishline.myName = "finishline"

local blueTurtle = display.newImageRect("blueturtle.png",33,42)
physics.addBody(blueTurtle,"dynamic",{friction=2.0,bounce=0})
blueTurtle.myName = "Blue Turtle"

local redTurtle = display.newImageRect("redturtle.png",33,42)
physics.addBody(redTurtle,"dynamic",{friction=2.0,bounce=0})
redTurtle.myName = "Red Turtle"

local greenTurtle = display.newImageRect("turtlegreen.png",33,42)
physics.addBody(greenTurtle,"dynamic",{friction=2.0,bounce=0})
greenTurtle.myName = "Green Turtle"


blueTurtle.x = 50
blueTurtle.y = 25

redTurtle.x = 150
redTurtle.y = 25

greenTurtle.x = 250
greenTurtle.y = 25

local function numberGenerator1()
    local myRandomNumber = math.random(80000, 180000)   
    timer.performWithDelay( 1000, numberGenerator)
   return myRandomNumber
end

local function numberGenerator2()
    local myRandomNumber = math.random(80000, 180000)   
    timer.performWithDelay( 1000, numberGenerator)
   return myRandomNumber
end

local function numberGenerator3()
    local myRandomNumber = math.random(80000, 180000)   
    timer.performWithDelay( 1000, numberGenerator)
   return myRandomNumber
end

time1 = numberGenerator1()
time2 = numberGenerator2()
time3 = numberGenerator3()


transition.to(blueTurtle,{x=50,y=350,time=time1})
transition.to(redTurtle,{x=150,y=350,time=time2})
transition.to(greenTurtle,{x=250,y=350,time=time3})

local function onCollision(event)
    if (event.phase == "began") then
        if(event.object2.myName == 'Blue Turtle') then
             print("Blue Turtle Wins")
             event.object2 = nil
             composer.gotoScene( "instruction", "fade", 500 )    

        elseif(event.object2.myName == 'Red Turtle') then
             print("Red Turtle Wins")
             event.object2 = nil
             composer.gotoScene( "instruction", "fade", 500 )    

        elseif(event.object2.myName == 'Green Turtle') then               
             print("Green Turtle Wins")      
             event.object2 = nil
             composer.gotoScene( "instruction", "fade", 500 )    


        end 
    end 


end

Runtime:addEventListener("collision",onCollision)

