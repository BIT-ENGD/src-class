users = {}

function create_new_user()
    print("Enter a unique user name (up to 12 letters): ")
    local name = io.read()
    if #name > 12 then 
        print ("That name is too long.")
        return create_new_user()
    elseif users[name] then
        print ("That name is already in use.")
        return create_new_user()
    else
        table.insert(users, 1, name)    
        print("Your new user name is: ", users[name])
    end
end

table.insert(users, 1, name)

Your new user name is:   nil

