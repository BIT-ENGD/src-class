 CountSubString = function(s,CtrlID)              --< s = string to count
  local t = Scintilla.GetText(CtrlID)
  if FindReplace.FindCase == 0 then               --< no case
   if FindReplace.FindWhole == 0 then             --< no whole word
    local _,count = string.gsub(t,s," ")
    return "Found "..count .." occourances of "..s 
   else                                           --< whole word
    local _,count = string.gsub(t,s," ")
    return "Found "..count .." occourances of "..s   
   end
  else                                            --< case
   if FindReplace.FindWhole == 0 then             --< no whole word
    local _,count = string.gsub(t,s," ")
    return "Found "..count .." occourances of "..s 
   else                                           --< whole word
    local _,count = string.gsub(t,s," ")
    return "Found "..count .." occourances of "..s   
   end 
  end
 end;

