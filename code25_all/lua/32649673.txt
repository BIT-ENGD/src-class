<Service>
<NewInstance ref="a39d725e7689b99e91af6fcb68bc5ec2">
<Std>DiscoveredElement</Std>
<Key>a39d725e7689b99e91af6fcb68bc5ec2</Key>
</NewInstance>
<NewRelationship>
<Parent>
<Instance ref="a39d725e7689b99e91af6fcb68bc5ec2" />
</Parent>
<Components>
<Instance ref="E0246C56D81A7A79559669CD16A8B555" />
<Instance ref="2D5481A0EA3F81AC1E06E2C32231F41B" />
</Components>
</NewRelationship>
<NewInstance ref="E961625723F5FDC8BD550077282E074C">
<Std>DiscoveredElement</Std>
<Key>E961625723F5FDC8BD550077282E074C</Key>
<Attributes>
<Attribute name="TARGET_TYPE" value="j2ee_application" />
<Attribute name="AppType" value="ear" />
<Attribute name="TARGET_GUID" value="E961625723F5FDC8BD550077282E074C" />
<Attribute name="TARGET_NAME" value="/Farm_b2b4_sys20_b2b4_domain/b2b4_domain/WLS_B2B4a/worklistapp" />
</Attributes>
</NewInstance>
<NewInstance ref="FD8A116D5C8DD2332B024BCBD6A81BD8">
<Std>DiscoveredElement</Std>
<Key>FD8A116D5C8DD2332B024BCBD6A81BD8</Key>
<Attributes>
<Attribute name="TARGET_TYPE" value="composite" />
<Attribute name="SERVICE_TYPE" value="" />
<Attribute name="TARGET_NAME" value="LAB-DB-B-AIX-Grp" />
<Attribute name="TARGET_GUID" value="FD8A116D5C8DD2332B024BCBD6A81BD8" />
</Attributes>
</NewInstance>
</Service>

local file = io.open("oem_1.xml", "rb")  
for instance, name, value in file:read("*a"):gmatch("<NewInstance ref=\"(E961625723F5FDC8BD550077282E074C)\"  />"):gmatch("<Attribute name=\"(TARGET_NAME)\" value=\"(.-)\" />"):gmatch("<Attribute name=\"(TARGET_TYPE)\" value=\"(.-)\" />")
do

    print(string.format("Instance: %s", instance))
    print(string.format("Name: %s\nValue: %s"\n", name, value)  
end

file:close()  

local file = io.open("oem_1.xml", "rb")   
for instance in file:read("*a"):gmatch("<NewInstance ref=\"(E961625723F5FDC8BD550077282E074C)\"  />")
do 
   for name, value in file:read("*a"):gmatch("<Attribute name=\"(TARGET_NAME)or(TARGET_TYPE)\" value=\"(.-)\" />")
    do  
        print(string.format("Name: %s\nValue: %s", name, value))    
    end
        print(string.format("Instance: %s", instance))
 end

file:close()   

