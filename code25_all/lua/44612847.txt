ssl_certificate_by_lua_block
/etc/init.d/nginx reload
ok
Reloading nginx configuration nginx                                  [ OK ]

nginx -t
nginx: the configuration file /etc/nginx/nginx.conf syntax is ok
nginx: configuration file /etc/nginx/nginx.conf test is successful

server {
    listen 443 ssl;
    server_name mydomain.com;

    # SSL
    ssl_certificate /etc/letsencrypt/live/mydomain.com/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/mydomain.com/privkey.pem;
    ssl_certificate_by_lua_block {
        print("About to initiate a new SSL handshake!")
    }
    location / {
        proxy_pass http://$host$request_uri;
        proxy_set_header X-Forwarded-Host $host;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_http_version 1.1;
    }

    access_log /var/log/nginx/mydomain.com-443.log cloudwatch_log;
    error_log /var/log/nginx/mydomain.com-443.error ;
}

nginx -V
nginx version: openresty/1.9.15.1
built by gcc 4.8.4 (Ubuntu 4.8.4-2ubuntu1~14.04.3)
built with OpenSSL 1.0.2l  25 May 2017
TLS SNI support enabled
configure arguments: --prefix=/usr/local/openresty/nginx --with-debug --with-cc-opt='-DNGX_LUA_USE_ASSERT
-DNGX_LUA_ABORT_AT_PANIC -O2' --add-module=../ngx_devel_kit-0.3.0 --add-module=../echo-nginx-module-0.59
--add-module=../xss-nginx-module-0.05 --add-module=../ngx_coolkit-0.2rc3
--add-module=../set-misc-nginx-module-0.30 --add-module=../form-input-nginx-module-0.12
--add-module=../encrypted-session-nginx-module-0.05 --add-module=../ngx_postgres-1.0rc7
--add-module=../srcache-nginx-module-0.31 --add-module=../ngx_lua-0.10.5 --add-module=../ngx_lua_upstream-0.05
--add-module=../headers-more-nginx-module-0.30 --add-module=../array-var-nginx-module-0.05 
--add-module=../memc-nginx-module-0.17 --add-module=../redis2-nginx-module-0.13 
--add-module=../redis-nginx-module-0.3.7 --add-module=../rds-json-nginx-module-0.14 
--add-module=../rds-csv-nginx-module-0.07 --with-ld-opt=-Wl,-rpath,/usr/local/openresty/luajit/lib 
--sbin-path=/usr/sbin/nginx --conf-path=/etc/nginx/nginx.conf --error-log-path=/var/log/nginx/error.log 
--http-client-body-temp-path=/var/lib/nginx/body --http-fastcgi-temp-path=/var/lib/nginx/fastcgi 
--http-log-path=/var/log/nginx/access.log --http-proxy-temp-path=/var/lib/nginx/proxy 
--http-scgi-temp-path=/var/lib/nginx/scgi --http-uwsgi-temp-path=/var/lib/nginx/uwsgi 
--lock-path=/var/lock/nginx.lock --pid-path=/var/run/nginx.pid --with-sha1=/usr/include/openssl 
--with-md5=/usr/include/openssl --with-http_stub_status_module --with-http_secure_link_module --with-pcre-jit 
--with-http_auth_request_module --with-http_addition_module --with-http_gunzip_module 
--with-http_image_filter_module --with-http_dav_module --with-http_flv_module --with-http_geoip_module 
--with-http_gzip_static_module --with-http_realip_module --with-http_stub_status_module --with-http_ssl_module 
--with-http_sub_module --with-http_xslt_module --with-stream --with-ipv6 --with-openssl=/root/openssl-1.0.2l

ssl_certificate_by_lua_block
