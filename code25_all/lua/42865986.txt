local module = {}

cache = {}
setmetatable(cache, { __mode = "k" })

function getItem(item)
  local result = cache[item] or cacheItem(item)
  return item    
end

function cacheItem(item)
  print("Caching item")
  cache[item] = true
  return cache[item]
end

function printCache()
  for key, value in pairs(cache) do
    print(key.name .. " and " .. value)
  end
end

module.printCache = printCache
module.getItem = getItem

return module

local module = require("./cache")

a = {
  name = "Jimmie"
}

function foo()
  local b = {
    name = "Bobbie"
  }

  local h1 = module.getCachedItem(a)
  module.getCachedItem(b)
  local h3 = module.getCachedItem({ name = "Lenny" })

  module.printCache()
end

foo()
module.printCache()

lua -v
