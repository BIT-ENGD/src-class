-- Time2Clip.lua -- VLC extension --
--[[
INSTALLATION:
Put the file in the VLC subdir /lua/extensions, by default:
* Windows (all users): %ProgramFiles%\VideoLAN\VLC\lua\extensions\
Restart the VLC.
Then you simply use the extension by going to the "View" menu and selecting it.
--]]
function descriptor()
   return {
      title = "Time2Clip";
      version = "1.0";
      author = "valuex";
      url = 'https://forum.videolan.org/viewtopic.php?f=29&t=101114';
      shortdesc = "Time2Clip";
      description = "<div style=\"background-color:lightgreen;\"><b>just a simple VLC extension </b></div>";
      capabilities = {"input-listener"}
   }
end
function activate()
   create_dialog()
end

function close()
   vlc.deactivate()
end

function create_dialog()
   w = vlc.dialog("Time2Clip")
   --w2 = w:add_button("Save_to_Clip", click_SAVE,2,1,1,1)
   click_SAVE()
end

function click_SAVE()
   local input = vlc.object.input()
   if input then
      local curtime=vlc.path()
     -- local curtime=vlc.var.get(input, "time")
     -- w2:set_text( curtime )
      save_to_clipboard(curtime)
   end
end

function save_to_clipboard(var)
   strCmd = 'echo '..var..' |clip'
   os.execute(strCmd)
   vlc.deactivate()
end

input.item(): Get the current input item. Input item methods are:
  :uri(): Get item's URI.
  :name(): Get item's name.

