-ffunction-sections
--icf=safe
-Wl,--icf=safe
-external-runtime
swg-oink.swg
swt_oink
%module swt_oink
%{ extern int oinker (const char *x); %}
extern int oinker (const char *x);

swg-barf.swg
swt_barf
%module swt_barf
%{ extern int barfer (const char *x); %}
extern int barfer (const char *x);

swt-main.cc
extern "C"
{
#include "lua.h"
#include "lualib.h"
#include "lauxlib.h"

extern int luaopen_swt_oink (lua_State *);
extern int luaopen_swt_barf (lua_State *);
}

int main ()
{
  lua_State *L = lua_open();
  luaopen_swt_oink (L);
  luaopen_swt_barf (L);
}

int oinker (const char *) { return 7; }
int barfer (const char *) { return 2; }

swig -lua -c++ swt-oink.swg
g++ -c -I/usr/include/lua5.1 swt-oink_wrap.cxx
swig -lua -c++ swt-barf.swg
g++ -c -I/usr/include/lua5.1 swt-barf_wrap.cxx
g++ -c -I/usr/include/lua5.1 swt-main.cc
g++ -o swt swt-main.o swt-oink_wrap.o swt-barf_wrap.o

_wrap.o
-ffunction-sections
-Wl,--icf=safe
nm
