$ luajit /tmp/test.lua
luajit: error loading module 'libqt_lua_lib' from file '/mnt/apps/qt_lua_lib/libqt_lua_lib.so':
        /mnt/apps/qt_lua_lib/libqt_lua_lib.so: undefined symbol: luaopen_libqt_lua_lib
stack traceback:
        [C]: at 0xb6efe464
        [C]: in function 'require'
        /tmp/test.lua:5: in main chunk
        [C]: at 0x00011bb4

-- Add Qt Lua Lib to module search path
package.cpath = package.cpath .. ";/mnt/apps/qt_lua_lib/?.so"

-- Use json parsers
qtLuaLib = require "libqt_lua_lib"

-- Call the Average Function
avg, sum = qtLuaLib.average(10, 20, 30, 40, 50)

print("The average is ", avg)
print("The sum is ", sum)

#include "qt_lua_lib.h"

/* the Lua interpreter */
lua_State* L;

QT_LUA_LIBSHARED_EXPORT static int luaopen_libqt_lua_lib(lua_State *l) {

    printf("Hello World!\n");

    return 0;

}

Qt_lua_lib::Qt_lua_lib()
{

    printf("Calling Qt Lua Lib Init\n");

    /* initialize Lua */
    L = lua_open();

    /* load Lua base libraries */
    luaL_openlibs(L);

    /* register our function */
    lua_register(L, "average", average);

    /* run the script */
    luaL_dofile(L, "avg.lua");

    /* cleanup Lua */
    lua_close(L);

    /* pause */
    printf( "Press enter to exit..." );
    getchar();

}

int Qt_lua_lib::average(lua_State *L)
{
    /* get number of arguments */
    int n = lua_gettop(L);
    double sum = 0;
    int i;

    /* loop through each argument */
    for (i = 1; i <= n; i++)
    {
        /* total the arguments */
        sum += lua_tonumber(L, i);
    }

    /* push the average */
    lua_pushnumber(L, sum / n);

    /* push the sum */
    lua_pushnumber(L, sum);

    /* return the number of results */
    return 2;
}

#ifndef QT_LUA_LIB_H
#define QT_LUA_LIB_H

#include "qt_lua_lib_global.h"

#include <stdio.h>

extern "C" {
    #include "lua.h"
    #include "lualib.h"
    #include "lauxlib.h"
}

class QT_LUA_LIBSHARED_EXPORT Qt_lua_lib
{

public:

    Qt_lua_lib();

    static int average(lua_State *L);

};

#endif // QT_LUA_LIB_H

#ifndef QT_LUA_LIB_GLOBAL_H
#define QT_LUA_LIB_GLOBAL_H

#if defined(QT_LUA_LIB_LIBRARY)
#  define QT_LUA_LIBSHARED_EXPORT __attribute__((visibility("default")))
#else
#  define QT_LUA_LIBSHARED_EXPORT __attribute__((visibility("default")))
#endif

#endif // QT_LUA_LIB_GLOBAL_H

    libqt_lua_lib.so
    librt.so.1 => /lib/librt.so.1 (0xdeadbeef)
    libpthread.so.0 => /lib/libpthread.so.0 (0xdeadbeef)
    libc.so.6 => /lib/libc.so.6 (0xdeadbeef)
    ld-linux-armhf.so.3 => /lib/ld-linux-armhf.so.3 (0xdeadbeef)
    libdl.so.2 => /lib/libdl.so.2 (0xdeadbeef)
    libluajit-5.1.so.2 => /usr/lib/libluajit-5.1.so.2 (0xdeadbeef)
    libm.so.6 => /lib/libm.so.6 (0xdeadbeef)
    libgcc_s.so.1 => /lib/libgcc_s.so.1 (0xdeadbeef)
    libstdc++.so.6 => /usr/lib/libstdc++.so.6 (0xdeadbeef)

Symbol table '.dynsym' contains 35 entries:
   Num:    Value  Size Type    Bind   Vis      Ndx Name
     0: 00000000     0 NOTYPE  LOCAL  DEFAULT  UND 
     1: 000007a8     0 SECTION LOCAL  DEFAULT    9 
     2: 00010b24     0 SECTION LOCAL  DEFAULT   18 
     3: 00010cb4     4 OBJECT  GLOBAL DEFAULT   22 L
     4: 00000000     0 FUNC    GLOBAL DEFAULT  UND lua_tonumber
     5: 00000000     0 FUNC    GLOBAL DEFAULT  UND lua_pushnumber
     6: 00010cb0     0 NOTYPE  GLOBAL DEFAULT   21 _edata
     7: 00000000     0 FUNC    GLOBAL DEFAULT  UND lua_pcall
     8: 00000000     0 FUNC    GLOBAL DEFAULT  UND lua_setfield
     9: 00000000     0 FUNC    GLOBAL DEFAULT  UND printf@GLIBC_2.4 (2)
    10: 00010cb8     0 NOTYPE  GLOBAL DEFAULT   22 __end__
    11: 00000000     0 FUNC    GLOBAL DEFAULT  UND puts@GLIBC_2.4 (2)
    12: 00000978   112 FUNC    GLOBAL DEFAULT   11 _ZN10Qt_lua_lib7averageEP9lua_State
    13: 00000000     0 FUNC    GLOBAL DEFAULT  UND luaL_openlibs
    14: 00000000     0 FUNC    GLOBAL DEFAULT  UND lua_gettop
    15: 00000ab8     0 FUNC    GLOBAL DEFAULT   12 _fini
    16: 00000000     0 FUNC    GLOBAL DEFAULT  UND lua_close
    17: 00010cb8     0 NOTYPE  GLOBAL DEFAULT   22 __bss_end__
    18: 00010cb8     0 NOTYPE  GLOBAL DEFAULT   22 _bss_end__
    19: 000007a8     0 FUNC    GLOBAL DEFAULT    9 _init
    20: 00000000     0 NOTYPE  WEAK   DEFAULT  UND _Jv_RegisterClasses
    21: 000009e8   204 FUNC    GLOBAL DEFAULT   11 _ZN10Qt_lua_libC1Ev
    22: 00010cb0     0 NOTYPE  GLOBAL DEFAULT   22 __bss_start__
    23: 00010cb8     0 NOTYPE  GLOBAL DEFAULT   22 _end
    24: 00000000     0 FUNC    GLOBAL DEFAULT  UND luaL_newstate
    25: 00010cb0     0 NOTYPE  GLOBAL DEFAULT   22 __bss_start
    26: 000009e8   204 FUNC    GLOBAL DEFAULT   11 _ZN10Qt_lua_libC2Ev
    27: 00000000     0 FUNC    GLOBAL DEFAULT  UND luaL_loadfile
    28: 00000000     0 FUNC    GLOBAL DEFAULT  UND getchar@GLIBC_2.4 (2)
    29: 00000000     0 NOTYPE  WEAK   DEFAULT  UND _ITM_deregisterTMCloneTable
    30: 00000000     0 FUNC    GLOBAL DEFAULT  UND __aeabi_unwind_cpp_pr0@GCC_3.5 (3)
    31: 00000000     0 NOTYPE  WEAK   DEFAULT  UND __gmon_start__
    32: 00000000     0 NOTYPE  WEAK   DEFAULT  UND _ITM_registerTMCloneTable
    33: 00000000     0 FUNC    WEAK   DEFAULT  UND __cxa_finalize@GLIBC_2.4 (2)
    34: 00000000     0 FUNC    GLOBAL DEFAULT  UND lua_pushcclosure

Symbol table '.symtab' contains 120 entries:
   Num:    Value  Size Type    Bind   Vis      Ndx Name
     0: 00000000     0 NOTYPE  LOCAL  DEFAULT  UND 
     1: 000000f4     0 SECTION LOCAL  DEFAULT    1 
     2: 00000118     0 SECTION LOCAL  DEFAULT    2 
     3: 000001f0     0 SECTION LOCAL  DEFAULT    3 
     4: 00000420     0 SECTION LOCAL  DEFAULT    4 
     5: 0000065a     0 SECTION LOCAL  DEFAULT    5 
     6: 000006a0     0 SECTION LOCAL  DEFAULT    6 
     7: 000006e0     0 SECTION LOCAL  DEFAULT    7 
     8: 00000730     0 SECTION LOCAL  DEFAULT    8 
     9: 000007a8     0 SECTION LOCAL  DEFAULT    9 
    10: 000007b4     0 SECTION LOCAL  DEFAULT   10 
    11: 00000880     0 SECTION LOCAL  DEFAULT   11 
    12: 00000ab8     0 SECTION LOCAL  DEFAULT   12 
    13: 00000ac0     0 SECTION LOCAL  DEFAULT   13 
    14: 00000b00     0 SECTION LOCAL  DEFAULT   14 
    15: 00000b18     0 SECTION LOCAL  DEFAULT   15 
    16: 00010b1c     0 SECTION LOCAL  DEFAULT   16 
    17: 00010b20     0 SECTION LOCAL  DEFAULT   17 
    18: 00010b24     0 SECTION LOCAL  DEFAULT   18 
    19: 00010b28     0 SECTION LOCAL  DEFAULT   19 
    20: 00010c48     0 SECTION LOCAL  DEFAULT   20 
    21: 00010cac     0 SECTION LOCAL  DEFAULT   21 
    22: 00010cb0     0 SECTION LOCAL  DEFAULT   22 
    23: 00000000     0 SECTION LOCAL  DEFAULT   23 
    24: 00000000     0 SECTION LOCAL  DEFAULT   24 
    25: 00000000     0 SECTION LOCAL  DEFAULT   25 
    26: 00000000     0 SECTION LOCAL  DEFAULT   26 
    27: 00000000     0 SECTION LOCAL  DEFAULT   27 
    28: 00000000     0 SECTION LOCAL  DEFAULT   28 
    29: 00000000     0 SECTION LOCAL  DEFAULT   29 
    30: 00000000     0 SECTION LOCAL  DEFAULT   30 
    31: 00000000     0 SECTION LOCAL  DEFAULT   31 
    32: 00000000     0 SECTION LOCAL  DEFAULT   32 
    33: 00000000     0 FILE    LOCAL  DEFAULT  ABS /home/abcd/Desktop/renesas_rza1/output/buildroot-2014.05/output/host/usr/arm-buildroot-linux-gnueabihf/sysroot/usr/lib/crti.o
    34: 00000880     0 NOTYPE  LOCAL  DEFAULT   11 $a
    35: 00000880     0 FUNC    LOCAL  DEFAULT   11 call_weak_fn
    36: 0000089c     0 NOTYPE  LOCAL  DEFAULT   11 $d
    37: 000007a8     0 NOTYPE  LOCAL  DEFAULT    9 $a
    38: 00000ab8     0 NOTYPE  LOCAL  DEFAULT   12 $a
    39: 0000000c     0 NOTYPE  LOCAL  DEFAULT   25 $d
    40: 00000000     0 FILE    LOCAL  DEFAULT  ABS /home/abcd/Desktop/renesas_rza1/output/buildroot-2014.05/output/host/usr/arm-buildroot-linux-gnueabihf/sysroot/usr/lib/crtn.o
    41: 000007b0     0 NOTYPE  LOCAL  DEFAULT    9 $a
    42: 00000abc     0 NOTYPE  LOCAL  DEFAULT   12 $a
    43: 0000005c     0 NOTYPE  LOCAL  DEFAULT   25 $d
    44: 00000000     0 FILE    LOCAL  DEFAULT  ABS crtstuff.c
    45: 00010b24     0 OBJECT  LOCAL  DEFAULT   18 __JCR_LIST__
    46: 000008a5     0 FUNC    LOCAL  DEFAULT   11 deregister_tm_clones
    47: 000008a4     0 NOTYPE  LOCAL  DEFAULT   11 $t
    48: 000008c4     0 NOTYPE  LOCAL  DEFAULT   11 $d
    49: 000008d4     0 NOTYPE  LOCAL  DEFAULT   11 $t
    50: 000008d5     0 FUNC    LOCAL  DEFAULT   11 register_tm_clones
    51: 000008f8     0 NOTYPE  LOCAL  DEFAULT   11 $d
    52: 00010cac     0 NOTYPE  LOCAL  DEFAULT   21 $d
    53: 00000908     0 NOTYPE  LOCAL  DEFAULT   11 $t
    54: 00000909     0 FUNC    LOCAL  DEFAULT   11 __do_global_dtors_aux
    55: 00000934     0 NOTYPE  LOCAL  DEFAULT   11 $d
    56: 00010cb0     1 OBJECT  LOCAL  DEFAULT   22 completed.9244
    57: 00010b20     0 NOTYPE  LOCAL  DEFAULT   17 $d
    58: 00010b20     0 OBJECT  LOCAL  DEFAULT   17 __do_global_dtors_aux_fini_array_entry
    59: 00000948     0 NOTYPE  LOCAL  DEFAULT   11 $t
    60: 00000949     0 FUNC    LOCAL  DEFAULT   11 frame_dummy
    61: 00000968     0 NOTYPE  LOCAL  DEFAULT   11 $d
    62: 00010b1c     0 NOTYPE  LOCAL  DEFAULT   16 $d
    63: 00010b1c     0 OBJECT  LOCAL  DEFAULT   16 __frame_dummy_init_array_entry
    64: 00010cb0     0 NOTYPE  LOCAL  DEFAULT   22 $d
    65: 00000000     0 FILE    LOCAL  DEFAULT  ABS qt_lua_lib.cpp
    66: 00000978     0 NOTYPE  LOCAL  DEFAULT   11 $a
    67: 000009e0     0 NOTYPE  LOCAL  DEFAULT   11 $d
    68: 00000b00     0 NOTYPE  LOCAL  DEFAULT   14 $d
    69: 000009e8     0 NOTYPE  LOCAL  DEFAULT   11 $a
    70: 00000a94     0 NOTYPE  LOCAL  DEFAULT   11 $d
    71: 00010cb4     0 NOTYPE  LOCAL  DEFAULT   22 $d
    72: 00000010     0 NOTYPE  LOCAL  DEFAULT   29 $d
    73: 00000ab4     0 NOTYPE  LOCAL  DEFAULT   11 $a
    74: 00000000     0 FILE    LOCAL  DEFAULT  ABS crtstuff.c
    75: 00000b18     0 NOTYPE  LOCAL  DEFAULT   15 $d
    76: 00000b18     0 OBJECT  LOCAL  DEFAULT   15 __FRAME_END__
    77: 00010b24     0 NOTYPE  LOCAL  DEFAULT   18 $d
    78: 00010b24     0 OBJECT  LOCAL  DEFAULT   18 __JCR_END__
    79: 00000000     0 FILE    LOCAL  DEFAULT  ABS 
    80: 00010cac     0 OBJECT  LOCAL  DEFAULT   21 __dso_handle
    81: 00010b28     0 OBJECT  LOCAL  DEFAULT  ABS _DYNAMIC
    82: 00010cb0     0 OBJECT  LOCAL  DEFAULT   21 __TMC_END__
    83: 00010c48     0 OBJECT  LOCAL  DEFAULT  ABS _GLOBAL_OFFSET_TABLE_
    84: 00000ac0     0 NOTYPE  LOCAL  DEFAULT   13 $d
    85: 000007b4     0 NOTYPE  LOCAL  DEFAULT   10 $a
    86: 000007c4     0 NOTYPE  LOCAL  DEFAULT   10 $d
    87: 000007c8     0 NOTYPE  LOCAL  DEFAULT   10 $a
    88: 00010cb4     4 OBJECT  GLOBAL DEFAULT   22 L
    89: 00000000     0 FUNC    GLOBAL DEFAULT  UND lua_tonumber
    90: 00000000     0 FUNC    GLOBAL DEFAULT  UND lua_pushnumber
    91: 00010cb0     0 NOTYPE  GLOBAL DEFAULT   21 _edata
    92: 00000000     0 FUNC    GLOBAL DEFAULT  UND lua_pcall
    93: 00000000     0 FUNC    GLOBAL DEFAULT  UND lua_setfield
    94: 00000000     0 FUNC    GLOBAL DEFAULT  UND printf@@GLIBC_2.4
    95: 00010cb8     0 NOTYPE  GLOBAL DEFAULT   22 __end__
    96: 00000000     0 FUNC    GLOBAL DEFAULT  UND puts@@GLIBC_2.4
    97: 00000978   112 FUNC    GLOBAL DEFAULT   11 _ZN10Qt_lua_lib7averageEP9lua_State
    98: 00000000     0 FUNC    GLOBAL DEFAULT  UND luaL_openlibs
    99: 00000000     0 FUNC    GLOBAL DEFAULT  UND lua_gettop
   100: 00000ab8     0 FUNC    GLOBAL DEFAULT   12 _fini
   101: 00000000     0 FUNC    GLOBAL DEFAULT  UND lua_close
   102: 00010cb8     0 NOTYPE  GLOBAL DEFAULT   22 __bss_end__
   103: 00010cb8     0 NOTYPE  GLOBAL DEFAULT   22 _bss_end__
   104: 000007a8     0 FUNC    GLOBAL DEFAULT    9 _init
   105: 00000000     0 NOTYPE  WEAK   DEFAULT  UND _Jv_RegisterClasses
   106: 000009e8   204 FUNC    GLOBAL DEFAULT   11 _ZN10Qt_lua_libC1Ev
   107: 00010cb0     0 NOTYPE  GLOBAL DEFAULT   22 __bss_start__
   108: 00010cb8     0 NOTYPE  GLOBAL DEFAULT   22 _end
   109: 00000000     0 FUNC    GLOBAL DEFAULT  UND luaL_newstate
   110: 00010cb0     0 NOTYPE  GLOBAL DEFAULT   22 __bss_start
   111: 000009e8   204 FUNC    GLOBAL DEFAULT   11 _ZN10Qt_lua_libC2Ev
   112: 00000000     0 FUNC    GLOBAL DEFAULT  UND luaL_loadfile
   113: 00000000     0 FUNC    GLOBAL DEFAULT  UND getchar@@GLIBC_2.4
   114: 00000000     0 NOTYPE  WEAK   DEFAULT  UND _ITM_deregisterTMCloneTable
   115: 00000000     0 FUNC    GLOBAL DEFAULT  UND __aeabi_unwind_cpp_pr0@@GCC_3.5
   116: 00000000     0 NOTYPE  WEAK   DEFAULT  UND __gmon_start__
   117: 00000000     0 NOTYPE  WEAK   DEFAULT  UND _ITM_registerTMCloneTable
   118: 00000000     0 FUNC    WEAK   DEFAULT  UND __cxa_finalize@@GLIBC_2.4
   119: 00000000     0 FUNC    GLOBAL DEFAULT  UND lua_pushcclosure

