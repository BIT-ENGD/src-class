lua: luaSocketTest.lua:15: interrupted!
stack traceback:
[C]: in function 'receive'
luaSocketTest.lua:15: in function 'doWork'
luaSocketTest.lua:22: in main chunk
[C]: ?

local socket = require ("socket")
local ip = "localhost"
local port = 5003

function doWork ()
    print ("Starting socket: "..ip..":"..port)
    client = assert(socket.connect(ip, port))
    print ("Socket Accepted")
    client:send("TEST TEST")
    while 1 do
      local byte, err = client:receive (1)
      if not err then
         print (byte)
      end
    end
end
while 1 do
  local status = pcall(doWork())
  print ("EXITED PCALL WITH STATUS: "..tostring(status))
  if not status then client:close() end
end

