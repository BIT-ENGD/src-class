local prev_function = function(event)

    if event.phase == "release" then

        today.year = 2012
        today.month = 3
        today.day = 29
        today.wday = 5


        if monthNum == 1 then 
            monthNum = 12
            yearNum = yearNum - 1
        elseif monthNum ~= 1 then
            monthNum = monthNum - 1
        end

        local month = ""

            if monthNum == 1 then month = "January"
        elseif monthNum == 2 then month = "February"
        elseif monthNum == 3 then month = "March"
        elseif monthNum == 4 then month = "April"
        elseif monthNum == 5 then month = "May"
        elseif monthNum == 6 then month = "June"
        elseif monthNum == 7 then month = "July"
        elseif monthNum == 8 then month = "August"
        elseif monthNum == 9 then month = "September"
        elseif monthNum == 10 then month = "October"
        elseif monthNum == 11 then month = "November"
        elseif monthNum == 12 then month = "December"
           end

        monthText.text = month .. " " .. yearNum

        print("Table elements before button deletion: " .. #buttonTable)

        for i = #buttonTable, 1, -1 do
            --[[if button[i] ~= nil then
                table.remove(buttonTable)
                button[i]:removeSelf()
                button[i] = nil
            end--]]

            local child = table.remove(buttonTable)
            if child ~= nil then
                child:removeSelf()
                child = nil
            end
        end

        print("Table elements after button deletion: " .. #buttonTable)

        next_button.alpha = 1


        for i = 1, math.floor(numYears * 365.25) do

            dateTable[i] = calendar.getInfo(today) --calculate the next day's date

            if dateTable[i].year == yearNum and dateTable[i].month == monthNum then  -- create a button if the date's year and month match the desired month
                button[i] = ui.newButton{
                    default = "images/day.png",
                    over = "images/dayover.png",
                    text = dateTable[i].day,
                    size = 30,
                    font = native.systemFontBold,
                    textColor = {0, 0, 0, 255},
                    onEvent = addExpense_function,
                    offset = -35        }

                    if dateTable[i].wday == 1 then button[i].x = math.floor(col/2)
                elseif dateTable[i].wday == 2 then button[i].x = (col * 1) + math.floor(col/2)
                elseif dateTable[i].wday == 3 then button[i].x = (col * 2) + math.floor(col/2)
                elseif dateTable[i].wday == 4 then button[i].x = (col * 3) + math.floor(col/2)
                elseif dateTable[i].wday == 5 then button[i].x = (col * 4) + math.floor(col/2)
                elseif dateTable[i].wday == 6 then button[i].x = (col * 5) + math.floor(col/2)
                elseif dateTable[i].wday == 7 then button[i].x = (col * 6) + math.floor(col/2)
                     end

                    if dateTable[i].day == 1 then button[i].y = wDayBar.y + wDayBar.height/2 + math.floor(row/2)
                elseif dateTable[i].wday == 1 then button[i].y = button[i-1].y + row
                else button[i].y = button[i-1].y
                     end        
            end

            today = dateTable[i]
            table.insert(buttonTable, button[i])
            --button[i].id = "button_" .. i

        end
        print("Table elements after button creation: " .. #buttonTable)

    end

    return true

end

