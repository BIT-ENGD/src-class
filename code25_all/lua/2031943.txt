local capitalize = function(s)
  return string.gsub (s,
    "(%w)([%w]*)",
    function (first, rest) 
      return string.upper(first) .. rest
    end, 
    1 )
end

string.capitalize = function(s)
  ... etc etc (same code as above)

str = str:gsub("^%l", string.upper)

