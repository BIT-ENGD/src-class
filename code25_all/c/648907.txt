string
string new = make("Hello, ");
adds(new, "everyone");
free(new);

string new = make("Hello, ");
adds(new, "everyone!");
free(new);

adds()
!
string new = make("Hello, ");
adds(new, "everyone");
adds(new, "!");
free(new);

addc()
string new = make("Hello, ");
adds(new, "everyone");
addc(new, '!');
free(new);

string new = make("Hello, everyone!");
free(new);

test(526) malloc: *** error for object 0x100130: double free
*** set a breakpoint in malloc_error_break to debug

test
make()
strlen()
malloc()
memcpy()
adds()
strlen()
realloc()
memcpy()
free()
free()
adds()
addc()
typedef struct _str {
  int _len;
  char *_str;
} *string;

string make(char *c)
{
    string s = malloc(sizeof(string));
    if(s == NULL) return NULL;
    s->_len = strlen(c);
    s->_str = malloc(s->_len + 1);
    if(s->_str == NULL) 
      {     
        free(s);
        return NULL;
      }
    memcpy(s->_str, c, s->_len);
    return s;
}

int adds(string s, char *c)
{
    int l = strlen(c);
    char *tmp;
    if(l <= 0) return -1;
    tmp = realloc(s->_str, s->_len + l + 1);
    if(!tmp) return 0;
    memcpy(s->_str + s->_len, c, l);
    s->_len += l;
    s->_str[s->_len] = 0;
    return s->_len;
}

void myfree(string s)
{
    if(s->_str) free(s->_str);
    free(s);
    s = NULL;
    return;
}

