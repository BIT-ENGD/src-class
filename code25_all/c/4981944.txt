WORD buff_in(CBUFF *bp, BYTE *data, WORD len)
{
    WORD in, n, n1, n2;
    in = (WORD)bp->in & (bp->len-1); 
    n = minw(len, buff_freelen(bp)); 
    n1 = minw(n, (WORD)(bp->len - in)); 
    n2 = n - n1; 
    if (n1 && data) memcpy(&bp->data[in], data, n1); 
    if (n2 && data) memcpy(bp->data, &data[n1], n2); 
    bp->in += n; 
    return(n);
}

