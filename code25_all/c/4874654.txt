int main()
{
  int ret = 0;

  void * ptr1 = NULL;
  if (ret = do_ptr_work(ptr1))
    goto done;

  void * ptr2 = NULL;
  if (ret = do_ptr_work(ptr2))
    goto done;

done:
  if (ptr1) {
    free(ptr1);
    ptr1 = NULL;
  }
  if (ptr2) {
    free(ptr2);
    ptr2 = NULL;
  }

  return ret;
}

