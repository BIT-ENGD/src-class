struct shmstruct{
    int pid[50];
    char user[50][10];
};

struct  shmstruct *shmobj;
void    *shmp;

int main()
{
    //server creates shared memory
    if((shmid = shmget((key_t)1234,sizeof(struct shmstruct),0666|IPC_CREAT)) == -1){
        fprintf(stderr,"shmget failed\n");
        exit(EXIT_FAILURE);
    }

    //server attaches shared memory segment to pointer (void *)
    if((shmp = shmat(shmid,(void *) 0,0)) == (void *)-1){
        fprintf(stderr,"shmat failed\n");
        exit(EXIT_FAILURE);
    }

    //structure is now linked with shared memory pointer
    printf("Memory attached at %X\n",shmp);
    shmobj = (struct shmstruct *)shmp;

    int i;
    for(i = 0; i < 50; i++)
        if(shmobj->pid[i]!=0)
            printf("shminit:i:%d user:%s pid:%d\n", i, shmobj->user[i], shmobj->pid[i]);
}

shminit:i:1 user: pid:2673

