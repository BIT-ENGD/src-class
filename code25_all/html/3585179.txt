function endSession() {
 location.replace('/login/');
}

var validNavigation = false;

function wireUpEvents() {
 // Attach the event click for all links in the page
 $("a").bind("click", function() {
   validNavigation = true;
 });

 // Attach the event submit for all forms in the page
 $("form").bind("submit", function() {
  validNavigation = true;
 });

 // Attach the event submit for all submit buttons in the page
 $("input:submit").bind("click", function() {
  validNavigation = true;
 });

 // Attach the event submit for all submit buttons in the page
 $("input:button").bind("click", function() {
  validNavigation = true;
 });

 $("form").manualSubmit = function(){
  validNavigation = true;
  this.submit();
 };
}

// Wire up the events as soon as the DOM tree is ready
$(document).ready(function() {
    wireUpEvents();
    /*
 * For a list of events that triggers onbeforeunload on IE
 * check http://msdn.microsoft.com/en-us/library/ms536907(VS.85).aspx
 */
 window.onbeforeunload = function() {
  if (!validNavigation) {
   endSession();
  }
 }
});

$('form').get(0).submit();

$('form').get(0).manualSubmit();
