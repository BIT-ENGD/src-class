<input type="checkbox" id="checkall"  class="checkall" name="checkall">

$(document).ready(function(){
    $('#checkall').toggle(function(){
        $('input:checkbox').attr('checked','checked');
        $(this).val('uncheck all')
    },function(){
        $('input:checkbox').removeAttr('checked');
        $(this).val('check all');        
    })
})


$('input:checkbox').click(function() {
    $("#userInfo").toggle(!($('input:checkbox:checked').length == 0));  
});

$('#close').click(function() {
    $("#userInfo").hide();
    $('input:checkbox').removeAttr('checked');  
});

function updateTextArea() 
    {
         var allVals = [];
         $('#c_b :checked').each(function(){
           allVals.push($(this).val());
         });
         jQuery('#ticketIds').val(allVals);  
    }
    $(function() 
    {
          $('#c_b input').click(updateTextArea);
          updateTextArea();
    });

<form method="post" name="edit">  
   <input type="hidden" id="ticketIds" name="ticketIds" value="">       
   <input type="submit" class="button gray" value="Okay, do it" name=""> <a href="#" id="close">Close</a></form>

