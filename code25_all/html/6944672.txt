<html>
    <head>
        <script type="text/javascript">
            window.dialog = new Object();

            var myFunc = function() { window.alert('hello')};

            function test(){
                window.dialog.open('DummyDialog.htm',myFunc,false);
                };


            window.dialog.open = function(sUrl, fpReturn, bNoResize) {

                window.dialog.__returnFunction = fpReturn;
                window.dialog.returnValue = null;

                window.dialog.arguments = new Array();
                for (var x = 2; x < arguments.length; x++) {
                    window.dialog.arguments[x - 2] = arguments[x];
                }

                window.dialog.arguments[window.dialog.arguments.length] = window;

                sUrl += new Date().getTime().toString(); 


                var sFeatures;
                var nWidth = 500;    var nHeight = 500;    var nLeft = 100;    var nTop =  100;

                if (window.dialog.position) {
                    nLeft = window.dialog.position.left;
                    nTop = window.dialog.position.top;
                    window.dialog.position = null;
                } 

                if (sUrl.indexOf("?") != -1) {
                    var pairs = sUrl.split("?")[1].split("&");
                    var aValue, pos;
                    for (var i = 0; i < pairs.length; i++) {
                        if (pairs[i].toUpperCase().indexOf("SIZE") == 0) {
                            aValue = pairs[i].split("=")[1].split(",");
                            if (aValue.length == 2) {
                                nWidth = parseInt(aValue[0]);
                                nHeight = parseInt(aValue[1]);
                                break;
                            } else if (aValue.length == 4) {
                                nWidth = parseInt(aValue[0]);
                                nHeight = parseInt(aValue[1]);
                                nLeft = parseInt(aValue[2]);
                                nTop = parseInt(aValue[3]);
                                break;
                            }
                        }
                    }
                }

                nTop -= 1;

                sFeatures = "";

                window.dialog.arguments._gotoURL = sUrl;
                window.dialog.arguments._dialogTitle = 'my title';
                window.dialog.returnValue = window.showModalDialog("DummyDialog.htm", window.dialog.arguments, sFeatures);
            };
        </script>
    </head>
    <body>
        <a href="#" onclick="test();">Test Window</a>
    </body>
</html>

<html>
    <head>
        <script type="text/javascript">
            window.dialog = new Object();

            var myFunc = function() { window.alert('hello')};

            function test(){
                window.dialog.open('DummyDialog.htm',myFunc,false);
                };


            window.dialog.open = function(sUrl, fpReturn, bNoResize) {

                window.dialog.__returnFunction = fpReturn;
                window.dialog.returnValue = null;

                window.dialog.arguments = new Array();
                for (var x = 2; x < arguments.length; x++) {
                    window.dialog.arguments[x - 2] = arguments[x];
                }

                if (true) {//if (is.ie) {
                    window.dialog.arguments[window.dialog.arguments.length] = window;
                }

                sUrl += new Date().getTime().toString();
                // in pixels
                var sFeatures;
                var nWidth = 500;
                var nHeight = 500;
                var nLeft = 100;
                var nTop =  100;

                if (window.dialog.position) {
                    nLeft = window.dialog.position.left;
                    nTop = window.dialog.position.top;
                    window.dialog.position = null;
                } 

                if (sUrl.indexOf("?") != -1) {
                    var pairs = sUrl.split("?")[1].split("&");
                    var aValue, pos;
                    for (var i = 0; i < pairs.length; i++) {
                        if (pairs[i].toUpperCase().indexOf("SIZE") == 0) {
                            aValue = pairs[i].split("=")[1].split(",");
                            if (aValue.length == 2) {
                                nWidth = parseInt(aValue[0]);
                                nHeight = parseInt(aValue[1]);
                                break;
                            } else if (aValue.length == 4) {
                                nWidth = parseInt(aValue[0]);
                                nHeight = parseInt(aValue[1]);
                                nLeft = parseInt(aValue[2]);
                                nTop = parseInt(aValue[3]);
                                break;
                            }
                        }
                    }
                }

                nTop -= 1;      
                sFeatures = "";
                window.dialog.arguments._gotoURL = 'download.aspx?file=MyTestFile.txt';
                window.dialog.arguments._dialogTitle = 'my title';//window.getTitle();
                window.dialog.returnValue = window.showModalDialog('download.aspx?file=MyTestFile.txt', window.dialog.arguments, sFeatures);

            };
        </script>
    </head>
    <body>
        <a href="#" onclick="test();">Test Window</a>
    </body>
</html>

<%@ Page language="vb" runat="server" explicit="true" strict="true" %>
<script language="vb" runat="server">
Sub Page_Load(Sender As Object, E As EventArgs)
    Dim strRequest As String = Request.QueryString("file") '-- if something was passed to the file querystring
    If strRequest <> "" Then 'get absolute path of the file
        Dim path As String = Server.MapPath(strRequest) 'get file object as FileInfo
        Dim file As System.IO.FileInfo = New System.IO.FileInfo(path) '-- if the file exists on the server
        If file.Exists Then 'set appropriate headers
            Response.Clear()
            Response.AddHeader("Content-Disposition", "attachment; filename=" & file.Name)
            Response.AddHeader("Content-Length", file.Length.ToString())
            Response.ContentType = "application/octet-stream"
            Response.WriteFile(file.FullName)
            Response.End 'if file does not exist
        Else
            Response.Write("This file does not exist.")
        End If 'nothing in the URL as HTTP GET
    Else
        Response.Write("Please provide a file to download.")
    End If
End Sub
</script>

<Root>
  <Tag>Hello World</Tag>
</Root>

