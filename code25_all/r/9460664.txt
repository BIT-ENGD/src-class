2396x34 double matrix
y
numeric[34]
x
y
x
crs[,2] <- cor(t(y),x)
cor
xy.wt
Weighted Covariance Matrix
cov.wt
scale
cor
x
y
y
cor
xy.wt/sum(xy.wt)
corr
boot
corr(d, w = rep(1, nrow(d))/nrow(d))

d   
A matrix with two columns corresponding to the two variables whose correlation we wish to calculate.

w   
A vector of weights to be applied to each pair of observations. The default is equal weights for each pair. Normalization takes place within the function so sum(w) need not equal 1.

x<-cumsum(rnorm(34))
y<- t(sapply(1:2396,function(u) cumsum(rnorm(34))))
xy.wt<-1/(34:1)

crs<-cor(t(y),x) #this works but I want to use xy.wt as weight

