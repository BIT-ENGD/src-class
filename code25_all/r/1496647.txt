invquad<-function(a,b,c,y,roots="both")
{
    #Calculate the inverse of a quadratic function y=ax^2+bx+c (i.e. find x when given y.)
    #Gives NaN with non real solutions.
    root1<-sqrt((y-(c-b^2/(4*a)))/a)-(b/(2*a))
    root2<--sqrt((y-(c-b^2/(4*a)))/a)-(b/(2*a))
    if (roots=="both")
        result<-c(root1,root2)
    if (roots=="min")
        result<-min(root1,root2)
    if (roots=="max")
        result<-max(root1,root2)
    result
}

