> x <- rnbinom(100, mu = 10, size = 10)
> hdev <- function(par) {
+     -sum(dnbinom(x, mu = par[1], size = par[2], log = TRUE))
+ }
> nlminb(c(9, 12), hdev)
$par
[1] 9.730000 5.954936
$objective
[1] 297.2074
$convergence
[1] 0
$message
[1] "relative convergence (4)"
$iterations
[1] 10
$evaluations
function gradient
      12       27

x, y
z
z
> x <- rnbinom(100, mu = 10, size = 10)
> y <- rnbinom(100, mu = 10, size = 10)
> z <- rep(1:3, length=100)
> A <- cbind(x,y,z)
> hdev <- function(par) {
+     -sum(dnbinom(x+y, mu = par[1], size = par[2], log = TRUE))}

nlminb(c(9, 12), hdev)
z
nlminb(c(9, 12), hdev)
z=1, z=2
z=3
by(A, z, function(A) nlminb(c(9,12), hdev))
sparseby(A, z, function(A) nlminb(c(9,12), hdev))
z
[1] Z1_ANSWER_1 Z1_ANSWER_2
[2] Z2_ANSWER_1 Z2_ANSWER_2
[3] Z3_ANSWER_1 Z3_ANSWER_2

CASEZ1<-nlminb$par, CASEZ2<-nlminb$par, CASEZ3<-nlminb$par
z
