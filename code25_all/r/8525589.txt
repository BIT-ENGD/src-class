RODBC
odbcCloseAll
require(RODBC)
filename <- tempfile(fileext='.xls')
for(i in 1:100) {
xlsFile <- odbcConnectExcel(filename, readOnly=FALSE)
sqlSave(xlsFile, USArrests, rownames = FALSE)
odbcCloseAll()
xlsFile <- odbcConnectExcel(filename, readOnly=FALSE)
template <- sqlFetch(xlsFile, "USArrests")
odbcCloseAll()
file.remove(filename)
}

i = 50
Error in sqlSave(xlsFile, USArrests, rownames = FALSE) : 
  table ‘USArrests’ already exists
In addition: Warning message:
In file.remove(filename) :
  cannot remove file 'c:\DOCUME~1\user\LOCALS~1\Temp\RtmpSFDDiG\file43522f58.xls', reason 'Permission denied'

odbcClose(xlsFile)
odbcCloseAll
