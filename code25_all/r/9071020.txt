P
S
P = S (S'S) ^ -1 S'

P <- function(S){
  output <- S %*% solve(t(S) %*% S) %*% t(S)
  return(output)
}

# Error in solve.default(t(S) %*% S, t(S), tol = 1e-07) : 
#  system is computationally singular: reciprocal condition number = 2.26005e-28

output <- S %*% solve (t(S) %*% S, t(S), tol=1e-7)

