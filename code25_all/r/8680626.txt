plotReturns(8, "1930-01-01", "1940-12-31", "savehere.pdf")
savehere.pdf
savehere.pdf
plotReturns = function(decileValue, startDate, endDate, fileName) {
  # Keep data from specific decile
  specificdecile <- merged.data[merged.data$decile_correct == decileValue,]

  #filter the data to get rows within the specified dates
  specificdecileAndYears <- specificdecile[
                            ((specificdecile$rdate >= as.Date(startDate)) &
                              (specificdecile$rdate <= as.Date(endDate))),]
  #keep the necessary columns:rdate, decile_correct, vwret_bottomup, vwret_CRSP
  specificdecileAndYears <- specificdecileAndYears[c("rdate", "decile_correct", 
                                                     "vwret_bottomup", "vwret_CRSP")]
  # Melt the data for plotting
  melted.data <- melt(specificdecileAndYears, id=c("rdate","decile_correct"))

  # Use melted data for plotting

  # Set the plot title
  title <- paste("Plot for decile", decileValue)

  # Specifing colors to be used for line plots
  myColors <- c("steelblue", rgb(1,0.5,0.3,0.5))
  fileName <- fileName

  pdf(fileName, width=8, height=5)

  # scale_color_manual is to use custom colors specified in myColors above.
  # The first argument of scale_color_manual specifies the title of the legend,
  # which is set to empty here.
  ggplot(melted.data, aes(x=rdate, y=value, color=variable)) + geom_line() +
      opts(legend.position=c(0.85,0.2), legend.background=theme_rect(col=0), title=title) +
      scale_color_manual("", values=myColors) +
      ylab("Return") + xlab("")

  # turn device off
  dev.off() 
}

