ID      REGIONA REGIONB REGIONC
A        North     NA      NA
A        South     NA      NA
B        NA      East      NA
B        NA      West      NA
C        NA        NA     North
C        NA        NA     East

ID      REGION
A        North    
A        South     
B        East      
B        West      
C        North       
C        East     

within(df, x3 <- ifelse(is.na(x1), x2, x1))
