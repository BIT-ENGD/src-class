#Load the library
library(ggplot2)
library(Deducer)

data(mpg)

#Create a function to calculate the points

#a built-in function that does this

get_tails = function(x) {
    q1 = quantile(x)[2]
    q3 = quantile(x)[4]
    iqr = q3 -q1
    upper = q3+1.5*iqr
    lower = q1-1.5*iqr

    #Trim upper and lower
    up = max(x[x < upper])
    lo = min(x[x > lower])
    return(c(lo, up)
}

library(ggplot2)
ggplot(mpg, aes(x=drv,y=hwy)) + geom_boxplot( width=0.5) + 
    stat_summary(geom="point", fun.y= get_tails, pch=4, size=3, colour="red")

