site   date  var   dil
   1    A    7.4   2 
   2    A    6.5   2
   1    A    7.3   3
   2    A    7.3   3
   1    B    7.1   1
   2    B    7.7   2
   1    B    7.7   3
   2    B    7.4   3

wt
site
date
> weight <- function(dil){
                    dil/sum(dil)
                     }

site
date
> df$wt <- ddply(df,.(date,site),.fun=weight)

Error in FUN(X[[1L]], ...) : 
  only defined on a data frame with all numeric variables

