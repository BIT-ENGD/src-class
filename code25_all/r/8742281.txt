times <- as.POSIXct("1970-01-01")+1:100
vals <- sample.int(2,100,replace=TRUE)
df <- data.frame(times,vals)
ddply(df, .(vals,round(times,"mins")), function(x)nrow(x))
Error in if (n > 2^31) { : missing value where TRUE/FALSE needed

