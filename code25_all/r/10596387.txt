ALGO <- function(y1) {
  nd.in.y1 <- .indexday(new_data) %in% .indexday(y1)
  low <- last(new_data[nd.in.y1 & index(new_data) < index(y1)],15)
  high <- first(new_data[nd.in.y1 & index(new_data) > index(y1)],15)
  ccc <- rbind(low,high)
  # ...
  # Make some calculations
  # ...
  return(number)
}

