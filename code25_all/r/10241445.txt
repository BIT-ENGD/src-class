ggplot(diamonds, aes(x=factor(color),fill=factor(cut)))+geom_bar(position="fill")
subset(diamonds,carat>3)

