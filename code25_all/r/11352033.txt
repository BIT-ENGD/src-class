library(chron)
set.seed(42)
dat <- data.frame(sales = rnorm(1000, mean = 1000, sd = 40),
              dates = rep(as.Date(seq(from = 14610, to = 14859),
                              origin = "1970-01-01"),4))
aggregate(sales~months(as.chron(dates)), mean, data=dat)

months(as.chron(dates))     sales
1                     Jan 1000.0723
2                     Feb  999.1580
3                     Mar  995.3055
4                     Apr 1000.4912
5                     May 1003.9703
6                     Jun  997.1086
7                     Jul  996.5939
8                     Aug  998.5012
9                     Sep 1001.3709

cast(dat, months(as.chron(dates)) ~ ., mean, value="sales")

Error: Casting formula contains variables not found in molten data: months(as.chron(dates))

dat$mont <- months(as.chron(dat$dates))
cast(dat, mont ~ ., mean, value="sales")

