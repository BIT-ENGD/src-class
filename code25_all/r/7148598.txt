 xa=aggregate(x$avg,by=list(x$value),FUN=weighted.mean,w=x$weight)

weighted.mean(x$avg,w=x$weight);
