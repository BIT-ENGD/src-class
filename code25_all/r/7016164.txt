doc_id,link
1,http://example.com
1,http://example.com
2,http://test1.net
2,http://test2.net
2,http://test5.net
3,http://test1.net
3,http://example.com
4,http://test5.net

link_matrix <- daply(link_list, .(doc_id, link), summarise, nrow(piece))

doc_id http://example.com http://test1.net http://test2.net http://test5.net
     1 List,1             NULL             NULL             NULL            
     2 NULL               List,1           List,1           List,1          
     3 List,1             List,1           NULL             NULL            
     4 NULL               NULL             NULL             List,1 

doc_id http://example.com http://test1.net http://test2.net http://test5.net
     1 2                  0                0                0            
     2 0                  1                1                1          
     3 1                  1                0                0            
     4 0                  0                0                0

daply
