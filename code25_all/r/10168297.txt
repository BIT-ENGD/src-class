          for (nn in 1:length(nSim))  ##whether the right loop???
              {
              r.all <- c()
              p.final <- array(0, c(15,5))  #1-5 a, b1, b2, b3, b4; 6 group id
              r.reference <- cbind(GRM_sim(t(p.sample[,1]), t(p.sample[,2:5]),sample.all[iS],0,rep(1,sample.all[iS]))

            DIF_ID <-c()
            DIF_index <- rep(0,15)
            for (iC in 1:length(CDIF))
            {
              if (CDIF[iC]==1)
              {
                DIF_ID <- sample(1:15,DIF.all[iDIF.all])   ##consistent DIF 
              }
               for (id in 1:length(DIF_ID))
               {
                  DIF_index[DIF_ID[id]] <-1
               }
              ...

