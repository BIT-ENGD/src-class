datasettable = addmargins(
  table(dataset[c('observer','condition','stimulus1', 'stimulus2','response')]), 
  4, FUN = sum)

datasettable[,'u',1,'sum',]

datasettable ['obsever'=='ALL','condition'=='u',
  'stimulus1'==1, 'stimulus2'=='sum','response'=='ALL']

