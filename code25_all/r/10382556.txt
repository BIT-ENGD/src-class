x = c(1, 2, 3.5, 4, 6, 7.5, 8, 9, 10, 11.5, 12) 
y = c(2.5, 6.5) 
I = split(x, findInterval(x, y))
f = function(I$'i', x) {
        d = pmax(outer(x, I$'i', "-"), 0)
        colSums(d - d^2/2)
}

for(i in 0:length(I)-1){
    max.value = I$'i'[which.max(f(I$'i', x))]
}

