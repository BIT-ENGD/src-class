    a    b    c    d    e
1   1    1    1    1    15.5
2   1    1    1    2    8.3
3   1    1    2    1    12.4
4   1    1    2    2    3.2
...

f(x,y)
e
d
e
d
e
f(x,y)
    a    b    c     e
1   1    1    1     23.8
3   1    1    2     15.6
...

data.d1 <- subset(data, d==1)
for (index in 1:nrow(data.d1))
  row1 <- data.d1[index,]
  row2 <- data[data$a==row1$a & data$b==row1$b & data$c==row1$c & data$d==2,]
  data[index,"e"] <- f(row1$e, row2$e)
}
data <- data[-match(c("d"), names(data))]

apply()
