diag
diag
diag(x = 1, nrow, ncol) # returns the values of the diagonal
diag(x) <- value # inserts values on the diagonal

diag.ind
'diag.ind'<-function(x,k=0){
   if(k=='') k=0
   x<-as.matrix(x)

   if(dim(x)[2]==dim(x)[1]){
     stp_pt_r<-dim(x)[1]
     stp_pt_c<-dim(x)[2]
   }
   if(ncol(x)> dim(x)[1]){
     stp_pt_r<-dim(x)[1]
     stp_pt_c<-stp_pt_r + 1
   }
   if(ncol(x)< dim(x)[1]){
    stp_pt_c<-dim(x)[2]
    stp_pt_r<-stp_pt_c+1
   }

   if(k==0){
   r<-as.matrix(seq(1,stp_pt_r,by=1))
   c<-as.matrix(seq(1,stp_pt_c,by=1))
   ind.r<- cbind(r,c)
   }
  if(k>0){
    r<-t(as.matrix(seq(1,stp_pt_r,by=1)))
    c<-t(as.matrix(seq((1+k),stp_pt_c,by=1)))
   ind<-t(rbind.fill.matrix(r,c))
   ind.r<-ind[!is.na(ind[,2]),]
  }
  if(k<0){
    k<-abs(k)
    r<-t(as.matrix(seq((1+k),stp_pt_r,by=1)))
    c<-t(as.matrix(seq(1,stp_pt_c,by=1)))
    ind<-t(rbind.fill.matrix(r,c))
    ind.r<-ind[!is.na(ind[,1]),]
  }
diag.x<-x[ind.r]

output<-list(diag.x=diag.x, diag.ind=ind.r)
return(output)
}

