         LongEntrySignal ShortEntrySignal LongExitSignal ShortExitSignal Signal
18.02.93               0                0              1               0      0
19.02.93               0                0              0               1      0
22.02.93               1                0              0               0      1
23.02.93               0                0              0               0      0
24.02.93               0                0              0               0      0
25.02.93               0                0              0               0      0
26.02.93               0                0              1               0      0
01.03.93               0                0              1               0      0
04.03.93               0                1              0               0     -1
05.03.93               0                0              0               0      0
11.03.93               0                0              0               1      0
12.03.93               0                0              1               0      0

         LongEntrySignal ShortEntrySignal LongExitSignal ShortExitSignal Signal
18.02.93               0                0              1               0      0
19.02.93               0                0              0               1      0
22.02.93               1                0              0               0      1
23.02.93               0                0              0               0      1
24.02.93               0                0              0               0      1
25.02.93               0                0              0               0      1
26.02.93               0                0              1               0      1
01.03.93               0                0              1               0      0
04.03.93               0                1              0               0     -1
05.03.93               0                0              0               0     -1
11.03.93               0                0              0               1     -1
12.03.93               0                0              1               0      0

padMinusPlusOnes<-function(signals, longEntryColumn=1, shortEntryColumn=2, signalsColumn=5) {   
    ret<-signals
#get all indexes between long entry equals 1 to long exit equals 1 and set signalsColumn for these rows to 1
    ret[(lag(ret)[, longEntryColumn] == 1) & (ret[, signalsColumn] == 0), signalsColumn]<-1
#get all indexes between short entry equals 1 to short exit equals 1 and set signalsColumn for these rows to -1
    ret[(lag(ret)[, shortEntryColumn] == -1) & (ret[, signalsColumn] == 0), signalsColumn]<--1

    return(ret)

#   ret<-signals
#   for (i in 2:NROW(ret)) {
#       if ((ret[i - 1, longEntryColumn] == 1) & (ret[, signalsColumn] == 0)) {
#           ret[i, signalsColumn]<-1
#       }
#       if ((ret[i - 1, shortEntryColumn] == -1) & (ret[, signalsColumn] == 0)) {
#           ret[i, signalsColumn]<--1
#       }
#   }
#   
#   return(ret)
}

         LongEntrySignal ShortEntrySignal LongExitSignal ShortExitSignal Signal
18.02.93               0                0              0               0      0
19.02.93               0                0              0               0      0
22.02.93               1                0              0               0      1
23.02.93               0                0              0               0      0
24.02.93               0                0              0               0      0
25.02.93               0                0              0               0      0
26.02.93               0                0              1               0      0
01.03.93               0                0              0               0      0
04.03.93               0                1              0               0     -1
05.03.93               0                0              0               0      0
11.03.93               0                0              0               1      0
12.03.93               0                0              0               0      0

         LongEntrySignal ShortEntrySignal LongExitSignal ShortExitSignal Signal
18.02.93               0                0              0               0      0
19.02.93               0                0              0               0      0
22.02.93               1                0              0               0      1
23.02.93               0                0              0               0      1
24.02.93               0                0              0               0      1
25.02.93               0                0              0               0      1
26.02.93               0                0              1               0      1
01.03.93               0                0              0               0      0
04.03.93               0                1              0               0     -1
05.03.93               0                0              0               0     -1
11.03.93               0                0              0               1     -1
12.03.93               0                0              0               0      0

