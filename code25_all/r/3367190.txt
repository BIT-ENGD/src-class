dat <- data.frame(company, fundname, assetclass, return, assets)

aggregate(dat, list(dat$assetclass), weighted.mean, w=(dat$return, dat$assets))

