sapply
sapply(unique(sort(d$Date, decreasing=TRUE)), WeightedMean, data=d))

WeightedMean <- function(date, data) {...}

WeightedMean
sapply(unique(d[order(d$Date, d$Id, decreasing=TRUE), c("Date", "Id")]), 
    WeightedMean, data=d)

WeightedMean <- function(date, id, data) {...}

WeightedMean
