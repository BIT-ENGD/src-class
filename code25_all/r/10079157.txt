f <- function(x,l) {
lm.obj <- dynlm(GNP~L(get(as.character(x)),l),
              data=longley)
names(lm.obj$coefficients)[2] <- paste(x,l,sep=".")
return(lm.obj)
}

mlply
expand.grid
longley
datasets
data(longley)
require(plyr)
vars <- expand.grid(x=names(longley)[-c(1:3)],l=1:3)

regressionList <- mlply(vars,f, .progress= "text")
summaries <- lapply(regressionList,summary)

require(nlme)

f.gls <- function(x,l) {
gls.obj <- gls(GNP~lag(get(as.character(x)),-l),
              data=longley)
names(gls.obj$coefficients)[2] <- paste(x,l,sep=".")
return(gls.obj)
}

Error in eval(expr, envir, enclos) : object 'x' not found
debug()
mlply
