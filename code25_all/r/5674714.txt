#standard Hodrick Prescott Filter
hpfilter <- function(x,lambda=1600){
eye <- diag(length(x))
result <- solve(eye+lambda*crossprod(diff(eye,lag=1,d=2)),x)

### this is what I am talking about :) 
### intuitively iÂ´d maybe add something like this 
result <- ts(result,start=start(x),end=end(x),frequency=frequency(x))
###

return(result)
}

