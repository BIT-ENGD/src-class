image()
image()
mat.for.map[i,j] <-  exp ( yax[i] * yest 
                            + xax[j] * xest 
                             + zax * zest
                              + cat1 
                               + cat2 )

xax <- seq ( xlow , xup , length.out = xlen )
yax <- seq(ylow,yup,length.out = ylen)
hazards <- c( 0.1302 , 0.0154 , -0.0030 , 0.5971 , 0.3773
           , 0.1300 , 0.0159 , -0.0017 , 1.1522 , 0.3390
           , 0.1037 , 0.0133, 0.0121 , 1.2249 , 0.3647
            , 0.1480 , 0.0045 , 0.0034 , 1.5109 , 0.7472)

rowname1 <- c( "age" , "sbp" , "TotCho" , "DM" , "smk" )
colname2 <- c( "Stoke" , "CHD")
colname1 <- c( "men" , "women" )

array.hazards <- array(hazards, c(5,2,2))
dimnames(hazards)<- list(rowname1,colname1,colname2) 

chart.make <- function(xest ,yest,
             zest, xup,xlow,xlen
            ,yup,ylow,ylen
            ,zup=NULL,zlow=NULL,zlen=NULL,
            xlab=NULL,ylab=NULL,
            cat1=0,cat2=0) {

  xax <- seq(xlow,xup,length.out = xlen)
  yax <- seq(ylow,yup,length.out = ylen)
  zax <- z

  mat.for.map <- matrix(c(rep(0,length(xax)*length(yax))),
                          ncol=length(yax))
  for(j in 1:length(xax)) {
    for(i in 1:length(yax))
      mat.for.map[i,j] <- exp(xax[j]*xest+yax[i]*yest+zax*zest+cat1+cat2)
  }

  list.chart <- list(xax,yax,mat.for.map)
  names(list.chart) <- c("x","y","z")
  return (image(list.chart,col=rainbow(100),xlab=xlab,ylab=ylab,useRaster = TRUE))
}

hazards <- c( 0.1302 , 0.0154 , -0.0030 , 0.5971 , 0.3773
           , 0.1300 , 0.0159 , -0.0017 , 1.1522 , 0.3390
           , 0.1037 , 0.0133, 0.0121 , 1.2249 , 0.3647
            , 0.1480 , 0.0045 , 0.0034 , 1.5109 , 0.7472)

rowname1 <- c( "age" , "sbp" , "TotCho" , "DM" , "smk" )
colname2 <- c( "Stoke" , "CHD")
colname1 <- c( "men" , "women" )

array.hazards <- array(hazards, c(5,2,2))
dimnames(array.hazards)<- list(rowname1,colname1,colname2) 

pdf("chart1.pdf")
z1 <- chart.make(
   array.hazards["sbp","women","CHD"],array.hazards["TotCho","women","CHD"]
      ,zest=array.hazards["age","women","CHD"]
      ,240,90,30
      ,279,160,6,zup=75,
      ,ylab="Total Cholesterol",xlab="Sistlic Blood Pressure"
      ,cat1=array.hazards["smk","women","CHD"])

mtext(text="CHD in women 70<age<80,smoker,DM",side=3,cex=1)
dev.off()

pdf("chart2.pdf")
z1 <- chart.make(
   array.hazards["sbp","women","CHD"],array.hazards["TotCho","women","CHD"]
      ,zest=array.hazards["age","women","CHD"]
      ,240,90,30
      ,279,160,6,zup=75,
      ,ylab="Total Cholesterol",xlab="Sistlic Blood Pressure"
      ,cat1=array.hazards["smk","women","CHD"]
      ,cat2=array.hazards["DM","women","CHD"])
mtext(text="CHD in women 70<age<80,smoker",side=3,cex=1)
dev.off()

 x <- seq(1:200,by=2)
 z <- 20


 mat1 <- matrix(x,ncol=10)
 mat2 <- matrix(x:z,ncol=10)
 mat3 <- matrix(x+z,ncol=10)

image.1 <- image(mat1,col=rainbow(100))
image.2 <- image(mat2,col=rainbow(100))
image.3 <- image(mat3,col=rainbow(100))

