transition <- function(x,y,X,Y)
x_grid
y_grid
      X1Y1 X2Y1 X3Y1 X1Y2 .... X3Y3 
x1,y1
x2,y1
x3,y1
x1,y2
x2,y2
x3,y2
...
x3,y3

for
x_grid <- 1:3
y_grid <- 1:3

## dummy function
transition <- function(x,y,X,Y)
    x == X && y == Y

nx <- length(x_grid)
ny <- length(y_grid)
T <- matrix(NA, ncol = nx * ny, nrow = nx * ny)
for(i in 1:nx)
  for(j in 1:ny)
    for(k in 1:nx)
      for(l in 1:ny)
        T[i+(j-1)*ny, k+(l-1)*ny] <- 
          transition(x_grid[i], y_grid[j], x_grid[k], y_grid[l])

sapply(x_grid, function(x) 
  sapply(y_grid, function(y) 
   sapply(x_grid, function(X) 
     sapply(y_grid, function(Y) 
       transition(x,y,X,Y) )))) 

