require(quantmod)
getSymbols("SPY",from='01-01-1900')
Data <- Cl(SPY)

Lag
periodHigh <- function(x,n) {
    Lags <- Lag(x,1:n)
    High <- x == apply(Lags,1,max)
    x[High]
}
periodHigh(Data, 200)

Data
