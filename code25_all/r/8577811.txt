nicedendro<-function(inputdat, outputfile){
    library(ggdendro)
    library(ggplot2)
    x <- read.table(inputdat,  head=TRUE)
    y <- 1-x
    d <- as.dist(y,diag=FALSE,upper=FALSE)
    hc <- hclust(d,"ave")
    dhc <- as.dendrogram(hc)
    ddata <- dendro_data(dhc,type="rectangle")
    ddata$labels$text <- gsub("\\."," ",ddata$labels$text)
    pdf(outputfile, width=30,height=35)

    plot(ggplot(segment(ddata)) + 
       geom_segment(aes(x=x0,y=y0,xend=x1,yend=y1)) + 
       xlab(NULL) + 
       ylab(NULL) + 
       scale_x_discrete(limits=ddata$labels$text) + 
       opts(panel.grid.major = theme_blank()) + 
       opts(panel.grid.minor=theme_blank()) + 
       coord_flip())


    dev.off()
}

