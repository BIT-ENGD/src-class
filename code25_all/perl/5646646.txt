perl.exe -i.bak -pe "s/(\[Pagebar Button Skin\].+?Margin Top\s+?=\s+?)(1)/$1 0/g" test.txt

[Pagebar Button Skin]
Type                        = BoxStretch
Tile Center                 = pagebar/top/inactive.png
StretchBorder               = 12
Margin Top                  = 1
Margin Right                = -5
Margin Left                 = -5
Margin Bottom               = 0
Padding Left                = 12
Padding Top                 = 5
Padding Right               = 9
Padding Bottom              = 6
Spacing                     = 3
Text Color                  = #111111

perl.exe skin.pl skin.ini

$/ = undef; # Setting $/ to undef causes <FILE> to read the whole file into a single string.

# Store filename from argument
my $filename = shift;

# Open the file as read only and then store the file text into a string.
open(FILE, "<", $filename) || die "Could not open $filename\n";
my $text = <FILE>;
close(FILE);

# Re-open the file as writable and then overwrite it with the replaced text.
open(FILE, "+>", $filename) || die "Could not open $filename\n";
$text =~ s/(\[Pagebar\s+?Button\s+?Skin\].+?Margin\s+?Top\s+?=\s+?)(1)/${1}0/sg;
#print $text; # Print the text to screen
print {FILE} $text; # Print the text to the file
close(FILE);

