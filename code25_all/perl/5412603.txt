#!/usr/bin/env perl  
use strict;  
use POSIX::strptime;  
use Text::CSV;  

sub get_time  
{  
    my($str) = @_;
    my ($sec, $min, $hour) = (POSIX::strptime($str, '%I:%M:%S')) [3,4,5];
    print "$hour\n";
    return($hour*60 + $min)
}

open my $fh, "<", datafile.txt
my $csv = Text::CSV->new() or die "Failed to create Text::CSV object";
my $line = <$fh>;

die "Failed to parse line <<$line>>\n\n" unless $csv->parse($line);
my @columns = $csv->fields();

while ($line = <$fh>)
{
   chomp $line;
   die "Failed to parse line <<$line>>\n\n" unless $csv->parse($line);
   my @columns = $csv->fields();
   die "Insufficient columns in <<$line>>\n" if scalar(@columns) < 1;
   my $minute = get_time($columns[1]);
   print "$minute\n";
}

