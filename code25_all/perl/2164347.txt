use strict;
#use warnings;
use CGI qw(:standard);
use CGI::Carp qw(fatalsToBrowser);
use HTTP::Request::Common qw(POST);
use HTTP::Request::Common;
use LWP::UserAgent;
use URI::Escape; 
use Data::Dumper;

my $url = param('url');

sub writeXML($) {
    my $response = shift @_;
    if ($response->is_success) {
        print CGI->header('text/xml');
        print $response->content;
        print STDERR "content response:#" . $response->content . "#\n";
    }
    else {
        print STDERR "Status Code: " . $response->status_line . "\n"; 
        print STDERR Dumper ($response);
    }
}

sub makeRequest(){
    if ($url){
        my $ua = LWP::UserAgent->new;
        my $response = $ua->request(GET $url);
        if ($response){
            writeXML($response);
        }
        else{
            print STDERR "No response exists";
        }
    }
    else{
        print STDERR "URL must be specified";
    }
}

makeRequest();

0;

__END__

