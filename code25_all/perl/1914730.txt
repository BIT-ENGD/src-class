package JustTesting;
use strict;
use warnings;

sub new {
    my $self = {};
    bless($self, shift);
    END { $self->goodbye() };
    return $self;
}

sub goodbye {
    print "Goodbye.\n";
}

package main;
my $this = JustTesting->new();

no
warnings
my $cleanup = sub { $self->goodbye() };
END { $cleanup->() };

END { sub { $self->goodbye() }->() };

