my $comments = $a_post->comments;

package Model::Schema::Post;



use MongoDBx::Class::Moose;

use namespace::autoclean;



with 'MongoDBx::Class::Document';



has 'title' => (is => 'rw', isa => 'Str', required => 1,);

belongs_to 'author' => (is => 'ro', isa => 'Author', required => 1);

has 'post_date' => (is => 'ro', isa => 'DateTime', traits => ['Parsed'], required => 1);

has 'text' => (is => 'rw', isa => 'Str', required => 1);

joins_many 'comments' => (is => 'ro', isa => 'Comment', coll => 'comments', ref => 'post');

holds_many 'tags' => (is => 'rw', isa => 'Tag', predicate => 'has_tag');



__PACKAGE__->meta->make_immutable;


package Model::Schema::Comment;



use MongoDBx::Class::Moose;

use namespace::autoclean;



with 'MongoDBx::Class::Document';



belongs_to 'post' => (is => 'ro', isa => 'Post', required => 1);

has 'author' => (is => 'ro', isa => 'Author', required => 1);

has 'comment_date' => (is => 'ro', isa => 'DateTime', traits => ['Parsed'], required => 1);

has 'text' => (is => 'rw', isa => 'Str', required => 1);

has 'rateing' => (is => 'rw', isa => 'Int');



__PACKAGE__->meta->make_immutable;

