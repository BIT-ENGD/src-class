# my code as follows
use strict;
use FileHandle;

my @LISTS       = ('incoming');
my $WORK        ="c:\";
my $OUT         ="c:\";

foreach my $list (@LISTS) {
    my $INFILE      = $WORK."test.dat";
    my $OUTFILE     = $OUT."TEST.dat";

    while (<$input>) {
        chomp;
        my($f1,$f2,$f3,$f4,$f5,$f6,$f7) = split(/\|/);
        push @sum, $f4,$f7;
    }

}
while (@sum) {
    my ($key,$value)=  {shift@sum, shift@sum};
    $hash{$key}=0;
    $hash{$key} += $value;
}
while my $key (@sum) {
    print $output2 sprintf("$key1\n");
    # print $output2 sprintf("$key ===> $hash{$key}\n");
}
close($input);
close($output);

unique Id ===> Total Revenue ($f4==>$f7)

