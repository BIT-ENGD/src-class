#!/usr/bin/perl

use strict;
use XML::LibXML ;

my $cfg->{namespace} = {
    foo=>"urn:bar.org/version-1",
    far=>"urn:gle.org/version-1",
};

my $parser = XML::LibXML->new({recover => '1'});

my $doc = $parser->parse_string($inputHash->{$key}->{xml});

my $xc = XML::LibXML::XPathContext->new( $doc->documentElement() );

for my $ns (keys %{$cfg->{namespace}})
{
    $xc->registerNs($ns => $cfg->{namespace}->{$ns});
}

<?xml version="1.0"?>
<foo:Parent xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:foo="bar:a.org/version-2">
    <far:Child xmlns:gle="gle:a.org/version-2">
    {horrific structure with more ns declarations all of which need registering}
    </far:Child>
</foo:Parent>

