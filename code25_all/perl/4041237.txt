"#!/usr/local/bin/perl"

#!/local/perl5/bin/perl5.003

use Socket;

$sockaddr = 'S n a4 x8';

$host = $ARGV[0];
$them = $host;
$port = 79;
print "Finger $host: \n";
$hostname = ``;
`nslookup $host |grep Name:  >> $test`;
print $test;
#($name, $aliases, $proto) = getprotobyname('tcp');

($name, $aliases, $port) = getservbyname($port, 'tcp') unless $port =~ /^\d+$/;
($name, $aliases, $type, $len, $thisaddr) = gethostbyname($hostname);
$n1 = $name;
($name, $aliases, $type, $len, $thataddr) = gethostbyname($them);

$this = pack($sockaddr, &AF_INET, 0, $thisaddr);
$that = pack($sockaddr, &AF_INET, $port, $thataddr);

socket(S, &PF_INET, &SOCK_STREAM, $proto) || die "socket: $!";

bind(S, $this) || die "bind: $!";
connect(S, $that);

select(S); $| = 1; select(stdout);

print S "\n\n";

while (<S>) {print $_;};

