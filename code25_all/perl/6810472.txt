#!/usr/bin/perl
use warnings;
use strict;
use open qw{:utf8 :std};
use XML::Simple;

my @cmdline = ("hg", "log", "-v", "--style", "xml");
open my $xml, "@cmdline |";

my $xmllog = XMLin($xml, ForceArray => ['logentry', 'parent', 'copy', 'path']);

foreach my $rev (@{$xmllog->{logentry}}) {
    #do stuff
}

*** glibc detected *** /usr/bin/perl: malloc(): memory corruption: 0x0a40e308 ***

#open my $xml, "@cmdline |";
my $xml = `@cmdline`;

print "$_\n" for sort grep /XML/, keys %INC;
RPC/XML.pm
RPC/XML/Client.pm
RPC/XML/ParserFactory.pm
XML/NamespaceSupport.pm
XML/Parser.pm
XML/Parser/Expat.pm
XML/SAX.pm
XML/SAX/Base.pm
XML/SAX/Exception.pm
XML/SAX/Expat.pm
XML/SAX/ParserFactory.pm
XML/Simple.pm

XML/NamespaceSupport.pm
XML/Parser.pm
XML/Parser/Expat.pm
XML/SAX.pm
XML/SAX/Base.pm
XML/SAX/Exception.pm
XML/SAX/Expat.pm
XML/SAX/ParserFactory.pm
XML/Simple.pm

libxml-libxml-perl
$XML::SAX::ParserPackage = "XML::LibXML::SAX";
*** stack smashing detected ***: /usr/bin/perl terminated

open
libxml-libxml-simple-perl
print "$_\n" for sort grep /XML/, keys %INC;
$XML::SAX::ParserPackage = "XML::SAX::Expat"
open
open
