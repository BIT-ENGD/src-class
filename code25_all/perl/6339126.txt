use warnings;
use strict;
use threads;
use threads::shared;

my @allThreads;
share (my %array);

foreach ('alpha', 'beta', 'gamma')
{
    $name = $_;
    push @allThreads, threads->new(\&doWork, $name);
}

foreach my $thread (@allThreads){ $thread->join; } # Wait for all threads to join.

sub doWork
{
    $tempName = shift;
    my @results = `/bin/ls /home/*`;
    doMoreWork($tempName, @results);
}

sub doMoreWork
{
    my $myName = shift;
    my @tempResults = @_;
    foreach (0 .. $#tempResults)
    {
        if($tempResults[$_] =~ /(\w+)/)
        {
            my $x = $1;
            $array{$x} = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
        }
    }
}

foreach (keys %array)
{
    print "$array{$_}->[3]\n";
}

