my $csv_dbh = DBI->connect("DBI:CSV:f_dir=\.;csv_eol=\n");
$csv_dbh->{f_dir} = $ElementConfig->{_DIR} if defined($ElementConfig->{_DIR});
$csv_dbh->{csv_sep_char} = "$Seperator" if (defined($Seperator));
$csv_dbh->{csv_eol} = $csv_eol if (defined($csv_eol));
$csv_dbh->{csv_allow_whitespace} = $csv_allow_whitespace if (defined($csv_allow_whitespace));
my $CSV_Select;
unless (defined($ref_FullSQLSt)) { 
    // Standard "SELECT * FROM filname.txt"
    $CSV_Select = "SELECT ".${$ref_CSVSelect}." FROM $File ".${$ref_CSVWhere};
} else {
    $CSV_Select = ${$ref_FullSQLSt};
}
my $sth = $csv_dbh->prepare($CSV_Select);
my $res = $sth->execute();
while (my $row = $sth->fetchrow_hashref()) {
    my $PKeys = $index;
    if (defined($ElementConfig->{_FILES}->{$File}->{_dkey})) {
        my $NewPKeys = "";
        for my $key (split (/\s*\,\s*/,$ElementConfig->{_FILES}->{$File}->{_dkey})) {
            if (defined($row->{$key})) {
                $NewPKeys .= $row->{$key};
            }
        }
        $PKeys = $NewPKeys if ($NewPKeys);
    }

    unless (defined($DataHash->{$DBConfig->{TBLPREFIX} . $ElementConfig->{_FILES}->{$File}->{_dtbl}}->{$PKeys})) {
        $DataHash->{$DBConfig->{TBLPREFIX} . $ElementConfig->{_FILES}->{$File}->{_dtbl}}->{$PKeys} = $row;
        $index ++;
    }
}

CELL    DATE    avgRxLevUl  avgRxLevDl  RXQUALUL0 
RTAL3D  08.12.2009 15:50    -96.25072834    -92.32065149    179594

$var-> {
   'cell' => 'RTAL3D',
   'date' => '08.12.2009',
   'avgrxlevu1' => -96.25072834
   ...
}

