package mia;
use Moose;
use MooseX::Storage;

with Storage(format => 'JSON', io => 'File');

has 'nome'  => ( is     => 'rw', isa    => 'Str', default =>'',);
has 'stato' => ( is     => 'rw', isa    => 'Int', default =>1,);

sub BUILD{ 
my $self=shift;
    if ($self->stato==1){
      $self=mia->load("mia.dat");
    }
    if ($self->stato==2){
    $self->stato(0);
    $self->nome("prova");
    $self->store("mia.dat");    
 } 
sub stampa(){
my $self=shift;
print $self->nome." ".$self->stato;
}

use mia;
my $m;

$m1=mia->new(stato=>2); 
$m2=mia->new();
print "\nm1 \n";
$m1->stampa();
print "\nm2 \n";
$m2->stampa();

