 01-034575 18/12/2007  258,750.00 11,559.00  36       -2     0     6    -3     2    -2     0     2     1    -1     3     0     5    15
                                                      -13   -44   -74  -104  -134  -165  -196  -226  -257  -287  -318  -349  -377  -408  -438
                                                      -469  -510  -541  -572  -602  -633  -663
      Atraso Promedio --->        0.94

#Create an output file
open(OUT, ">out.csv");
print OUT "Loan_ID,Atraso_promedio,Atraso_alt,N_payments,\n";

open(MYINPUTFILE, "<DATA.txt");
while(<MYINPUTFILE>){

    chomp($_);

    if($ID_select != 1 && m/(\d{2}\-\d{6})/){$Loan_ID = $1, $ID_select = 1} 

    if($ID_select == 1 && m/\d{1,2},\d{1,3}\.00\s+\d{1,2},\d{1,3}\.00\s+(\d{1,2})/)  {$N_payments = $1, $Payment_find = 1};

    if($Payment_find == 1 && $ID_select == 1){

            while(m/\s{2,}(\-?\d{1,3})/g){
                $N++; 
                $SUM = $SUM + $1;
                print OUT "$Loan_ID,$1\n"; #THIS SHOWS ME WHAT NUMBERS THE CODE IS GRABBING. ACTUAL OUTPUT WILL BE WRITTEN BELOW
                print $Loan_ID,"\n";
            }


        if(m/---> *(\d*.\d*)/){$Atraso = $1, $Atraso_select = 1}
        if($ID_select == 1 && $Payment_find == 1 && $Atraso_select == 1){
                ...

