$(function() {
        var xhr = $.ajax({
                url: '/nph-handleRequest.cgi'
                ,type: 'get'
        });

        collectPartial(xhr,'');
});

var collectPartial = function (xhr,lastContent) {
        alert(xhr.readyState);
        if (xhr.readyState == 3 && lastContent != xhr.responseText) {
                lastContent = xhr.responseText;
                alert(xhr.responseText);
        }
        if (xhr.readyState < 4) {
                setTimeout(function() {collectPartial(xhr,lastContent)}, 1000);
        }
}

#!/usr/bin/perl
$|=1;
print "$ENV{SERVER_PROTOCOL} 206 Partial Content\n";
print "Server: $ENV{SERVER_SOFTWARE}\n";
print "Content-type: text/plain\n\n";
for ($count = 1; $count < 5; $count++) {
        print time();
        print "\n";
        sleep(2);
}

#!/usr/bin/perl
$|=1;
use CGI::Push qw(:standard);

do_push(-next_page=>\&display_time,-delay=>2);

sub display_time {
        my($q,$counter) = @_;
        return undef if $counter > 5;
        return time()," "x256, "\n";
}

