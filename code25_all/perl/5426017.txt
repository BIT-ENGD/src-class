my $datafile = "data.txt";
open my $fh, "<", $datafile or die "Failed to open $datafile ($!)";

my $csv = Text::CSV->new() or die "Failed to create Text::CSV object";
my $line = <$fh>;

while ($line = <$fh>)
{ 
    blah blah
    blah blah

    if ($foo > $cow) {
        blah
    } elsif ($foo == $cow) { 
        blah
    } else {
        for ($i =1; $i <= $something; $i++) {
            blah blah
        }
    }
}

