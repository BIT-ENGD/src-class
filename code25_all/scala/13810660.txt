val vfp = new Application(new ActiveXComponent("VisualFoxPro.Application").getProperty("Application").toDispatch())
vfp.setVisible(false)

try {
  vfp.doCmd("do my.exe with myconfig.txt")
} catch {
  case t: Throwable => t.printStackTrace
} finally {
  vfp.doCmd("close data")
  vfp.doCmd("clear all")
  vfp.doCmd("clear")
  vfp.quit
  vfp.safeRelease
}

