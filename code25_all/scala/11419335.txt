class SyncConnection {
  def connect(): String = {
    // Establish connection    
    ...    
    val out = new PrintStream(outputStream)
    val in = new BufferedSource(inputStream).getLines()

    // Make login request, receive token
    out.println("loginRequest")
    out.flush()

    val token = in.next()

    token
  }
}

class AsyncConnection {
  def connect(token: String) {
    // Establish connection    
    ...    
    val in = new BufferedSource(inputStream).getLines()
    val out = new PrintStream(outputStream)

    // Authenticate using token
    out.println(token)
    out.flush()

    // Print all messages received on input stream
    for (line <- in) println(line)    
  }
}

