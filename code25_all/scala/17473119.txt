def ws = WebSocket.async[String] {
    val (out, channel) = {
        Concurrent.broadcast[String]
    }
    channel push "message"
    request =>
        (in, out)
}

ws
channel push "message"
ws
channel push "message"
Future{}
Thread.sleep()
