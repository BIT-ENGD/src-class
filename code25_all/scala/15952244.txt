val foo = List(1, List(2, List(3, 4)), List(5, List(6, List(7, List(8,9,10)))))

map(case 4 => 42 case x => x)

List(1, List(2, List(3, 42)), List(5, List(6, List(7,List(8,9,10)))))

def copyListReplace(tree: List[Any], p: Any => Any): List[Any] = {
  tree.map(x =>
    x match {
      case y: List[Any] => copyList(y.tail, p)
      case t => p(t)
    }
  )
}

scala>println(copyListReplace(foo, (x => x match{ case 4 => 42 case _ => t})))    
List(1, List(List(42)), List(List(7)))

