package it.vigtig.thesis.collection.scalacheck

import java.io.OutputStream
import java.io.PrintStream

import org.scalacheck.Prop.forAll
import org.scalacheck.Properties

import it.vigtig.thesis.env.DistEnv.globalRank
import it.vigtig.thesis.env.DistEnv.parallelize

object CollectionCheck {

  def main(args: Array[String]) {

    parallelize(args) {

      if (globalRank > 0) {
        Console.setOut(new PrintStream(new OutputStream() {
          def write(b: Int) { //nop    
          }
        }))
      }

      ST.main(Array())
    }

  }

}

object ST extends Properties("String") {

  //  def println(a: String*) = gprintln(a)
  property("startsWith") = forAll((a: String, b: String) => (a + b).startsWith(a))

  property("concatenate") = forAll((a: String, b: String) =>
    (a + b).length > a.length && (a + b).length > b.length)

  property("substring") = forAll((a: String, b: String, c: String) =>
    (a + b + c).substring(a.length, a.length + b.length) == b)

}

MPJ Express (0.38) is started in the multicore configuration
rank-0: 0.212437745 time taken for initialize
+ String.startsWith: OK, passed 100 tests.
! String.concatenate: Falsified after 0 passed tests.
> ARG_0: 
> ARG_1: 
+ String.substring: OK, passed 100 tests.

