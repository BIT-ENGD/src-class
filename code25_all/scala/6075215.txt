import scala.tools.nsc.interpreter._
import scala.tools.nsc.Settings
import java.util.concurrent.TimeUnit

object DslTest {
    val settings = new Settings()
    settings.usejavacp.value = true

    var interpreter = new IMain(settings);

    def main(args : Array[String]) {
        val t = System.currentTimeMillis
        do {
            test()
        } while (System.currentTimeMillis - t < TimeUnit.SECONDS.toMillis(3000))
    }

    def test() {
        interpreter.interpret("""
            def sort(a:Array[Int]): Array[Int] =
                if (a.length < 2) a
                else {
                    val pivot = a(a.length / 2)
                    sort (a filter (pivot>)) ++
                         (a filter (pivot == )) ++
                    sort (a filter(pivot <))
            }""");
        interpreter.reset
    }
}

