val reply = line.replaceAll("""([\.!?])\s+([a-z])""","""$1"""+" "+"""$2""".toUpperCase)

.toUpperCase
val pattern = """(?:(.+)?([\.!?])\s+([a-z])(.+)?)+""".r

     val reply = line match {
      case pattern(a,b,c,d) => a+b+" "+c.toUpperCase+d
      case _ => line
    }

