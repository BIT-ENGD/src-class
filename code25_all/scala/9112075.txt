val userId = S.param("userId") map { _.toInt }

RestContinuation.async {
  reply => {
    reply(
      for {
        user <- userRepo.select(userId) ?~ "No such user." ~> 404
      } yield {
         <user>
           <name>{user.name}</name>
         </user>
      }
    )
  }
}

