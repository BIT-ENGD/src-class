Stream.from(1).map(f).takeWhile((_>0)).foldLeft(0L)(_+_)

.par
val BATCH=1024
Stream.from(1,BATCH).flatMap(
  i=>(i until i+BATCH).par.map(f)
).takeWhile((_>0)).foldLeft(0L)(_+_)

BATCH
