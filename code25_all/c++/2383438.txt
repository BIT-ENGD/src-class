extern "C" {
    __declspec(dllexport) const char* GetValue(const char* s) {
        return s;
    }
}

#include "stdafx.h"
#include <stdio.h>
#include <tchar.h>
#include <windows.h>

typedef const char* (*GetValueFunc)(const char* s);

int _tmain(int argc, _TCHAR* argv[]) {
    wprintf(L"Hello from unmanaged code\n");
    HMODULE hDll = LoadLibrary(L"Test.dll");
    if (!hDll)
        return GetLastError();

    wprintf(L"library found and loaded\n");

    GetValueFunc getValue = (GetValueFunc)GetProcAddress(hDll, "GetValue");
    if(!getValue)
        return GetLastError();
    wprintf(L"%s\n", getValue("asdf"));

    return 0;
}

