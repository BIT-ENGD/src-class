/// strdup-test.cpp
///
#include <iostream>
#include <string>

int main(int argc, char **argv) {   
  std::string s1("foo");

  char *c1=strdup(s1.c_str());
  std::cerr << c1 << std::endl;

  // segfault?
  free(c1); 

  return 0;
}

gcc -c malloc.c
g++ strdup-test.cpp -o strdup-test malloc.o

$ ./strdup-test 
foo
Segmentation fault

