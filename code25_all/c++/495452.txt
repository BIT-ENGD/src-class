// Initialize
HDWP hDWP = BeginDeferWindowPos( ... )

for( ... )
{  
   // Calculate new rectangle
   CRect dcNew;
   ...
   // Oh,now I want to return from my function, I want to cancel everything

   // Accumulate
   hDWP = DeferWindowPos( hDWP, hWnd, 0, 
                rcNew.left, 
                rcNew.top, 
                rcNew.Width(), 
                rcNew.Height(),
                SWP_NOZORDER );
}

// Finally
BOOL bResult = EndDeferWindowPos( hDWP );

