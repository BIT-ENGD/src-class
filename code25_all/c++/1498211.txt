#define SECURITY_DOMAIN "http:www.mysite.com"


    STDMETHOD (GetSecurityId)(      
        LPCWSTR pwszUrl,
        BYTE *pbSecurityId,
        DWORD *pcbSecurityId,
        DWORD_PTR dwReserved)
    {
        if (*pcbSecurityId >=512)
        {
            memset(pbSecurityId,0,*pcbSecurityId);
            strcpy((char*)pbSecurityId,SECURITY_DOMAIN);
            pbSecurityId[strlen(SECURITY_DOMAIN)] = 3;
            pbSecurityId[strlen(SECURITY_DOMAIN)+1] = 0;
            pbSecurityId[strlen(SECURITY_DOMAIN)+2] = 0;
            pbSecurityId[strlen(SECURITY_DOMAIN)+3] = 0;

            *pcbSecurityId = (DWORD)strlen(SECURITY_DOMAIN)+4;
            return S_OK;


        }
        return INET_E_DEFAULT_ACTION;
    }

STDMETHOD(ProcessUrlAction)(
        /* [in] */ LPCWSTR pwszUrl,
        /* [in] */ DWORD dwAction,
        /* [size_is][out] */ BYTE __RPC_FAR *pPolicy,
        /* [in] */ DWORD cbPolicy,
        /* [in] */ BYTE __RPC_FAR *pContext,
        /* [in] */ DWORD cbContext,
        /* [in] */ DWORD dwFlags,
        /* [in] */ DWORD dwReserved)
    {

        DWORD dwPolicy=URLPOLICY_ALLOW;
        if ( cbPolicy >= sizeof (DWORD))
        {
            *(DWORD*) pPolicy = dwPolicy;
            return S_OK;
        } 

        return INET_E_DEFAULT_ACTION;
    }

