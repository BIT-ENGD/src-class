WTS_SESSION_LOCK
WTS_SESSION_UNLOCK
    void RegisterSession(HWND hwnd) 
    {
        typedef DWORD (WINAPI *tWTSRegisterSessionNotification)( HWND,DWORD );

        tWTSRegisterSessionNotification pWTSRegisterSessionNotification=0;
        HINSTANCE handle = ::LoadLibrary("wtsapi32.dll");
        pWTSRegisterSessionNotification = (tWTSRegisterSessionNotification) :: GetProcAddress(handle,"WTSRegisterSessionNotification");
        if (pWTSRegisterSessionNotification)
        {
            pWTSRegisterSessionNotification(hwnd,NOTIFY_FOR_THIS_SESSION);
        }
        ::FreeLibrary(handle);
        handle = NULL;
     }

