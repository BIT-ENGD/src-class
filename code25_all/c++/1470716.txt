global
UserAborted
function AbortIfUserRequested
    global UserAborted

    if (UserAborted == 1)
        error('User Abort');
    end
end

function UserAbortLongFunction
    global UserAborted

    UserAborted = 1;
end

AbortIfUserRequested
UserAbortLongFunction
UserAbortLongFunction
AbortIfUserRequested
UserAborted
