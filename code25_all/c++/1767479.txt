WriteFile( hCommandPipe, &msg, sizeof(msg), &dwTemp, NULL );

WriteFile
 BOOL ExecuteRemoteCommand()
 {
 DWORD dwTemp = 0;
 xCmdMessage msg;
 xCmdResponse response;

 ::ZeroMemory( &msg, sizeof(msg) );
 ::ZeroMemory( &response, sizeof(response) );

 FillMessage( &msg );

 // Send message to service
 WriteFile( hCommandPipe, &msg, sizeof(msg), &dwTemp, NULL );

 // Connects to remote pipes (stdout, stdin, stderr)
 if ( ConnectToRemotePipes( 5, 1000 ) )
 {
   StdOutput( _T("Ok\n\n") );

    // Waiting for response from service
    ReadFile( hCommandPipe, &response, sizeof(response), &dwTemp, NULL );
 }
 else
    StdOutput( _T("Failed\n\n") );

 if ( response.dwErrorCode == 0 ) 
    _tprintf( _T("\nRemote command returned %d(0x%X)\n"), 
              response.dwReturnCode, 
              response.dwReturnCode );
 else
    _tprintf( _T("\nRemote command failed to start. Returned error code is %d(0x%X)\n"), 
              response.dwErrorCode, 
              response.dwErrorCode );

 return TRUE;
}

