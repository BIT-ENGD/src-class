typedef std::ctype CT;  
CT const& ct = std::_USE(std::locale(), CT);  
ct.widen(&str[0], &*str.begin()+str.size(), &ret[0]);

