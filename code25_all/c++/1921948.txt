    public override void Write(byte[] buffer, int offset, int count)
    {
        EnsureBufferSize(count);
        Marshal.Copy(buffer, offset, hGlobalBuffer, count);
        lockBytes.WriteAt(writeOffset, hGlobalBuffer, count, out temp);
        writeOffset += temp.ToUInt32();
    }

