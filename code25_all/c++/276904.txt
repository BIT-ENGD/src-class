const HICON hIcon = myImageList.ExtractIcon( nImage );    
Bitmap* gdiBMP = Bitmap::FromHICON( hIcon );    
CLSID   encoderClsid;    
GetEncoderClsid( T2W( "image/gif" ), &encoderClsid );    
Status stat = gdiBMP->Save( L"myfilename.gif", &encoderClsid, NULL );    
delete gdiBMP;

