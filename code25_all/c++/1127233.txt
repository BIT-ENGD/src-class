hHook = SetWindowsHookEx(WH_SHELL, (HOOKPROC)CreateWindowHook, hinst, 0);

LRESULT CALLBACK CreateWindowHook(int code, WPARAM wParam, LPARAM lParam) {
    if (code == HSHELL_WINDOWCREATED) {
        // snip 
    }
    return CallNextHookEx(0, code, wParam, lParam); 
}

MINIMIZEDMETRICS st;
st.cbSize = sizeof(MINIMIZEDMETRICS);
st.iArrange = ARW_HIDE;
BOOL ret;

ret = SystemParametersInfo(
  SPI_SETMINIMIZEDMETRICS,
  sizeof(MINIMIZEDMETRICS),
  &st,
  0);

