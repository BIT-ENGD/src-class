SHFILEINFO info;    //For getting information about the file
if (::SHGetFileInfo(ucPath.GrabTString(), 0,&info, sizeof(info), SHGFI_ICON | SHGFI_SMALLICON | SHGFI_SHELLICONSIZE) != NULL) 
{
//Control view of the 
  if (iconView != NULL){
        HDC hDC = GetDC(NULL);  //Get the screen DC
    DrawIconEx(hDC, 300, 200, info.hIcon, 0, 0, 0, NULL, DI_NORMAL);  //Draw icon on 300, 200 location
    ReleaseDC(NULL, hDC);
    //following line is not working
    iconView->SetRsrcID((unsigned long) info.hIcon);
  }
  ::DestroyIcon(info.hIcon);
}

