    TIME_ZONE_INFORMATION   tzi;

    SYSTEMTIME              stStartUTC;

    SYSTEMTIME              stStart;

    LPCSTR                  lpszZone;

    BOOL                    bStatus;

    FILETIME*                pFT;

    DWORD  dReturn;

    pFT = new FILETIME;

if (pFT)

{

    pFT->dwHighDateTime = 4294967295ul;
    pFT->dwLowDateTime = 4294962295ul;

    if (pFT)
    {
        FileTimeToSystemTime (pFT, &stStartUTC);
    }
    else
    {
        GetSystemTime (&stStartUTC);
    }


    dReturn = GetTimeZoneInformation (&tzi);

    bStatus = SystemTimeToTzSpecificLocalTime (&tzi, &stStartUTC, &stStart);

}

