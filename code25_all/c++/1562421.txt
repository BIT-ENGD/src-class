HANDLE
void *
windows.h
shared_ptr
std::tr1::shared_ptr<void> myHandle (INVALID_HANDLE_VALUE, CloseHandle);

CreateToolhelp32Snapshot
HANDLE
const std::tr1::shared_ptr<void> h
    (CreateToolhelp32Snapshot(TH32CS_SNAPPROCESS, NULL), CloseHandle);

void
h
OpenProcessToken
PHANDLE
OpenProcessToken(GetCurrentProcess(), TOKEN_ADJUST_PRIVILEGES | TOKEN_QUERY,
    (PHANDLE)&h);

Process32First
HANDLE
Process32First(*((PHANDLE)&h), &pEntry);

HANDLE
if (*((PHANDLE)&h) == INVALID_HANDLE) { /* do something */ }

