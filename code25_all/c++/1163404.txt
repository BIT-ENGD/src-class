Test::IDiscover *pICalc = NULL;
HRESULT hRes=CoCreateInstance(Test::CLSID_SqlClass, NULL, 
  CLSCTX_INPROC_SERVER,Test::IID_IDiscover, reinterpret_cast<void**> (&pICalc)); 
if(hres<0) 
   cout<<"register failure"<<endl;
else
   cout<<"register success"<<endl;  // and i am not free the memory any where...

IDiscoverPtr pt(__uuid(SqlClass));
HRESULT hRes=CoCreateInstance(Test::CLSID_SqlClass, NULL, 
  CLSCTX_INPROC_SERVER,Test::IID_IDiscover, reinterpret_cast<void**> (&pICalc));
if(hres<0)
   cout<<"register failure"<<endl;
else
   cout<<"register success"<<endl;

IDiscoverPtr pt__uuid(SqlClass));

