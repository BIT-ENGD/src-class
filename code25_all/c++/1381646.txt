// Thread 1
struct foo {
    int (*DoSomething)(void ** parm);
};

HMODULE fooHandle = LoadLibrary("pathToFoo");
typedef int (*loadUpFooFP)(foo ** fooPtrPtr);
loadUpFooFP loadUpFoo;
loadUpFoo = (loadUpFooFP)GetProcAddress(fooHandle, "fooLoader");
foo * myFoo;
loadUpFoo(&myFoo);

myFoo->DoSomething(&parmPtr);

// Thread 2
foo * myFooInThread2;
loadUpFoo(&myFooInThread2);

// Thread 2
myFooInThread2->DoSomething(&anotherParmPtr);

myFooInThread2->DoSomething(&anotherParmPtr);

