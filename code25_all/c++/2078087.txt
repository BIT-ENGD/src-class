common.h
inline void wait_what()
{
  struct wtf
  {
    void ffffuuu() {}

  } local;
}

foo.cpp
#include "common.h"

void foo()
{
  wait_what();
}

bar.cpp
#include "common.h"

void bar()
{
  wait_what();
}

// forward declarations
void foo();
void bar();

int main()
{
  foo();
  bar();

  return 0;
}

error LNK2005: "public void __thiscall `void__cdecl wait_what(void)'::`2'::wtf::ffffuuu(void)" (?ffffuuu@wtf?1??wait_what@@YAXXZ@QAEXXZ) already defined in bar.obj

