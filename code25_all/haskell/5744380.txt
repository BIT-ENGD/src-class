import Control.Monad.Reader
import Control.Monad.State
import Control.Monad.Error
import qualified Data.Set as S

....
freshen s = do
        names <- get
        let s' = head [ns|suf<-suffixes
              ,let ns = s ++ show suf
              ,not (ns `S.elementOf` names)]
        suffixes = [1..]
        put (S.insert s' names)
        return s'

