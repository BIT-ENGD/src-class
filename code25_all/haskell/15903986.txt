Network.Curl
export http_proxy=myhost:post
export https_proxy=myhost:port

curl https://www.google.co.uk

ghci> import Network.Curl
ghci> curlGetString "http://www.google.co.uk" []

ghci> curlGetString "https://www.google.co.uk" []
(CurlHttpReturnedError,"")

Network.Curl
