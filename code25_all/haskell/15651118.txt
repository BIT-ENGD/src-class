where
snst
size
instance Array Tree where
    new n x  
        | n <= 0    = Leaf
        | odd n     = Node n nst x nst
        | even n    = Node n (Node (n `div` 2) snst x snst) x snst
        where nst = (new (n `div` 2) x)
              snst = (new (n `div` 2 - 1) x)

    size Leaf            = 0
    size (Node s _ _ _)  = s

