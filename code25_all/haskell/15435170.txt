repeatAccept s p = do
  c <- accept s
  t <- forkFinally (echoHandler c) (exitPool p)
  atomically $ do
    p' <- readTVar p
    writeTVar p ((t,c):p')
  repeatAccept s p

