let f = replicate 3

takeWhile (< 3) $ concatMap f [1..]

[1,1,1,2,2,2]
let f' x = Just $ replicate 3 x

fmap concat $ mapM f' [1..5]

Just [1,1,1,2,2,2,3,3,3,4,4,4,5,5,5]
takeWhile
fmap (takeWhile (< 3) . concat) $ mapM f' [1..5]

fmap (takeWhile (< 3) . concat) $ mapM f' [1..]

takeWhile
