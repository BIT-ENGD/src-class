import Graphics.X11.Xlib
import Graphics.X11.Xlib.Extras
import Control.Concurrent (threadDelay)
import Data.Bits    

main :: IO ()
main = do
 dpy <- openDisplay ""
 let dflt = defaultScreen dpy
     border = blackPixel dpy dflt
     background = whitePixel dpy dflt
 rootw <- rootWindow dpy dflt
 win <- createSimpleWindow dpy rootw 0 0 300 200 1 border background
 setTextProperty dpy win "Hello World" wM_NAME
 mapWindow dpy win
 moveWindow dpy win 0 0
 selectInput dpy win (structureNotifyMask .|. exposureMask)
 updateWin dpy win

updateWin :: Display -> Window -> IO ()
updateWin dpy win = do
  sync dpy True
  allocaXEvent $ \e -> do
    nextEvent dpy e
    ev <- getEvent e
    putStrLn $ eventName ev
  threadDelay (1000000)
  updateWin dpy win

ConfigureNotify
XIO:  fatal IO error 11 (Resource temporarily unavailable) on X server ":0.0"
      after 26 requests (25 known processed) with 5 events remaining.

