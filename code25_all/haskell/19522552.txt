module NewParse where

import qualified Text.ParserCombinators.Parsec as A
import Control.Monad.Trans (lift)
import Control.Monad.Writer (WriterT, tell,  runWriterT)
type WParser a = WriterT [String] A.Parser a 

data StoryToken = StoryToken Char deriving (Show)

getToken :: WParser StoryToken
getToken = do
  tell ["hello from Writer T"]
  c <- lift A.anyChar 
  return $ StoryToken c 

test = A.parse (runWriterT getToken) "story" "#"

*NewParse> test
Right (StoryToken '#',["hello"])

anyChar = lift A.anyChar

