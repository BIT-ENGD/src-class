isInteger i = not (null i) && all isDigit i

getInteger :: String -> IO Int
getInteger q = do
    putStr q;
    i <- getLine
    if isInteger i == False then do
            putStrLn "Bad number"
            getInt q
        else return (read i)

getDateTime :: String -> IO CalendarTime
getDateTime question = do
    putStr question;
    year <- getInteger "Year: "
    month <- getInteger "Month: "
    day <- getInteger "Day: "
    hour <- getInteger "Hour: "
    minute <- getInteger "Minute: "
    return CalendarTime(year month day hour minute 0)

