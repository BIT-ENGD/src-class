ms = [2,1,1,1]  

cs = [3,1,1]

sum ms == sum cs 

  [12,5,7], [12,7,5], [20,3,7], [20,7,3]
, [28,3,5], [28,5,3], [30,3,7], [30,7,3]
, [42,2,5], [42,5,2], [70,2,3], [70,3,2], [105,2,2].

nbOfLists :: (Integral a,Integral b) => [a] -> [a] -> b  

nbOfLists [u] _     = 1
nbOfLists (u:us) vs = 
    let clean = map (filter (/=0))
        corpus = filter (all (>=0)) $ map (zipWith (-) vs) $ base u (length vs)
        base k 1 = [[k]]
        base k l = concat [map (i :) $ base (k-i) (l-1) | i <- [0..k]]
    in sum $ map (nbOfLists us) $ clean corpus

  [4,2,3,5], [4,2,5,3],  [4,3,2,5],  [4,3,5,2]
, [4,5,2,3], [4,5,3,2],  [6,2,2,5],  [6,2,5,2]
, [6,5,2,2], [10,2,2,3], [10,2,3,2], [10,3,2,2], [15,2,2,2]

