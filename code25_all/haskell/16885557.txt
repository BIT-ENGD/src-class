defaultLayout
{-# LANGUAGE FlexibleInstances
           , MultiParamTypeClasses
           , OverloadedStrings
           , QuasiQuotes
           , TemplateHaskell
           , TypeFamilies #-}

module Main where

import Text.Hamlet (ihamlet)
import Yesod
import Yesod.Static

staticFiles "static"

data PlayTutorial = PlayTutorial
  { getStatic :: Static
  }

mkMessage "PlayTutorial" "messages" "en"

mkYesod "PlayTutorial" [parseRoutes|
  / RootR GET
  /static StaticR Static getStatic
|]

instance Yesod PlayTutorial where
  defaultLayout contents = do
    PageContent title headTags bodyTags <- widgetToPageContent $ do
      addStylesheet $ StaticR stylesheets_bootstrap_css
      addStylesheet $ StaticR stylesheets_main_css
      contents

    ihamletToRepHtml [ihamlet|
      $doctype 5

      <html>
        <head>
          <title>#{title}
          ^{headTags}
        <body>
          <div ."screenshot">
            <div ."navbar navbar-fixed-top">
              <div ."container">
                <a ."brand" href=@{RootR}>
                  _{MsgApplicationName}
            <div ."container">
              ^{bodyTags}
    |]

getRootR :: Handler RepHtml
getRootR = defaultLayout [whamlet|Hello, World!|]

main :: IO ()
main = do
  static@(Static settings) <- static "static"
  warp 8080 $ PlayTutorial static

runhaskell
src/Main.hs:34:31:
    Couldn't match type `Text.Blaze.Internal.MarkupM ()'
                  with `[(Data.Text.Internal.Text, Data.Text.Internal.Text)]
                        -> Data.Text.Internal.Text'
    Expected type: Text.Hamlet.Render (Route PlayTutorial)
      Actual type: Text.Hamlet.Translate (Route PlayTutorial)
    In the first argument of `headTags', namely `_mrender_a7j2'
    In a stmt of a 'do' block: headTags _mrender_a7j2 _urender_a7j1
    In the expression:
      do { id
             ((Text.Blaze.Internal.preEscapedText . Data.Text.pack)
                "<!DOCTYPE html>\
                \<html><head><title>");
           id (toHtml title);
           id
             ((Text.Blaze.Internal.preEscapedText . Data.Text.pack) "</title>");
           headTags _mrender_a7j2 _urender_a7j1;
           .... }

ihamlet
headTags
HtmlUrl
HtmlUrlI18n
defaultLayout
whamlet
PageContent
widgetToPageContent
RepHtml
ihamlet
defaultLayout
