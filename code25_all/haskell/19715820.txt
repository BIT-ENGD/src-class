data Rectangle = Rectangle Int Int Int Int
Rectangle
main = do
    initGUI
    -- . . . 
    widget <- drawingAreaNew
    canvasArea <- newIORef $ Rectangle 0 0 defaultWidth defaultHeight
    widget `onExpose` updateCanvas widget (liftIO (readIORef canvasArea) >>= render)
    onSizeAllocate widget $ updateSize canvasArea
    -- . . .

updateSize :: IORef a -> a -> IO ()
updateSize old new = writeIORef old new

