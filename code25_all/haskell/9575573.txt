import Network.Socket hiding (send, sendTo, recv, recvFrom)
import Network.Socket.ByteString


waitAck s duetime' = do
      print ("in")
      (a, _) <- recvFrom s 4711
      now' <- getPOSIXTime
      unless (B.unpack a == "ack") (when (now' < duetime') (waitAck s duetime'))
      print (B.unpack a)
      return ()

