foo n = maximumBy (comparing p) [1..n]
p :: Int -> Int
p n < n
n > 0
p x
x
n
1
x
foo n = go (0, 0) n where
    go (c, _) 1 = c
    go (c, c') !x = if c' >= x then c else go (c2, c'2) (x-1) where
        x' = p x
        (c2, c'2) = if c' >= x' then (c, c') else (x, x')

