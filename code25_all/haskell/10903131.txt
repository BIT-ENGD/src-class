import Graphics.Rendering.OpenGL as GL
import Graphics.UI.GLFW as GLFW
import Graphics.Rendering.OpenGL (($=))
import System.Environment (getArgs, getProgName)

import Control.Monad

main = do
  GLFW.initialize
  GLFW.openWindow (GL.Size 400 400) [GLFW.DisplayAlphaBits 8] GLFW.Window
  GLFW.windowTitle $= "openGL Test"

  render <- initialize'
  loop render

  GLFW.closeWindow
  GLFW.terminate


loop render = do
  render
  p <- GLFW.getKey GLFW.ESC
  unless (p == GLFW.Press) $ do
    isOpen <- GLFW.windowIsOpen
    when isOpen $ loop render

initialize' = do
  return $ do
    GL.clear [GL.ColorBuffer]

