-------Data types-------

type FirstName = String
type LastName = String
type CustomerNIC = String
type Database = ( FirstName , LastName , CustomerNIC ) 
--type Details = [Database]

------Data base---------


exampleBase :: [Database]
exampleBase = [ ( "Kevin" , "Desilva" , "8929323V" ),( "Nimal" , "Perera" , "89120323V" ) ]

-------Main Menu-----------------------------
getInt :: IO Int
getInt = do line <- getline 
        return (read line :: Int)

selectsearch ::IO()
selectsearch = do 
                    putStr"\n\n\t 1.Search by NIC:"
                    putStr"\n\n\t 2.Search by First Name:"
                    putStr"\n\n\t Your Chocie:"
                    input<-getInt
                    subsearch input

subsearch :: Int->IO()
subsearch x = do
                if(x=1) then do
                                putStr"\n\t Enter NIC:"
                                cnic <- getLine
                                subsearch
                else if (x=2) then do
                                putStr"\n\t Enter First Name:"
                                cnic <- getLine
                                subsearch
                else if (x=3) then putStr "\n ERROR"
                                selectsearch

            else MainMenu

------- Search ------------

getfName :: Database -> FirstName 
getfName ( fname , lname , cnic ) = fname

searchByFirstName :: Database -> FirstName -> Database
searchByFirstName (a:ax) fname 
                    | fname == getfName a = a 
                    | length ax == 0 && getfName a/= fname = ("No Data","",0)
                    | otherwise = searchByFirstName ax fname  

