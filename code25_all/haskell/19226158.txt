-- // --

main :: IO ()
main = do
   initGUI
   build <- builderNew
   builderAddFromFile build "test.glade"

   mainWindow <- builderGetObject build castToWindow "mainWindow"
   mainWindow `onDestroy` mainQuit

   mQuit <- builderGetObject build castToButton "quit"
   mQuit `onClicked` mainQuit

   entry   <- builderGetObject build castToEntry "entry"
   mUpdate <- builderGetObject build castToButton "update"

   mUpdate `onClicked` do
      txt <- entryGetText entry
      runState (addToList txt) []
      return ()

   widgetShowAll mainWindow
   mainGUI

-- // --

addToList :: String -> State [String] ()
addToList ent = get >>= \x -> put $ x ++ [ent]

