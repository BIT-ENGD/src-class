indentBrackets (c:rest) level
   | c=='('    = "\n" ++ (replicate level ' ') ++ [c]
                      ++ (indentBrackets rest (level+1))
   | c==')'    =  [c] ++ (indentBrackets rest (level-1))
   | c=='['    = "\n" ++ (replicate level ' ') ++ [c] 
                      ++ (indentBrackets rest (level+1))
   | c==']'    =  [c] ++ (indentBrackets rest (level-1))
   | otherwise =  [c] ++ (indentBrackets rest (level  ))

indentBrackets [] _ = ""

otherwise = [c] ++ (indentBrackets rest (level))
otherwise = [c] ++ $ indentBrackets rest (level)
