getStdGen
main
StdGen
Main.hs
{-# LANGUAGE OverloadedStrings, ScopedTypeVariables #-}                                                                                                

module Main where                                                                                                                                      

import Happstack.Lite                                                                                                                                  
import qualified Pages.Contact as Contact                                                                                                                                                                                                                                
import System.Random                                                                                                                                   

main :: IO ()                                                                                                                                          
main = do                                                                                                                                              
    gen <- getStdGen                                                                                                                                   
    serve Nothing $ pages gen                                                                                                                          

pages :: StdGen -> ServerPart Response                                                                                                                 
pages g = msum                                                                                                                                         
    [ dir "contact" $ Contact.page g                                                                                                                   
    ... Other irrelevant pages                                                                                                           
    ]

StdGen
getRandomQID :: StdGen -> Int                                                                                                             
getRandomQID g =                                                                                                                                       
    let (rpercent, _) = random g :: (Float, StdGen)                                                                                                    
        rid           = rpercent * questionsAmount                                                                                                    
    in  round rid                                                                                                                

questionsAmount :: (Num a) => a                                                                                                                        
questionsAmount = (fromIntegral . length) questions

