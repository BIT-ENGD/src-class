merge [] [(pack "text") =: (pack "hey"), (pack "text") =: (pack "there")]

[ text: "hey", text: "there"]

tagsSelector :: Selector -> [String] -> Selector
tagsSelector selector tags = case tags of
    [] -> selector
    t:ts -> tagsSelector (merge selector [(fieldToText Tags) =: t]) ts

testTagsSelector = TestCase (do
    assertEqual "The tags selector for two tags should match..."
        [(fieldToText Tags) =: "city", (fieldToText Tags) =: "urban"]
            (tagsSelector [] ["city", "urban"]))

The tags selector for two tags should match...
expected: [ tags: "city", tags: "urban"]
 but got: [ tags: "city"]

