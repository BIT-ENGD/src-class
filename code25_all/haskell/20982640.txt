data Tree a = Node [Tree a]
            | Leaf a

switch
switch
class Switchable a where
    getIndex :: a -> Int

data SwitchData = forall c. Switchable c => SwitchData c

SwitchData
switch
SwitchData
switch :: SwitchData -> Tree a -> Tree a
switch (SwitchData c) (Node vec) = vec `V.unsafeIndex` getIndex c
switch _ _ = error "switch: performing switch on a Leaf of context tree"

switchOnData :: [SwitchData] -> Tree a -> a
switchOnData (x:xs) tree = switchOnData xs $ switch x tree
switchOnData [] (Leaf c) = c
switchOnData [] (Node _) = error "switchOnData: partial data"

Switchable
Switchable
