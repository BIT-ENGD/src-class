parse error (possibly incorrect indentation or mismatched brackets)

-- | Recursively builds the selector
constructSelector :: String -> Selector -> Maybe [String] -> Maybe [String] -> Selector
constructSelector docType selector inputWords tagsSoFar =
    case docType of
        "tag" -> []
        "todo" -> case inputWords of
                    Nothing -> selector
                    -- when there are no args left to examine, check if we've
                    -- recursively accumulated a list of tags
                    Just ws | ws == [] -> case tagsSoFar of
                                            Nothing -> selector
                                            Just tags -> merge selector [(pack "tags") =: tags]
                            | (head (head ws)) == 'p' && isInteger (tail (head ws)) -> constructSelector docType (merge selector [(pack "priority") =: (read $ (tail (head ws)) :: Int32)]) (remaining ws) tagsSoFar
                            | otherwise (constructSelector docType selector (Just (tail ws)) (Just (head ws):tagsSoFar))

