import Control.Applicative
import Text.Parsec hiding (many, (<|>))
import Text.Parsec.Indent
data Markup = Tag String [Markup] deriving (Show)

run sourceName p source = runIndent sourceName (runParserT (many1 p <* eof) () sourceName source)

parser = withBlock ($) (tag <* spaces) parser
tag = Tag <$> many1 alphaNum

parser = withBlock ($) (tag <* inlineSpace <* newline <* inlineSpace) parser
inlineSpace = skipMany (satisfy isInlineSpace) <?> "inline white space"
isInlineSpace c = c /= '\n' && isSpace c

withBlock
