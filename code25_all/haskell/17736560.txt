StateT
ReaderT
IO
Graphics.UI.Gtk
tryAttack :: Int -> ReaderT Builder (StateT BattleState IO) Bool

GTK
clickedOn
IO ()
onClicked :: ButtonClass b => b -> IO () -> IO (ConnectId b)

clickedOn
tryAttack
IO ()
attackButton builder leftTR i = do
    moveButton <- builderGetObject builder castToButton ("move" ++ show i)
    onClicked moveButton $ do
        ok <- tryAttack i
        if ok
            then hideAndShow builder castToTable "fight" "option"
            else return ()

tryAttack :: Int -> ReaderT Builder (StateT BattleState IO) Bool
tryAttack i = return True

tryAttack
