module Handler.UserProfile where

import Import
import Data.Maybe (fromMaybe)
import Data.Text (pack, unpack)

viewCountName :: Text
viewCountName = "UserProfileViews"

readInt :: String -> Int
readInt = read

plural :: Int -> String -> String -> String
plural 1 x _ = x
plural _ _ y = y

getUserProfileR :: Handler RepHtml
getUserProfileR = do

    viewCount <- lookupSession viewCountName
                >>= return . (1 +) . readInt . unpack . fromMaybe "0"
    setSession viewCountName (pack $ show viewCount)

    maid <- maybeAuth
    --msg <- getMessageRender
    let user = case maid of
                    Nothing -> "(Unknown User ID)" --show MsgHello --
                    Just (Entity _ u) -> userEmail u
    defaultLayout $ do
        setTitleI MsgUserProfile
        $(widgetFile "nhUserProfile")

