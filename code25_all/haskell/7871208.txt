colorFor shape = 
  case material shape of
    ColorMaterial -> material shape
    -- etc.

material
colorFor shape = 
  let m = material shape
  in case m of
    ColorMaterial -> m

colorFor shape = 
  case material shape of
    ColorMaterial r g b -> ColorMaterial r g b

