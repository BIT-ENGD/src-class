testReadFile = runTestTT $ TestLabel "InteractionDomain.readFileContentsToList" (TestList [
    (TestLabel "testing infrastructure: read test file" (TestList [
        TestCase (withTempFileContainingText (\fileHandle ->
            assertEqual "contents as expected" "The dog barks at midnight." (do 
                content <- hGetContents fileHandle
                return content)))]))])

withTempFileContainingText
withTempFileContainingText lambda = 
        bracketOnError 
            (do (path, fileHandle) <- openTempFile "." "input.txt"
                return fileHandle)
            (deleteFile)
            (\fileHandle -> do 
                hPutStr fileHandle "The dog barks at midnight."
                hClose fileHandle --hoping this flushes buffers
                return (lambda fileHandle))

ghc
content
