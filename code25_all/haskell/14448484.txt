-- route name, then a boolean indicating if it's a write request
isAuthorized HomeR True = isMyAuth
isAuthorized BlogR _ = isMyAuth
-- anyone can access other pages
isAuthorized _ _ = return Authorized

isMyAuth = do
  mu <- maybeAuthId
  return $ case mu of
    Nothing -> AuthenticationRequired
    Just "mylog" -> Authorized
    Just _ -> Unauthorized "You must be an mylog"

-- type AuthId App = UserId
type AuthId App = Text

