index is Index {iColl = "note", iKey = [ text: 1], iName = "text_1", iUnique = False, iDropDups = False}

*** Exception: expected "results" in [ ok: 0.0, errmsg: "no text index for: db.note"]

createIndex
         let order = [(fieldToText TextField) =: (1 :: Int32)]
              docIndex =  index (docTypeToText docType) order
          actionResult <- run pipe dbName $ createIndex docIndex
          case actionResult of
            Left failure -> do putStrLn $ show failure
                               return []
            Right () -> do
              putStrLn $ "index is " ++ show docIndex
              run pipe dbName $ ensureIndex docIndex
              mDoc <- run pipe dbName $ runCommand
                [pack "text" =: (docTypeToText docType),
                  pack "search" =: (pack $ unwords keywords),
                    pack "filter" =: (selector $ selection query)]
              case mDoc of
                Left failure -> do putStrLn $ show failure
                                   return []
                Right doc -> let Array results = valueAt (pack "results") doc
                                 ds = [d | Doc d <- results]
                             in return ds

