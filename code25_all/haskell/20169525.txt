data Modular = Mod Integer Integer deriving Show
instance (Eq Modular) where
  (Mod a1 m1) == (Mod a2 m2) = m1==m2 && mod (a1-a2) m1 == 0


-- Adds two modular numbers of the same modulus
madd :: Modular -> Modular -> Modular
madd (Mod a1 m1) (Mod a2 m2) | m1 == m2 = Mod (mod (a1+a2) m1) m1

Warning: Pattern match(es) are non-exhaustive
         In an equation for `madd':
             Patterns not matched: (Mod _ _) (Mod _ _)

