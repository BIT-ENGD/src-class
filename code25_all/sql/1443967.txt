(
  SELECT
    A.QRYNAME0 "Query Name",
    A.OPRID,
    A.DESCR,
    A.QRYTYPE,
    TO_CHAR(A.CREATEDTTM,'DD-MON-YYYY HH24:MI:SS') "Created On",
    TO_CHAR(A.LASTUPDDTTM,'DD-MON-YYYY HH24:MI:SS') "Last Updated On",
    B.EXECCOUNT "No of Times Executed",
    B.AVGEXECTIME,
    TO_CHAR(B.LASTEXECDTTM,'DD-MON-YYYY HH24:MI:SS') "Last Executed On"
    --TO_CHAR(SUBSTR(A.DESCRLONG,1,50))"Long Description"
  FROM
    PSQRYDEFN A,
    PSQRYSTATS B
  WHERE
    A.QRYNAME = B.QRYNAME and
    a.oprid = b.oprid
)
UNION
(
  SELECT
    A.QRYNAME "Query Name",
    A.OPRID,
    A.DESCR,
    A.QRYTYPE,
    TO_CHAR(A.CREATEDTTM,'DD-MON-YYYY HH24:MI:SS') "Created On",
    TO_CHAR(A.LASTUPDDTTM,'DD-MON-YYYY HH24:MI:SS') "Last Updated On",
    0 "No of Times Executed",
    0,
    NULL "Last Executed On"
    --TO_CHAR(SUBSTR(A.DESCRLONG,1,50)) "Long Description"
  FROM
    PSQRYDEFN A
  WHERE 
    NOT EXISTS (
      SELECT 1 
      FROM   PSQRYSTATS B
      WHERE  a.qryname = b.qryname and a.oprid = b.oprid
    )
)

