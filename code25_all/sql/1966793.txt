CREATE TABLE dbo.Students(
 Id int NOT NULL,
 Name varchar(15) NOT NULL,
 CONSTRAINT PK_Students PRIMARY KEY CLUSTERED 
(

CREATE TABLE [dbo].[Results](
 Id int NOT NULL,
 Subject varchar(15) NOT NULL,
 Mark int NOT NULL
) 

ALTER TABLE [dbo].[Results]  WITH CHECK ADD  CONSTRAINT [FK_Results_Students] FOREIGN KEY([Id])
REFERENCES [dbo].[Students] ([Id])

SELECT   name , coalesce(avg(r.[mark]),0) as Avmark
FROM  students s
 LEFT JOIN results r ON s.[id]=r.[id]
GROUP BY s.[name]
ORDER BY ISNULL(AVG(r.[mark]),0) DESC;

