select a,count(distinct b),sum(a) from 
(select 1 a,1 b union all
select 2,2 union all
select 2,null union all
select 3,3 union all
select 3,null union all
select 3,null) a
group by a

select t1.a, t1.countdistinctb, t2.suma from
(
    select a,count(distinct b) countdistinctb from 
    (
        select 1 a,1 b union all
        select 2,2 union all
        select 2,null union all
        select 3,3 union all
        select 3,null union all
        select 3,null
    ) a
    where a.b is not null
    group by a
) t1
left join
(
    select a,sum(a) suma from 
    (
        select 1 a,1 b union all
        select 2,2 union all
        select 2,null union all
        select 3,3 union all
        select 3,null union all
        select 3,null
    ) a
    group by a
) t2 on t1.a=t2.a

