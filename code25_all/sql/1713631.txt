module SqlHunter
  class ActiveRecord::ConnectionAdapters::AbstractAdapter
      @@queries = [] # without this line it work perfectly
      @@logging = false
      cattr_accessor :queries, :logging
      def log_info_with_trace(sql, name, runtime) 
        @@queries << sql if @@logging 
      end
      alias_method_chain :log_info, :trace
  end
end

ActiveRecord::ConnectionAdapters::AbstractAdapter::logging = true

sqlfile = File.open("public/advancedStats/#{@dir_name}/advancedStatQuery.sql", 'w')
@queries = ActiveRecord::ConnectionAdapters::AbstractAdapter::queries
for query in @queries do
   sqlfile.write("#{query} \n")
end
sqlfile.close

