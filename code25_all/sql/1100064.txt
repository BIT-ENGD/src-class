ClientSalesId                 int identity (1, 1) (PK)
ClientId                      int (FK)
TermId                        int (FK)
StudentType1Population        int
StudentType1Adjustment        int
StudentType1Sales             int
StudentType1SalesAdjustment   int
StudentType2Population        int
StudentType2Adjustment        int
StudentType2Sales             int
StudentType2SalesAdjustment   int
StudentType3Population        int
StudentType3Adjustment        int
StudentType3Sales             int
StudentType3SalesAdjustment   int
StudentType4Population        int
StudentType4Adjustment        int
StudentType4Sales             int
StudentType4SalesAdjustment   int
StudentType5Population        int
StudentType5Adjustment        int
StudentType5Sales             int
StudentType5SalesAdjustment   int


SELECT
       'StudentType1'              as DemographicType
       StudentType1Population      as Population,
       StudentType1Adjustment      as PopulationAdjustment,
       StudentType1Sales           as Sales,
       StudentType1SalesAdjustment as SalesAdjustment,
FROM ClientSales
WHERE 1=1
       AND ClientId = 1
       AND TermId = 1

UNION

SELECT
       'StudentType2'              as DemographicType
       StudentType2Population      as Population,
       StudentType2Adjustment      as PopulationAdjustment,
       StudentType2Sales           as Sales,
       StudentType2SalesAdjustment as SalesAdjustment,
FROM ClientSales
WHERE 1=1
       AND ClientId = 1
       AND TermId = 1

-- yada yada yada for the rest of the types...........


SELECT
       ClientId,
       Population
FROM
(
       SELECT
              ClientId,
              StudentType1Population,
              StudentType2Population,
              StudentType3Population,
              StudentType4Population,
              StudentType5Population
       FROM ClientSales
) PVTPopulation
UNPIVOT
(
       Population for StudentType IN
       (
              StudentType1Population,
              StudentType2Population,
              StudentType3Population,
              StudentType4Population,
              StudentType5Population
       )
) as UnPvtPopulation

INNER JOIN

(
       SELECT
              ClientId,
              StudentType1PopulationAdjustment,
              StudentType2PopulationAdjustment,
              StudentType3PopulationAdjustment,
              StudentType4PopulationAdjustment,
              StudentType5PopulationAdjustment
       FROM ClientSales
) PVTPopulation
UNPIVOT
(
       PopulationAdjustment for StudentType IN
       (
              StudentType1PopulationAdjustment,
              StudentType2PopulationAdjustment,
              StudentType3PopulationAdjustment,
              StudentType4PopulationAdjustment,
              StudentType5PopulationAdjustment
       )
) as UnPvtPopulationAdjustment

       ON UnPvtPopulationAdjustment.ClientSalesId = UnPvtPopulation.ClientSalesId
       AND REPLACE (UnPvtPopulationAdjustment.StudentType, 'PopulationAdjustment', '') = REPLACE (UnPvtPopulation.StudentType, 'Population', '')

INNER JOIN

(
       SELECT
              ClientId,
              StudentType1Sales,
              StudentType2Sales,
              StudentType3Sales,
              StudentType4Sales,
              StudentType5Sales
       FROM ClientSales
) PVTSales
UNPIVOT
(
       Sales for StudentType IN
       (
              StudentType1Sales,
              StudentType2Sales,
              StudentType3Sales,
              StudentType4Sales,
              StudentType5Sales
       )
) as UnPvtSales

       ON UnPvtSales.ClientSalesId = UnPvtPopulation.ClientSalesId
       AND REPLACE (UnPvtSales.StudentType, 'Sales', '') = REPLACE (UnPvtPopulation.StudentType, 'Population', '')

