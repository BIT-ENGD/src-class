Select comment.text, (COUNT(parent.id)-1) AS depth 
                                      FROM comments AS comment, 
                                           comments AS parent
                                      WHERE comment.lft BETWEEN parent.lft AND 
parent.rght LEFT JOIN users as user ON (comment.user_id = user.id)
                                          GROUP BY comment.id ORDER BY comment.lft

