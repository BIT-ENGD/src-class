declare @aDay datetime
set @aDay = convert(datetime, '2009-12-08', 102)

update Members m
set NumGym = (select count(memberid)
    from Subscriptions s
    where s.MemberId = m.Id
    and s.TypeID = "Gym"
    and @aDay between s.StartDate and s.EndDate)

