SELECT x.* FROM (SELECT t.*, 
CASE WHEN @cat != t.category_id THEN @rownum := 1 ELSE @rownum := @rownum + 1 END AS rank, 
@cat := t.category_id 
FROM feed_entries t 
JOIN (SELECT @rownum := NULL, @cat := 0) r 
ORDER BY t.category_id DESC) x 
WHERE x.rank <= 3 AND x.deleted =0 ORDER BY x.category_id, x.date DESC LIMIT 50

