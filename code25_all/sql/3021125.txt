SELECT `User`.`username` , Permalink.perma_link_id, Permalink.locale, 
    Permalink.title, DATEDIFF( CURDATE( ) , Permalink.created ) AS dtdiff,
    `TargetSegment`.segment_text, TargetSegment.source_segment_id, 
    TargetSegment.perma_link_id ,TargetSegment.created ,
    TargetSegment.updated,  DATEDIFF( CURDATE( ) , 
    TargetSegment.updated ) AS datediff
FROM `users` AS `User` 
RIGHT JOIN perma_links AS `PermaLink` 
    ON ( `PermaLink`.`username` = `User`.`username` ) 
RIGHT JOIN target_segments AS `TargetSegment` 
    ON ( `TargetSegment`.`username` = `User`.`username` ) 
RIGHT JOIN source_segments AS `SourceSegment` 
    ON ( `SourceSegment`.`source_detail_id` = `PermaLink`.`source_detail_id` ) 
LEFT JOIN source_details AS `SourceDetail` 
    ON ( `SourceSegment`.`source_detail_id` = `SourceDetail`.`id` ) 
WHERE `TargetSegment`.`username` = "xxxx"
AND `TargetSegment`.`segment_text` <> ""
AND `Permalink`.`perma_link_id` = `TargetSegment`.`perma_link_id` 
AND `TargetSegment`.`source_segment_id` = `SourceSegment`.`id` 
AND `Permalink`.`source_detail_id` = `SourceDetail`.`id` 
ORDER BY `TargetSegment`.`updated` DESC 
LIMIT 0 , 10 

