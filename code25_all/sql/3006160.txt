SELECT @TotalUsed = COUNT(*)
FROM ProductInfo WITH (NOLOCK)
WHERE ProductInfoId IN 
(
    SELECT ProductInfoId FROM ProductOrderInfo WITH (NOLOCK)
);

