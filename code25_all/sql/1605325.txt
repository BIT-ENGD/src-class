create table mytable (
    id integer,
    mydate datetime,
    myvalue integer )

id date_actual value_actual date_previous value_previous

date_previous is the maximum of all the dates preceeding date_actual 
for each id and values correspond with the two dates 
{max(date_previous) < date_actual ?}

