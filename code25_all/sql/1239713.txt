SELECT track.historyID
      FROM RS_HistoryTracker track 
     WHERE (track.action = 'STATUS:INITIAL:DRAFT'
            OR track.action = 'STATUS:DELETED:DRAFT'
            OR track.action = 'STATUS:DRAFT:DRAFT')
       AND track.trackDateTime <= @endOfWeek

    SELECT COUNT(DISTINCT his.historyID) AS theCount
  FROM RS_History his
 WHERE his.historyID IN 
       (SELECT track.historyID
          FROM RS_HistoryTracker track 
         WHERE (track.action = 'STATUS:INITIAL:DRAFT'
                OR track.action = 'STATUS:DELETED:DRAFT'
                OR track.action = 'STATUS:DRAFT:DRAFT')
           AND track.trackDateTime <= @endOfWeek) 

