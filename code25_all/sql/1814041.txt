CREATE TABLE [dbo].[TblNdx](
[ticker] [nvarchar](12) NOT NULL,
[date] [datetime] NULL,
[time] [datetime] NULL,
[open] [float] NULL,
[high] [float] NULL,
[low] [float] NULL,
[close] [float] NULL,
[volume] [float] NULL,
[change] [float] NULL
 ) ON [PRIMARY]

SELECT ticker, date, time, [open], high, low, [close], volume, change
FROM   TblNdx 
WHERE  1=1
AND (ticker = '^IXIC') 
AND (date =
        (
            SELECT TOP (1) date as date1
            FROM TblNdx AS TblNdx_1
            WHERE (ticker = '^IXIC')
            ORDER BY date DESC
        )
    )
ORDER BY time DESC

SELECT ticker
    , date
    , time
    , [open]
    , high
    , low
    , [close]
    , volume
    , change
    , (SELECT TOP (1) time AS time1, [close] AS lastclose
         FROM TblNdx WHERE (DATEDIFF(day, date, date1) = 1) 
         AND (ticker = '^IXIC') ORDER BY time1 DESC) AS Expr1
    FROM TblNdx AS TblNdx_2
    WHERE (1 = 1) AND (ticker = '^IXIC') 
    AND (date = (SELECT TOP (1) date AS date1
                    FROM TblNdx AS TblNdx_1 
                    WHERE (ticker = '^IXIC')
                    ORDER BY date1 DESC))
    ORDER BY time DESC

