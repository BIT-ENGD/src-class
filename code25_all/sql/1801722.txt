SELECT
    PC_SL_ACNO,        -- DB ITEM
    SLNAME,                -- ACCOUNT NAME:
    SL_TOTAL_AMOUNT  -- TOTAL AMOUNT:
FROM GLAS_PDC_CHEQUES
WHERE PC_COMP_CODE=:parameter.COMP_CODE 
    AND pc_bank_from = :block02.pb_bank_code 
    AND pc_due_date between :block01.date_from 
    AND :block01.date_to 
    AND nvl(pc_discd,'X') IN(‘X’,  'R') 
GROUP BY
    pc_comp_code, pc_sl_ldgr_code, pc_sl_acno
ORDER BY pc_sl_acno

BEGIN
  SELECT COAD_PTY_FULL_NAME INTO :BLOCK03.SLNAME
    FROM GLAS_PTY_ADDRESS,GLAS_SBLGR_MASTERS
   WHERE SLMA_COMP_CODE    = :PARAMETER.COMP_CODE
     AND SLMA_ADDR_ID = COAD_ADDR_ID
     AND SLMA_ADDR_TYPE = COAD_ADDR_TYPE
     AND SLMA_ACNO       = :BLOCK03.PC_SL_ACNO
     AND SLMA_COMP_CODE = COAD_COMP_CODE;
EXCEPTION WHEN OTHERS THEN NULL;
END;

BEGIN
  SELECT SUM(PC_AMOUNT) INTO :SL_TOTAL_AMOUNT
    FROM GLAS_PDC_CHEQUES
   WHERE PC_DUE_DATE BETWEEN :BLOCK01.DATE_FROM AND :BLOCK01.DATE_TO
     AND PC_BANK_FROM = :block02.PB_BANK_CODE
     AND PC_SL_ACNO   = :BLOCK03.PC_SL_ACNO
     AND NVL(PC_DISCD,'X') = 'R'
     AND PC_COMP_CODE = :PARAMETER.COMP_CODE;
EXCEPTION WHEN OTHERS THEN :block03.SL_TOTAL_AMOUNT := 0;
END;

