Dim SqlString As String = "insert into [CollectedEmail] values('{0}','{1}');"

Do Until sourceFile.Peek = -1
        line = sourceFile.ReadLine
        If line.Length > 0 Then

            Dim emailAddress As String = Trim(line.Substring(0, EmailLength))
            Dim zipcode As String = Trim(line.Substring(EmailLength + 2, ZipCodeLength))

            If CVal.validEmail(emailAddress) AndAlso CVal.validZip(zipcode) Then
                SQL.AppendLine(String.Format(SqlString, emailAddress, zipcode))
            ElseIf CVal.validEmail(emailAddress) Then
               SQL.AppendLine(String.Format(SqlString, emailAddress, ""))
            Else
                badAddresses.WriteLine(emailAddress)
            End If
        End If

    Loop
 InsertToDatabase(SQL.ToString)

