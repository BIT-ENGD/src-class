exec sp_executesql N'SELECT [dbo].[vwMapProject].[Id], [dbo].[vwMapProject].[Name]
 FROM [dbo].[vwMapProject]
 INNER JOIN [dbo].[Product_ProductComponent] ON [dbo].[vwMapProject].[ProductId] = [dbo].[Product_ProductComponent].[ProductId]
 INNER JOIN [dbo].[ProductComponent] ON [dbo].[Product_ProductComponent].[ProductComponentId] = [dbo].[ProductComponent].[Id]
 WHERE [dbo].[ProductComponent].[ExternalId] LIKE @ExternalId0
 GROUP BY [dbo].[vwMapProject].[Id], [dbo].[vwMapProject].[Name]
',N'@ExternalId0 nvarchar(8)',@ExternalId0=N'GC767AV%'

exec sp_executesql N'
SELECT *
FROM     (SELECT ROW_NUMBER() OVER ( ORDER BY Id) AS Row, 
 [dbo].[vwMapProject].[Id], [dbo].[vwMapProject].[Name] 
 FROM [dbo].[vwMapProject]
 INNER JOIN [dbo].[Product_ProductComponent] ON [dbo].[vwMapProject].[ProductId] = [dbo].[Product_ProductComponent].[ProductId]
 INNER JOIN [dbo].[ProductComponent] ON [dbo].[Product_ProductComponent].[ProductComponentId] = [dbo].[ProductComponent].[Id]
 GROUP BY [dbo].[vwMapProject].[Id], [dbo].[vwMapProject].[Name]
 WHERE [dbo].[ProductComponent].[ExternalId] LIKE @ExternalId0
) AS PagedResults
WHERE  Row >= 1 AND Row <= 20',N'@ExternalId0 nvarchar(8)',@ExternalId0=N'GC767AV%'

