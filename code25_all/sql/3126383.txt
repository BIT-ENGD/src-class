 SELECT 
    DailyProduction.CustomerId as CustomerId, 
    SUM(Resource.CostPerUnit * DailyProduction.UnitsToStorage + Resource.CostPerUnit * DailyProduction.UnitsToMarket) AS TotalCost
 FROM 
    dbo.hgm_ResourceTypes Resource
 JOIN
    dbo.hgm_ResourceDailyProduction DailyProduction
 ON
    Resource.ResourceId = DailyProduction.ResourceId
 GROUP BY
    DailyProduction.CustomerId

CUSTOMER: 1  RESOURCE: 1   DISCOUNT: 1
CUSTOMER: 1  RESOURCE: 1   DISCOUNT: 3
CUSTOMER: 1  RESOURCE: 2   DISCOUNT: 5

