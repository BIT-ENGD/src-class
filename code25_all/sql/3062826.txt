USE  Subscriber
GO
WITH Parent (ParentId, Id, Name,subscriberID)
AS
(
-- Anchor member definition
    SELECT A.ParentId,A.id, A.name,A.SubscriberId

    FROM Subscriber.Budget.SubscriberCategory AS A   
    WHERE ParentId IS NULL
    UNION ALL
-- Recursive member definition
    SELECT B.ParentId, B.id, B.name,B.SubscriberId

    FROM Subscriber.Budget.SubscriberCategory AS B 

    INNER JOIN Parent AS P


ON B.ParentId = P.Id
)

-- Statement that executes the CTE
SELECT parentId, id, name
FROM Parent
where subscriberID = '1C18093B-5031-42E4-9251-CEF69114365F'

GO

