SELECT FilmName, Rating, DVDPrice, Category
FROM Films AS FM1 INNER JOIN Category AS C1 ON C1.CategoryId = FM1.CategoryId
WHERE FM1.DVDPrice =
     (SELECT MIN(DVDPrice)
      FROM Films AS FM2
      WHERE FM2.DVDPrice IS NOT NULL
             AND FM1.CategoryId = FM2.CategoryId
             AND FM2.Rating =
                            (SELECT MAX(FM3.Rating)
                             FROM Films AS FM3
                             WHERE FM3.DVDPrice IS NOT NULL
                                  AND FM2.CategoryId = FM3.CategoryId
                             )
      )
ORDER BY FM1.CategoryId;

SELECT FilmName, Rating, DVDPrice, Category
FROM Films AS FM1 INNER JOIN Category AS C1 ON C1.CategoryId = FM1.CategoryId
WHERE FM1.DVDPrice =
     (SELECT MIN(DVDPrice)
      FROM Films AS FM2
      WHERE FM2.DVDPrice IS NOT NULL
             AND FM1.CategoryId = FM2.CategoryId
             AND FM1.Rating =
                            (SELECT MAX(FM3.Rating)
                             FROM Films AS FM3
                             WHERE FM3.DVDPrice IS NOT NULL
                                  AND FM2.CategoryId = FM3.CategoryId
                             )
      )
   AND FM1.Rating=(SELECT MAX(FM2.Rating)
                             FROM Films AS FM2
                             WHERE FM2.DVDPrice IS NOT NULL
                                  AND FM2.CategoryId = FM1.CategoryId
                             )
ORDER BY FM1.CategoryId;

SELECT FilmName, Rating, DVDPrice, Category
FROM Films AS FM1 INNER JOIN Category AS C1 ON C1.CategoryId = FM1.CategoryId
WHERE FM1.DVDPrice =
     (SELECT MIN(DVDPrice)
      FROM Films AS FM2
      WHERE FM2.DVDPrice IS NOT NULL
             AND FM1.CategoryId = FM2.CategoryId
             AND FM1.Rating =
                            (SELECT MAX(FM3.Rating)
                             FROM Films AS FM3
                             WHERE FM3.DVDPrice IS NOT NULL
                                  AND FM2.CategoryId = FM3.CategoryId
                             )
      )
ORDER BY FM1.CategoryId;

SELECT * FROM Films INNER JOIN
(SELECT Min(DVDPrice) as DVDPrice, MaxRating, x1.CategoryId, x1.Category FROM
  (SELECT FilmName, DVDPrice, Rating, MaxRating, Category, Films.CategoryId  FROM Films INNER JOIN 
    (SELECT MAX(Rating) as MaxRating, FM1.CategoryId, C1.Category
      FROM Films AS FM1 INNER JOIN Category AS C1 ON C1.CategoryId = FM1.CategoryId
      GROUP BY Category, FM1.CategoryId
    ) x on Films.Rating = x.MaxRating and Films.CategoryId = x.CategoryID
  ) x1 
  WHERE DVDPrice IS NOT NULL 
  GROUP BY CategoryId,Category
) y on Films.Rating = y.MaxRating and Films.CategoryId = y.CategoryId and Films.DVDPrice = y.DVDPrice

SELECT f.FilmName, f.Rating, f.DVDPrice, f.CategoryId
FROM Films f
LEFT OUTER JOIN Films p ON (f.CategoryId = p.CategoryId
   AND p.AvailableOnDvd = 'Y' AND f.AvailableOnDvd = 'Y' AND f.DVDPrice > p.DVDPrice)
LEFT OUTER JOIN Films r ON (f.CategoryId = r.CategoryId
   AND r.AvailableOnDvd = 'Y' AND f.DVDPrice = r.DVDPrice AND f.Rating < r.Rating)
WHERE  p.CategoryId IS NULL AND r.CategoryId IS NULL
ORDER BY f.CategoryId;

