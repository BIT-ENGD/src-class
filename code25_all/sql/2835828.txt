rs.Filter = "datapath='" + dpath + "' and analystname='" + aname + "' and reportname='" + rname + "' and batchstate='" + bstate + "'"
If Not rs.EOF Then
    MsgBox rs.Fields("rowid")
End If

rs.filter
rs.fields("rowid")
