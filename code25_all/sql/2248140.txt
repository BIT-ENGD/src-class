select fac_name, datename(month,b.startdt) as 'month', year(b.startdt) as 'year', count(a.empfk) as '#filled'  
from tbl_tmx_attempt a  
left outer join tbl_tmx_activity b on a.activityfk = b.activity_pk  
left outer join tbl_tmx_actloc c on b.activity_pk = c.activityfk  
left outer join loc d on c.locfk = d.loc_pk  
left outer join fac e on d.loc_facfk = e.fac_pk  
where b.startdt > '12/31/08'    
group by fac_name, year(b.startdt), month(b.startdt), datename(month,b.startdt) 

select fac_name, datename(month,b.startdt) as 'month', year(b.startdt) as 'year', sum(b.maxcapacity) as 'capacity'  
from tbl_tmx_activity b   
left outer join tbl_tmx_actloc c on b.activity_pk = c.activityfk  
left outer join loc d on c.locfk = d.loc_pk  
left outer join fac e on d.loc_facfk = e.fac_pk  
where b.startdt > '12/31/08'  
group by fac_name, year(b.startdt), month(b.startdt), datename(month,b.startdt)  

