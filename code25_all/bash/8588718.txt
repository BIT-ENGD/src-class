#!/bin/bash

export DISPLAY=localhost:2.0

function clean_string () {
    CLEAN=${1//_/};
    CLEAN=${CLEAN// /_};
    CLEAN=${CLEAN//[^a-zA-Z0-9_]/};
}

for line in $(cat /var/www/le_file.txt); do
    clean_string "$line"
    FILENAME=$CLEAN;
    echo "site: $line";
    `/usr/local/bin/khtml2png2 --width 1024 --height 768 --time 10 --disable-java --disable-plugins $line /var/www/$FILENAME.png &`;
done

terminate called after throwing an instance of 'DOM::DOMException' and the script doesn't continu.

try {
    `/usr/local/bin/khtml2png2`
} 
catch() { 
}

