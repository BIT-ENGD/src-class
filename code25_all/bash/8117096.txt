#!/bin/bash

menu=$(echo "Choose operation [1]Hi [2]Backup")

echo "$menu"

while [ $# == 0 ]; do
  read options

  case "$options" in
    1 )  
    echo "HI"  
    echo "$menu"
  ;;

  2 )
    dir="/home/backups"
    bckup="$(date +%d%b%Y_%H%M)"
    mkdir $dir/$bckup
    cat /etc/passwd >> $dir/$bckup/"DB$bckup".txt

    dialog --title "DATABASE" --msgbox " Ready to backup user database. \n
    press <Enter> to start or <Esc> to cancel." 10 50

    # Return status of non-zero indicates cancel
    if [ "$?" != "0" ]
    then
        dialog --title "BACKUP" --msgbox " Backup was canceled at your request." 10 50
    else
        dialog --title "BACKUP" --infobox " Backup in process..." 10 50 ; sleep 1

        tar czf $dir/$bckup.tgz -C $dir/$bckup . >|/tmp/ERRORS$$ 2>&1

      # zero status indicates backup was successful
      if [ "$?" = "0" ]
      then
        dialog --title "BACKUP" --msgbox " Backup completed successfully." 10 50
      else
        dialog --title "BACKUP" --msgbox "Backup failed Press <Enter> to see error log." 10 50
       dialog --title "Error Log" --textbox /tmp/ERRORS$$ 22 72
      fi
    fi
    rm -r -f $dir/$bckup
    rm -f /tmp/ERRORS$$
    clear
    echo "$menu"
  ;;

  *)
    echo "Invalid, Please choose a valid option"
  ;;
esac
done
exit

