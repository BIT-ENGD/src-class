#!/bin/sh

client="E1:FA:41:23:00:AC"
logfile="/var/logs/wificonn.log"
timestamp=$(date +"%Y%d%m %T")
assoclist=$(wl assoclist | grep $client)
loglast=$(tail -n 1 $logfile | grep $client Not Connected)
notconnmsg="$timestamp $client Not Connected"
connmsg="$timestamp $client Connected"

if [ ! -f $logfile ]; then
    touch $logfile
fi

if [ -z $assoclist  ]; then # Client is not connected
  if [ -n $loglast ]; then # Last log is connected show not connected message
    echo $notconnmsg
    echo $notconnmsg >> $logfile
  fi  
else # Client is connected
  if [ -z $loglast ]; then  # Last log is not connected show connected message
    echo $connmsg
    echo $connmsg >> $logfile
  fi  
fi

