#!/bin/bash/
#16-03-2012
#Sander van der Zeeuw s1040176

#Variabele om de ftp aan te kunnen roepen
var='ftp://ftp.ensembl.org/pub/release-66/fasta/'
#Hier word de lijst met beschikbare organisme binnengehaald via de functie curl.
# curl is te installeren via de terminal met het command sudo apt-get install curl
lijst=`curl $var | awk '{print $NF}'`

echo "de keuze 0 selecteert alles"

#hier wordt een directory aangemaakt om de files in weg te schrijven
mkdir -p dnaenpep
cd dnaenpep



#Hier wordt een keuze menu gecreeerd om het juiste organisme te kiezen.
select specie in $lijst
do
    break
done
echo "Uw keuze is:" $specie


#Hier wordt de keuze "0" ingebouwd. Zodat alle genomen gedownload worden.
if [ "$specie" == "" ]
then
    for i in $lijst
    do
        namen=$(curl $var$i/dna/ | awk '{print($NF)}')
        for files in $namen; do curl $var$i/dna/$files -o $files
                    curl $var$i/pep/$files -o $files
        done 
    done
fi

echo "de keuze 0 selecteert alles"

#Wanneer de loop niet uitgevoerd wordt, zal via nog een select statement de gekozen worden #welk DNA je van de ftp wil downloaden. 
lijst2=`curl $var$specie/ | awk '{print $9}'`
echo $lijst2

select dnatype in $lijst2
do
    break
done
echo "uw keuze is:" $dnatype

if [$dnatype == ""]
then
    for i in $dnatype
    do
        wget -O DNAtype "$var$specie/dna/"
        wget -O DNAtype "$var$specie/pep/"
    done
fi

#Hier worden de files die in $dnatype gemaakt worden gedownload.
wget -O DNAtype "$var$specie/$dnatype/"

cat DNAtype | egrep "=" | tr '"' '\n' | sort | grep ^"ftp" |grep gz > Downlist.txt
wget -c -i  Downlist.txt

exit

