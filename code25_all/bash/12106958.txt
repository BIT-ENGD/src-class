   #!/bin/bash

#Nightly RYSNC backup script


RSYNC=`which rsync`
SOURCE="/mnt/sdb1"
TARGET="/mnt/sdc1"
MAIL_ADDR="user@example.com"
OPTS="-vaz --exclude=/sdb1/lost+found --exclude=/sdb1/home/temp --exclude=/sdb1/temp/_tmp"

cat /dev/null > /tmp/rsync-errors.txt

nohup $RSYNC $OPTS $SOURCE $TARGET >> /var/log/rsync-raw-out.txt 2>> /tmp/rsync-errors.txt


if [ -s '/tmp/rsync-errors.txt' ]; then
   mail -s "Errors on $HOSTNAME" < /tmp/rsync-errors.txt $MAIL_ADDR
else
   echo "Successful, no errors reported." | mail -s "Nightly Report for $HOSTNAME" $MAIL_ADDR
fi

