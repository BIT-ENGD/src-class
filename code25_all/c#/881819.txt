using System;

using System.Data.SqlClient;

using Microsoft.Win32;

using Microsoft.SqlServer.Management.Smo;

using Microsoft.SqlServer.Management.Common;

using System.Data;

public interface ICalculator

{

 void Show();

};

namespace ManagedDLL
{
    public class ManagedClass : ICalculator
    {

        public void Show()
        {

            Console.WriteLine("from managed class");
            Console.WriteLine("c# "); Console.WriteLine("c#");
            DataTable dt = new DataTable();
            string srvname,filepath; 

            //evaluates local instances of SQLSERVER
            dt = SmoApplication.EnumAvailableSqlServers(true);
            Console.WriteLine("Local Instances are \n");
            foreach (DataRow dr in dt.Rows)
                Console.WriteLine(dr["Name"]);

            foreach (DataRow dr in dt.Rows)
            {
                srvname = (string)dr["name"];

                Console.WriteLine("\nConnecting to Server " + srvname + "\n\nDiscovering Volumes...\n\nDiscovering Sql2005 Volumes for the Host " + srvname.ToLower() + "\n");
                Console.WriteLine("\nHostName   : " + srvname.ToLower() + "\n");
                Server srv = new Server(srvname);
                Console.WriteLine(" Server Name \n" + srv.Name);
                foreach( Database db in srv.Databases)
                {
                    filepath = db.PrimaryFilePath;
                    Console.WriteLine("File Path : " + filepath + "\\" + db.Name + ".mdf \n");
                    Console.WriteLine("File Path : " + filepath + "\\" + db.Name + ".ldf \n");
                }


            }//foreach


        }
    }

}

