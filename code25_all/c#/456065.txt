public static byte[] GetDocument(string url)
        {
            HttpWebRequest myHttpWebRequest = (HttpWebRequest)WebRequest.Create(url);
            HttpWebResponse myHttpWebResponse = (HttpWebResponse)myHttpWebRequest.GetResponse();
            Stream stream = myHttpWebResponse.GetResponseStream();

            byte[] _Data = StreamToBytes(stream);

            return _Data;
        }

        private static byte[] StreamToBytes(System.IO.Stream theStream)
        {
            if (theStream == null)
                throw new ArgumentException("URL null.");

            int bytesRead = 0;
            byte[] buffer = new byte[8096];
            MemoryStream bufferStream = new MemoryStream();

            try
            {
                do
                {
                    bytesRead = theStream.Read(buffer, 0, 8096);
                    bufferStream.Write(buffer, 0, bytesRead);

                } while (bytesRead > 0);

            }
            finally
            {
                bufferStream.Flush();
                theStream.Close();
                theStream.Dispose();
            }

            return bufferStream.ToArray();
        }

