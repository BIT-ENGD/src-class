private void GenerateDocument_Click(object sender, EventArgs e)
{
    string _nameSpaceURI = "http://schemas.microsoft.com/office/word/2005/10/wordml";
    string docFileName = GetSavePath();

    //-- Step 1 - Creating the document xml
    XmlDocument doc = new XmlDocument();
    XmlElement _wWordDoc = doc.CreateElement("w:wordDocument", _nameSpaceURI);
    doc.AppendChild (_wWordDoc);
    XmlElement _wbody = doc.CreateElement("w:body",_nameSpaceURI);
    _wWordDoc.AppendChild(_wbody);
    // Check if the string contains a line feed
    string[] _SplitStr = mleTextForDocument.Text.Split('\n');
    // if it contains line feed then each entry with a line feed goes to a new paragraph.
    for (int row = 0; row < _SplitStr.Length; row++)
    {
         XmlElement _wp1 = doc.CreateElement("w:p",_nameSpaceURI);
         _wbody.AppendChild(_wp1);
         XmlElement _wr1 = doc.CreateElement("w:r", _nameSpaceURI);
         _wp1.AppendChild(_wr1);
         XmlElement _wt11 = doc.CreateElement("w:t", _nameSpaceURI);
         _wr1.AppendChild(_wt11);
         XmlNode _wt1 = doc.CreateNode(XmlNodeType.Text, "w:t",_nameSpaceURI);
         _wt1.Value = _SplitStr[row];
         _wt11.AppendChild(_wt1);
    }

    //-- Step 2 - Creating the Package
    Package package = null;
    package = Package.Open(docFileName, FileMode.Create, FileAccess.ReadWrite);

    //-- Step 3 - Create the main document part (document.xml)
    Uri uri = new Uri("/word/document.xml", UriKind.Relative);
    PackagePart part = package.CreatePart(uri, "application/vnd.ms-word.main+xml");
    StreamWriter partWrt = new StreamWriter(part.GetStream(FileMode.Create, FileAccess.Write));
    doc.Save(partWrt);
    partWrt.Close();
    package.Flush();

    //-- Step 4 - Create the relationship file
    uri = new Uri("/word/document.xml", UriKind.Relative);
    PackageRelationship rel = package.CreateRelationship(uri, TargetMode.Internal, "http://schemas.microsoft.com/office/2006/relationships/officeDocument", "rId1");
    package.Flush();

    //-- Step 5- Close the document.
    package.Close();
 }

