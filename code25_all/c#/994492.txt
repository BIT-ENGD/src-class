        public static void ExportToSpreadsheet(DataTable table, string name)

    {

        HttpContext context = HttpContext.Current;
        context.Response.Clear();
        foreach (DataColumn column in table.Columns)
        {
            //context.Response.Write(column.ColumnName + ";");
            context.Response.Write(column.ColumnName);
        }
        context.Response.Write(Environment.NewLine);
        foreach (DataRow row in table.Rows)
        {
            for (int i = 0; i < table.Columns.Count; i++)
            {
                //context.Response.Write(row[i].ToString().Replace(";", string.Empty) + ";");
                context.Response.Write(row[i].ToString().Replace(";", string.Empty));
            }
            context.Response.Write(Environment.NewLine);
        }
        context.Response.ContentType = "text/xls";
        context.Response.AppendHeader("Content-Disposition", "attachment; filename=" + name + ".xls");
        context.Response.End();

    } 

