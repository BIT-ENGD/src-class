//namespace
using System;
using System.Collections.Generic;
using System.Drawing;
using System.Windows.Forms;
using System.Diagnostics;   
using System.Runtime.Serialization;
using System.Runtime.InteropServices;
using Visio1 = Microsoft.Office.Interop.Visio;
using Visio2 = VisOcx;

//function
void Qed2_elevation_stencil_tbClick(object sender, EventArgs e)
{
    try
    {
        Visio2.DrawingControl.Src = "C:\\Drawing.vsd";
    }
    catch (Exception ex)
    {
        MessageBox.Show(ex.Message);
    }

    return;
}

// 
// qed2_elevation_stencil_tb
// 
this.qed2_elevation_stencil_tb.ToolTipText = "QED2 Front Elevation";
this.qed2_elevation_stencil_tb.Click += new    
system.EventHandler(this.Qed2_elevation_stencil_tbClick);

using System;
using System.Configuration;
using System.Collections.Generic;
using System.Collections;
using System.Data;
using System.Drawing;
using System.Windows.Forms;
using System.Diagnostics;   
using System.Runtime.Serialization;
using System.Runtime.InteropServices;
using System.IO;


using Visio1 = Microsoft.Office.Interop.Visio;
using Visio2 = VisOcx;
using Visio3 = AxMicrosoft.Office.Interop.VisOcx;

public partial class MainForm : Form
{


    public MainForm()
    {
        //
        // The InitializeComponent() call is required for Windows Forms   designer support.
        //
        InitializeComponent();

        //
        // TODO: Add constructor code after the InitializeComponent() call.
        //
    }

    private Visio1.Application  VisApp = null;
    private Visio1.Page         VisPage = null;     
    private Visio1.Document     VisDocument = null;
    private Visio1.Documents    VisDocuments = null;
    private Visio1.Window       VisWindow = null;
    private Visio1.Document     VisStencil = null;

private void Qed2_elevation_stencil_tbClick(ref Visio1.Documents visDocuments)

    {
        string stencilPath = System.IO.Path.Combine(@"C:\\Documents and Settings\\MGPF50\\My Documents\\Visio Stencils", @"Front Elevation Stencil.vss");

        try
        {
            VisStencil = visDocuments.OpenEx(stencilPath,
                (short)Visio1.VisOpenSaveArgs.visOpenRO
                + (short)Visio1.VisOpenSaveArgs.visOpenHidden
                + (short)Visio1.VisOpenSaveArgs.visOpenMinimized
                + (short)Visio1.VisOpenSaveArgs.visOpenNoWorkspace);
        }
        catch (COMException exp)
        {
            MessageBox.Show("Error Loading Stencil: " + stencilPath + exp.Message);
            throw exp;
        }
    }

