using System;

namespace LibraryWPF
{
    public class Library
    {
        /// <summary>
        /// Event fired when content is added to the libary
        /// </summary>
        public event EventHandler<ObjectInfoEventArgs> Library_ObjectAdded;

        /// <summary>
        /// Event fired when the scan of the library is finished
        /// </summary>
        public event EventHandler Library_Finished;

        // Properties

        /// <summary>
        /// Whether to stop checking the library or not
        /// </summary>
        public bool Stop
        {
            get;
            set;
        }

        /// <summary>
        /// Where to look for content
        /// </summary>
        public string Root
        {
            get;
            set;
        }

        /// <summary>
        /// Empty instance of library's object for reflection
        /// </summary>
        public virtual object ObjectInfo
        {
            get
            {
                // Should this raise as exception to show if it's not been overridden?
                return null;
            }
        }

        /// <summary>
        /// Sub class overrides this method to call it's actual find code
        /// </summary>
        public virtual void Find()
        {
            // Should this raise as exception to show if it's not been overridden?
        }

        /// <summary>
        /// Build the library
        /// </summary>
        public void Build()
        {
            if (Root != null && Root.Length > 0)
            {
                Stop = false;
                Find();
            }

            // Final update
            if (Library_Finished != null)
            {
                Library_Finished(this, null);
            }
        }

        /// <summary>
        /// Sub class calls this method to fire the ObjectAdded event
        /// </summary>
        /// <param name="objectInfo">Object just added to library</param>
        protected void OnObjectAdded(object objectInfo)
        {
            if (Library_ObjectAdded != null)
            {
                Library_ObjectAdded(this, new ObjectInfoEventArgs(objectInfo));
            }
        }
    }
}

ObjectInfo
Find
ObjectInfo
Find
ObjectInfo
null
