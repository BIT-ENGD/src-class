public partial class Form1 : Form
{
    [DllImport("winmm.dll", SetLastError = true)]
    public static extern uint waveOutGetNumDevs();

    public Form1()
    {
        InitializeComponent();
    }

    private void button2_Click(object sender, EventArgs e)
    {
        if (waveOutGetNumDevs() != 0)
        {
            Console.WriteLine("The sound card is detected");
        }
        else
        {
            Console.WriteLine("No sound card");
        }
    }

    private void button1_Click(object sender, EventArgs e)
    {
        ManagementObjectSearcher searcher = 
            new ManagementObjectSearcher("Select ProductName from Win32_SoundDevice");

        foreach (ManagementObject device in searcher.Get())
        {
            Console.WriteLine("Sound card {0}", 
                device.GetPropertyValue("ProductName"));

        }


    }
}

