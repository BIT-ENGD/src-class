            startInfo= new ProcessStartInfo("cmd.exe");
            startInfo.Arguments ="/C uus.exe "+ arg.ToString();
            startInfo.RedirectStandardError = true;
            startInfo.RedirectStandardOutput = true;
            startInfo.UseShellExecute = false;
            startInfo.CreateNoWindow = true;
            this.timer1.Enabled=true;
            this.listBox1.Items.Clear();
            p= Process.Start(startInfo);
                            Application.DoEvents(); 

        void Timer1Tick(object sender, EventArgs e)
    {
        string str="";
        str=p.StandardOutput.ReadLine();
        if(str != null)
        {
            this.Text=str.ToString();
            this.listBox1.Items.Add(str);
        }
        Application.DoEvents();
    }

            proc.StartInfo.UseShellExecute=false;
            proc.StartInfo.CreateNoWindow=true;
            proc.StartInfo.RedirectStandardOutput=true;
            proc.StartInfo.RedirectStandardError=true;
            proc.StartInfo.FileName="uus.exe";
            proc.StartInfo.Arguments=arg;
            proc.OutputDataReceived += new System.Diagnostics.DataReceivedEventHandler(SortOutputHandler);
            proc.Start();
            proc.BeginOutputReadLine();

    void SortOutputHandler(object o,System.Diagnostics.DataReceivedEventArgs e)
    {
        string str="";
        string str2="";
        str=e.Data.ToString();
        if(str!=null && str!="")
        {
            this.listBox1.Items.Add(str.ToString());
            this.Text=str.ToString();
        }
        str2=proc.StandardOutput.ReadLine();
        if(str2!=null && str2!="")
        {
            this.lsw1.Items.Add(str2.ToString());
        }
    }

private delegate void TextAdderDelegate(string str);

void TextAdder(string str)
{
   if(this.lsw1.InvokeRequired==true)
   {
      Invoke(new TextAdderDelegate(TextAdder),new object[] {str});
   }
   else
   {
      this.lsw1.Items.Add(str);
   }
}

void SortOutputHandler(object o,System.Diagnostics.DataReceivedEventArgs e)
{
   string str="";

   if(e!=null)
   {
      if(e.Data!=null)
      {
         str=e.Data.ToString();
      }
   }
   TextAdder(str);
}

