public void Test()
{
    StringBuilder themeFileName = new StringBuilder(0x200);
    GetCurrentThemeName(themeFileName, themeFileName.Capacity, null, 0, null, 0);
    string fileName = Path.GetFileName(VisualStyleInformation.ThemeFilename);
    if (string.Equals("aero.msstyles", fileName, StringComparison.OrdinalIgnoreCase))
    {
        // user is using aero theme
    }
}

[DllImport("uxtheme.dll", CharSet = CharSet.Auto)]
public static extern int GetCurrentThemeName(StringBuilder pszThemeFileName, int   
    dwMaxNameChars, StringBuilder pszColorBuff, int dwMaxColorChars,
    StringBuilder pszSizeBuff, int cchMaxSizeChars);

