sqlexpr32.exe
// All this runs on a background thread so the user
// can cancel my app's setup at any time

// Launch the installer
Process setupProcess = new Process();
setupProcess.StartInfo.FileName = "sqlexpr32.exe";
setupProcess.StartInfo.Arguments = " a bunch of command line args here";
setupProcess.StartInfo.UseShellExecute = false; // to avoid a shell window
setupProcess.Start();

// At this point the SQL Server installer is running

// Monitor the process on 2-second intervals:
while (!setupProcess.WaitForExit(2000))
{
    if(WasCancelled) // flag that is set when the user cancels my app's setup
    {
        // This following line is my problem. Sending CloseMainWindow does not 
        // seem to work. The SQL Server installer just keeps running.
        setupProcess.CloseMainWindow();
        setupProcess.WaitForExit();
        break;
    }
} 

// After this point I build a results report for the user. 
// My app's installer does not yet quit even if it was canceled.

setupProcess.CloseMainWindow();

setupProcess.Close(); // This closes my handle. Not the target process.

CloseMainWindow
sqlexpr32.exe
setup.exe
