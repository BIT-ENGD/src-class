SimpleHTMLFormatter htmlFormatter = new SimpleHTMLFormatter();

var appData = (string)AppDomain.CurrentDomain.GetData("DataDirectory");
var folderpath = System.IO.Path.Combine(appData, "MyFolder");

indexReader = IndexReader.Open(folderpath);

Highlighter highlighter = new Highlighter(htmlFormatter, new QueryScorer(finalQuery.Rewrite(indexReader)));

highlighter.SetTextFragmenter(new SimpleFragmenter(800));

int maxNumFragmentsRequired = 5;

string highlightedText = string.Empty;

TokenStream tokenStream = this._analyzer.TokenStream(fieldName, new System.IO.StringReader(fieldText));

highlightedText = highlighter.GetBestFragments(tokenStream, fieldText, maxNumFragmentsRequired, "...");

return highlightedText;

