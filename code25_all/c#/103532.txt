    if (connection.State != ConnectionState.Open)
    {
        connection.Open();
    }

