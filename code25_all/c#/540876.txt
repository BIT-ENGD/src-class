private static int hits = 0;
private static object hitsLock = new object();

public static string ConvertSdsFileMaskToStringMask(string sdsFileMaskString) {
    Regex bracketsExpression = new Regex(@"\[[^[]*]");
    lock (hitsLock)
    {
        hits = 0;
        return bracketsExpression.Replace(sdsFileMaskString, ReplaceSquareWithAngularBrackets);
    }
}
private static string ReplaceSquareWithAngularBrackets(Match m) {
    string result = String.Format("{{{0}}}", hits.ToString());
    hits++;
    return result;
}

