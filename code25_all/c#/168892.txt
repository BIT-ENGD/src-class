public DataTable ExecuteDataTable(string storedProcName, params object[] args)
{
    SqlCommand cmd = new SqlCommand(storedProcName, conn);
    cmd.CommandType = CommandType.StoredProcedure;

    // inserting params like this does not work...
    for (int i = 0; i < args.Length; i++)
    {
        cmd.Parameters.Insert(i, args[0]);
    }

    DataTable dt = new DataTable();
    dt.Load(cmd.ExecuteReader());

    return dt;
}

