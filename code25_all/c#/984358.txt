using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Linq;
using System.Text;
using System.IO;
using System.Data;
using System.Data.Sql;
using System.Data.SqlClient;
using System.Data.SqlTypes;
using System.Threading;
using System.Text.RegularExpressions;
using System.Globalization;
using System.Net;
using System.Runtime.Remoting;
using Microsoft.SqlServer;
using Microsoft.SqlServer.Server;

namespace Mirf
{
    class Program
    {

        static void Main(string[] args)
        {
 SqlConnection Lig = new SqlConnection();
        DataTable DataTab = new DataTable();


            string str_ligacao_bd = "Data Source=.\\SQL2005;Database=Bd;Integrated Security=SSPI";

            Lig = new SqlConnection(str_ligacao_bd);
            Lig.Open();

            //Efectua a intrução á tabela seleccionada base de dados
            SqlCommand cmd = Lig.CreateCommand();
            cmd.CommandType = CommandType.Text;
            cmd.CommandText = "SELECT * FROM Tab";

            SqlDataAdapter da = new SqlDataAdapter(cmd);
            DataSet ds = new DataSet();
            da.Fill(ds, "tab");
            DataTab = ds.Tables["tab"];


            cmd.Dispose();
            da.Dispose();
            ds.Dispose();
            Lig.Close();


            foreach (DataColumn  d in DataTab.Columns)
            {
                string linha = d.ColumnName;
                if (linha != "Tid")
                {
                    linha = "[" + linha + "]=1";
                    int sum = (int)(DataTab.Compute("COUNT(TID)",linha));
                }
            }

        }
    }

}

