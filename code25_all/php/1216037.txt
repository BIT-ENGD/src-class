function add_gcal($title, $date, $where, $desc){

$newIncludePath = array();
$newIncludePath[] = '../ZendGdata-1.8.4PL1/library';
$newIncludePath = implode($newIncludePath);
set_include_path($newIncludePath);

  // load classes
  require_once 'Zend/Loader.php';
  Zend_Loader::loadClass('Zend_Gdata');
  Zend_Loader::loadClass('Zend_Gdata_ClientLogin');
  Zend_Loader::loadClass('Zend_Gdata_Calendar');
  Zend_Loader::loadClass('Zend_Http_Client');

  // connect to service
  $user = "******";
  $pass = "******";
  $service = Zend_Gdata_Calendar::AUTH_SERVICE_NAME;
  $client = Zend_Gdata_ClientLogin::getHttpClient($user, $pass, $service);

try {
    $gdataCal = new Zend_Gdata_Calendar($client);
    $newEvent = $gdataCal->newEventEntry();

    $newEvent->title = $gdataCal->newTitle($title);
    $newEvent->where = array($gdataCal->newWhere($where));
    $newEvent->content = $gdataCal->newContent("$desc");

    $when = $gdataCal->newWhen();
    $when->startTime = $date;
    $when->endTime = $date; 
    $newEvent->when = array($when);

    $createdEvent = $gdataCal->insertEvent($newEvent);
    return $createdEvent->id->text;

  } catch (Zend_Gdata_App_Exception $e) {
        return NULL;
  }

}

exception 'Zend_Gdata_App_HttpException' with message 'Argument is not an instance of Zend_Http_Client.' 
    in /home/content/*****/html/ZendGdata-1.8.4PL1/library/Zend/Gdata/App.php:247 
Stack trace: 
    #0 /home/content/*****/html/ZendGdata-1.8.4PL1/library/Zend/Gdata/App.php(172): 
        Zend_Gdata_App->setHttpClient(Object(__PHP_Incomplete_Class), 'MyCompany-MyApp...') 
    #1 /home/content/*****/html/ZendGdata-1.8.4PL1/library/Zend/Gdata.php(107): 
        Zend_Gdata_App->__construct(Object(__PHP_Incomplete_Class), 'MyCompany-MyApp...') 
    #2 /home/content/*****/html/ZendGdata-1.8.4PL1/library/Zend/Gdata/Calendar.php(87): 
        Zend_Gdata->__construct(Object(__PHP_Incomplete_Class), 'MyCompany-MyApp...') 
    #3 /home/content/*****/html/scripts/functions.php(85): 
        Zend_Gdata_Calendar->__construct(Object(__PHP_Incomplete_Class)) 
    #4 /home/content/*****/html/calendar/modify_duty.php(68): 
        add_gcal(Object(__PHP_Incomplete_Class), 'R4 - Stephen Au...', '2009-08-19', 'Building: Liva ...', 'Primary') 
    #5 {main}

  // connect to service
  $user = "******";
  $pass = "******";
  $service = Zend_Gdata_Calendar::AUTH_SERVICE_NAME;
  $client = Zend_Gdata_ClientLogin::getHttpClient($user, $pass, $service);

  $client->setConfig(array('keepalive' => true));

