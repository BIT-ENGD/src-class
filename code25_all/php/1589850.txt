$auth_pass = md5( $row['salt'] . $password . $stat_salt );

$auth_pass = hash('sha256', $row['salt'] . $password . $stat_salt );

// generate a unique salt
$salt = uniqid(mt_rand());

// combine them all together and hash them
$hash = hash('sha256', $salt . $password . $stat_salt );

// insert the values into the database
$register_query = mysql_query("INSERT INTO users (username, password, salt) VALUES ('".$username."', '".$hash."', '".$salt."')") or die("MySQL Error: ".mysql_error());

// grab the row associated with the username from the form
$grab_row = mysql_query("SELECT * FROM users WHERE username = '".$username."'") or die ("MySQL Error: ".mysql_error());

// if only one row was retrieved
if (mysql_num_rows($grab_row) == 1) {

// create an array from the row fields
$row = mysql_fetch_array($grab_row);

// re-hash the combined variables
$auth_pass = hash('sha256', $row['salt'] . $password . $stat_salt );

// check the database again for the row associated with the username and the rehashed password
$checklogin = mysql_query("SELECT * FROM users WHERE username = '".$username."' AND password = '".$auth_pass."'") or die("MySQL Error: ".mysql_error());

// if only one row is retrieved output success or failure to the user
if (mysql_num_rows($checklogin) == 1) {
echo "<h1>Yippie, we are authenticated!</h1>";
} else {
echo '<h1>Oh no, we are not authenticated!</h1>';
}
} else {
echo '<h1>Oh no, we are not in the database!</h1>';
}
}

