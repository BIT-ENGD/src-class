is_dir
foreach($userfolders as $uf) {
    $uf = sprintf($uf, $user_id);
    $uf = ltrim($uf,'/');
    $path = trim($base . '/' . $uf);

    $res = is_dir($path); //returns false except last time returns 1
    $this->assertFalse($res, $path);
}

 - Paths are full paths
 - Same thing happens on two separate machines (both running Ubuntu)
 - I have stepped through line by line in a debugger
 - Paths genuinely don't exist at the point where is_dir is called
 - While the code is paused on this line, I can actually drop to a shell and run 

is_dir
