preg_match('/\{((?>[^\{\}]+)|(?R))*\}/x',$text,$matches);

preg_match('/\{\|((?>[^\{\}]+)|(?R))*\|\}/x',$text,$matches);

