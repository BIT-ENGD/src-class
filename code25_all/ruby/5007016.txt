def update
  @product = Product.find(params[:id])

  if params[:product][:image_path]
    # Check if this product already has an image
    File.delete(@product.full_image_path) if File.exist?(@product.full_image_path)
    # Upload the new image
    uploaded_img = params[:product][:image]
    @product.image_path = Time.now.to_i.to_s + File.extname(uploaded_img.original_filename)
    File.open(@product.full_image_path, 'w') do |file|
      file.write(uploaded_img.read)
    end
  end

  @product.name = params[:product][:name]
  @product.description = params[:product][:description]

  respond_to do |format|
    if @product.errors.count == 0
      format.html { redirect_to products_path, :notice => t(:product_updated) }
      format.xml { head :ok }
    else
      format.html { render :action => "edit" }
      format.xml { render :xml => @product.errors, :status => :unprocessable_entity }
    end
  end
end

@product.update_attributes(params[:product])
@product.update_attributes(params[:product])
