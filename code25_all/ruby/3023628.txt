class Test
  attr_accessor :reqs

  def initialize()
    @reqs = []
  end
end


class TestBuilder

  def test(&block)
    @current = Test.new
    block.call
    @current
  end

  def older_than_days(age)
    @current.reqs << lambda { |email| ::Date.parse(email[:date]) < ::Date.today - age }
  end

end


b = TestBuilder.new
x = b.test { b.older_than_days(1) }

p x.reqs[0].call( {:date => "Mon, 5 Apr 2010 03:17:46 -0400"} )

