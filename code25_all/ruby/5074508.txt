<%- unless @requested_contacts.empty? -%>
  <h2>Contact Requests</h2>
  <ul class="list requests small">
    <%- @requested_contacts.each do |contact| -%>
      <%- conn = Connection.conn(current_user, contact) -%>
      <li>

        <p><%= person_link contact %></p>
        <p class="meta published">
          <%= time_ago_in_words(conn.created_at) %> 
          ago
        </p>
        <p>
          <%= link_to "Respond", edit_connection_path(conn) %> |
          <%= link_to "View profile", contact %>
        </p>
      </li>
    <%- end -%>
  </ul>
<%- end -%>

undefined method `contact' for nil:NilClass

app/controllers/connections_controller.rb:15:in `edit'

{"id"=>"4"}

 def edit    
    @contact = @connection.contact
  end

  has_many :connections

  has_many :contacts, :through => :connections, :order => 'people.created_at DESC'
  has_many :requested_contacts, :through => :connections, :source => :contact

  belongs_to :person
  belongs_to :contact, :class_name => "Person", :foreign_key => "contact_id"

  def conn(person, contact)
    find_by_person_id_and_contact_id(person, contact)
  end

<h2>Contact request</h2>

<p>You have a contact request from <%= @contact.name %></p>

<% form_for(@connection) do |f| %>
  <p>
    <%= f.submit "Accept", :class => "button" %>
    <%= f.submit "Decline", :id => nil, :class => "button" %>
  </p>
<% end %>

