# Models
class Journey < ActiveRecord::Base
  has_many :drivers
  accepts_nested_attributes_for :drivers, :allow_destroy => true
  has_many :users, :through => :drivers
  accepts_nested_attributes_for :users
end

class Driver < ActiveRecord::Base
  belongs_to :journey
  belongs_to :user
end

class User < ActiveRecord::Base
  has_many :drivers
  has_many :journeys, :through => :drivers
end

# View _form.html.erb
<% form_for(@journey) do |f| %>
  <%= f.error_messages %>
  <% f.fields_for :drivers do |d| %>
    <%= render :partial => 'driver', :locals => { :f => d } %>
  <% end %>
  <p><%= f.submit 'Submit' %></p>
<% end %>

# View _driver.html.erb
<p><%= f.collection_select(:id, User.all, :id, :name)%></p>

ActiveRecord::AssociationTypeMismatch in JourneysController#create
Driver(#2185315860) expected, got Array(#2151950220)

