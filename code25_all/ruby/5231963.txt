form_for @tag, :as => :tag, :url => @tag.new_record? ? tags_url : tag_url(@tag), :html => {:method => @tag.new_record? ? :post : :put}  do |form|
    ...

