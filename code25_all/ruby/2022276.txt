def authenticate
  if params[:id].try(:size) == 40
    company = Company.find_by_hash_identifier(params[:id])
    if company
      session[:editable_companies] ||= []
      session[:editable_companies] << company.id
      session[:editable_companies].compact!.uniq!
    end
  end
  unless session[:editable_companies].try('&', [company.try(:id), params[:id]])
    flash[:notice]= "You are not permitted to edit this company.<br />Please check the URL from the email we sent you, and try again."
    flash.keep[:notice]
    redirect_to root_url and return
  end
end

