has_many :foo, :through => :user_foo

    - for foo in @foos

You have a nil object when you didn't expect it!
You might have expected an instance of Array.
The error occurred while evaluating nil.each

