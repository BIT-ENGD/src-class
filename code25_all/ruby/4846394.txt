#...
File.open(file, 'r') do |f|
  f.each_line do |line|
    # do stuff here to line
  end
end

$ wc -l nginx.log                                                                                                                                        /code/src/myimport
  642868 ../nginx.log

f.each_line
@skipped
@results
# regex built in `def initialize` (not on each line iteration)
@regex = /(\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}) - (.{0})- \[([^\]]+?)\] "(GET|POST|PUT|DELETE) ([^\s]+?) (HTTP\/1\.1)" (\d+) (\d+) "-" "(.*)"/

#... loop lines
match = line.match(@regex)
if match.nil?
  @skipped << line
else
  @results << convert_to_hash(match)
end

convert_to_hash
