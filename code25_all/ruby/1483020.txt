module BrowserHelper

  def project_browser_helper
    if @project || @controller.controller_name == "projects"
      content_tag(:div, content_tag(:ul, build_browser), :class => "browser")
    end
  end

  def build_browser
    @browser = []
    # a whole bunch of if/elsif/else statements
    # that call methods that add elements to @browser
    # including the following method
    # which is definitely called in this case
    show_an_all_projects_list_item
    @browser.map { |list_item| content_tag(:li, list_item['body'], :id => list_item['id'], :class => list_item['class']) }
  end

  def show_an_all_projects_list_item
    list_item = Hash.new
    list_item['body'] = ["All projects (", Project.find(:all).size.to_s, ")"].join
    list_item['class'] = "all_projects"
    list_item['id'] = "XXX"
    @browser << list_item
  end

end

$browser
@browser
def show_an_all_projects_list_item
def build_browser
@browser.map
<li>
<ul>
