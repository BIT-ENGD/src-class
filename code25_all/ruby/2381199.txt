filename = "/absolute/path/to/Untrusted.rb"
thread = Thread.new do
  $SAFE = 4
  Kernel::load(filename, true)
end
thread.join

#Untrusted code
puts "Untrusted!"

/Volumes/Data/Users/mike/Desktop/Testcase.rb:4:in `write': Insecure operation `write' at level 4 (SecurityError)
    from /Volumes/Data/Users/mike/Desktop/Testcase.rb:7:in `join'
    from /Volumes/Data/Users/mike/Desktop/Testcase.rb:7

$SAFE=4
