class Person <ActiveRecord::Base
   has_many :relationships, :dependent => :destroy
   has_many :masters, :through => :relationships, :conditions => "status='master'"
   has_many :pupils, :through => :relationships, :conditions => "status='pupil'"
   has_many :inverse_relationships, :class_name => "Relationship",
      :foreign_key => "related_id"
   has_many :inverse_masters, :through => :inverse_relationships,  
      :source => :person, :conditions => "status='master'"
   has_many :inverse_pupils, :through => :inverse_relationships,  
      :source => :person, :conditions => "status='pupil'"
end

class Relationship < ActiveRecord::Base
  belongs_to :person
  belongs_to :master, :class_name => "Person", :foreign_key => 'related_id'
  belongs_to :pupil, :class_name => "Person", :foreign_key => 'related_id'
end

@a = Person.find(:first)
@a.masters

status=master
status=pupil
