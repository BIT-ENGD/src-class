  def full_name
   [self.first_name, self.last_name].compact.join(" ")
  end

  def new

    @contact_letter = ContactLetter.new
    @contact_letter.contact_id = params[:contact]
    @contact_letter.letter_id = params[:letter]

    @contact = Contact.find(params[:contact])
    @company = Company.find(@contact.company_id)

    contacts = @company.contacts.collect(&:full_name)

    contacts.each do |contact|
       @colleagues = contacts.reject{ |c| c==@contact.full_name }
    end

    @letter = Letter.find(@contact_letter.letter_id)

    @letter.body.gsub!("{FirstName}", @contact.first_name)
    @letter.body.gsub!("{Company}", @contact.company_name) 
    @letter.body.gsub!("{Colleagues}", @colleagues.to_sentence)

    @contact_letter.body = @letter.body
    @contact_letter.status = "sent"

  end 

