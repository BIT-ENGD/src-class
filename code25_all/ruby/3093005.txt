t.column :profile, :string
t.column :contact_by, :string, :default => "phone", :null => false

validate :validate_contact_by_for_profile1
def validate_contact_by
  if (profile == "profile1") && (contact_by != "email")
    errors.add(:contact_by, " must be 'email' for users in profile1")
  end
end

u = User.new
u.profile => profile1

u
