<% if !@foo.new_record? || !@foo.nil? %>
    Foo is not a new record or nil
<% end %>

You have a nil object when you didn't expect it!
new_record?
if(!empty($foo))
empty?
