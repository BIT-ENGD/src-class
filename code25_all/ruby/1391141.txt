
class Users
end

class Artist < User
  has many :agents, :through => :agents artists
end

class Agent < User
  has many :artists, :through => :agents artists
end

select * from users WHERE users.company LIKE
select * from users AS agents WHERE agents.company LIKE
