f = open("|#{cmd}", 'r')
while char = f.getc
  do something ...
end
f.????

