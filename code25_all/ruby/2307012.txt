def FileImport.installed_formats() 
  FileImport.require_import_folder()
  return FileImport.constants
end

def FileImport.require_import_folder()    
  logger = RAILS_DEFAULT_LOGGER

  #this is giving me what I expect... ["lib/file_import/fixed_text.rb", "lib/file_import/csv.rb"]    
  logger.debug("WHY? " + Dir["lib/file_import/*.rb"].inspect)

  #This is giving me two different things:
  #First run: []
  #Second run: ["lib/file_import/fixed_text.rb", "lib/file_import/csv.rb"]
  logger.debug(($".select {|v| v =~ /file_import/}).inspect)
  Dir["lib/file_import/*.rb"].each do |i| 
    i.sub(/lib\//,"")
    #  $".delete(i)     #I'd rather not do this, if there's a cleaner way...
    require i 
  end

  #first time, this gives what i want:  ["CSV", "FixedText"]
  #When I refresh, I get [] instead...
  logger.debug("SHOULDINSTALL: " + FileImport.constants.inspect)

  #Both times this gives the expected: ["lib/file_import/fixed_text.rb", "lib/file_import/csv.rb"]
  logger.debug(($".select {|v| v =~ /file_import/}).inspect)
end

