class Like < ActiveRecord::Base
  belongs_to :site
  belongs_to :user
  belongs_to :question


    validates_each :user_id do |row, attr, value|
      m.errors.add :user_id, 'Too many likes' unless row.like_count < 10
    end

    def like_count
      Like.count(:conditions => {:user_id => user_id, :question_id => question_id})
    end
  end

class LikesController < ApplicationController

  def create
    @user = current_user
    @site = Site.find(params[:site_id])
    @like = @site.likes.create!(params[:like])
    @like.user = current_user
    @like.save

    respond_to do |format|
     format.html { redirect_to @site}
     format.js
     end
  end
end

