NoMethodError in PagesController#create

undefined method `[]' for nil:NilClass

RAILS_ROOT: ...
Application Trace | Framework Trace | Full Trace

.../vendor/plugins/paperclip/lib/paperclip/thumbnail.rb:18:in `initialize'
.../vendor/plugins/paperclip/lib/paperclip/processor.rb:33:in `new'
.../vendor/plugins/paperclip/lib/paperclip/processor.rb:33:in `make'
.../vendor/plugins/paperclip/lib/paperclip/attachment.rb:295:in `post_process_styles'
.../usr/lib/ruby/1.8/erb.rb:719:in `inject'
....

  has_attached_file :foreground,
                    :storage => :s3,
                    :s3_credentials => "#{RAILS_ROOT}/config/amazon_s3.yml",
                    :bucket => 'recurse',
                    :path => ":attachment/:id_partition/:token/:style/:filename",
                    :styles => {
                      :medium => {:geometry => '372x251>'},
                      :small => {:geometry => '188x156>'},
                      :original_strip => {:geometry => '100x100%', :processors => [:Cropper]},
                      :medium_strip => {:geometry => '100x100%', :processors => [:MediumCropper]},
                      :small_strip => {:geometry => '100x100%', :processors => [:SmallCropper]},
                    }

  has_attached_file :background,
                    :storage => :s3,
                    :s3_credentials => "#{RAILS_ROOT}/config/amazon_s3.yml",
                    :bucket => 'recurse',
                    :path => ":attachment/:id_partition/:token/:style/:filename",
                    :styles => {
                      :medium => {:geometry => '372x251>'},
                      :small => {:geometry => '188x156>'}
                    }

  geometry             = options[:geometry]
  @file                = file
  @crop                = geometry[-1,1] == '#'
  @target_geometry     = Geometry.parse geometry
  @current_geometry    = Geometry.from_file @file

