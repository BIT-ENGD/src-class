            require 'rubygems'
            require 'win32/daemon'
            require 'win32/service'
            include Win32

               class Daemon
                  def service_main
                 while running?
                    sleep 3
                    File.open("c:\\test.log", "a"){ |f| f.puts "service is running" }
                 end
                  end

                  def service_stop
                 exit!
                  end
               end

            Daemon.mainloop

include Win32

SERVICE_NAME = 'ruby_sample1'

# Create a new service
ser = Service.create({
  :service_name        => SERVICE_NAME,
  :service_type       => Service::WIN32_OWN_PROCESS,
  :description        => 'A custom service I wrote just for fun',
  :start_type         => Service::AUTO_START,
  :error_control      => Service::ERROR_NORMAL,
  :binary_path_name   => 'c:\\Ruby186\\bin\\ruby.exe -C c:\\temp\\test.rb',
  :load_order_group   => 'Network',
  :dependencies       => ['W32Time','Schedule'],
  :display_name       => SERVICE_NAME
})

