Imports System
Imports System.IO
Imports System.Linq

Namespace PhotoGalleryApp
    Partial Public Class Index
        Inherits System.Web.UI.Page

        Protected Sub Page_Load(ByVal sender As Object, ByVal e As EventArgs)
            ' Path to photos folder
            Dim photosRelativePath = "~/photos/"
            Dim photosFilePath = Me.Server.MapPath(photosRelativePath)

           ' Get list of img files from photos folder
            Dim photos = From file In New DirectoryInf(photosFilePath).GetFiles() 
            Where (file.Name.EndsWith(".jpg",
                                StringComparison.InvariantCultureIgnoreCase)
                   OrElse file.Name.EndsWith(".gif",
                                StringComparison.InvariantCultureIgnoreCase)
                   OrElse file.Name.EndsWith(".png",
                                StringComparison.InvariantCultureIgnoreCase))
            Select photosRelativePath & file.Name

            ' Return photos as string array
            lstPhotos.DataSource = photos.ToArray()
            lstPhotos.DataBind()
        End Sub
    End Class
End Namespace

 <asp:ListView ID="lstPhotos" runat="server">
        <ItemTemplate>
            <img src='<%# ResolveUrl(Container.DataItem.ToString()) %>' width="250" height="300" />
        </ItemTemplate>
        </asp:ListView>


    <script type="text/javascript" src="http://ajax.microsoft.com/ajax/jquery/jquery-1.4.2.js"></script> 
    <script type="text/javascript" src="http://ajax.microsoft.com/ajax/jquery.cycle/2.88/jquery.cycle.all.js"></script> 
    <script type="text/javascript">

        $("#photos").cycle("toss");

    </script> 

