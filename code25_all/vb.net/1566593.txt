Public MustInherit Class BaseRepository(Of T As Class)

    Public Class CommunicationTypeRepository
        Inherits BaseRepository(Of CommunicationType)

Public Shared Function GetRepository(Of TEntity As Class, _
                           TRepo As BaseRepository(Of TEntity)) _
                           (ByVal sampleData As IList(Of TEntity)) As TRepo

    Dim repoWithFakeBase = New Mock(Of TRepo)()
    repoWithFakeBase.Setup(Function(x) x.GetAll()).Returns(sampleData.AsQueryable())
    Return repoWithFakeBase.Object
End Function

GetAll
BaseRepository
System.InvalidOperationException : No coercion operator is defined between types 'DomainModel.Concrete.CommunicationTypeRepository' and 'DomainModel.Abstract.BaseRepository`1[T]'.

System.InvalidOperationException : No coercion operator is defined between types 'DomainModel.Concrete.CommunicationTypeRepository' and 'DomainModel.Abstract.BaseRepository`1[T]'.
at System.Linq.Expressions.Expression.GetUserDefinedCoercionOrThrow(ExpressionType coercionType, Expression expression, Type convertToType)
at System.Linq.Expressions.Expression.Convert(Expression expression, Type type)
at DomainTests.Concrete.CommunicationTypeRepositoryTest.GetRepository[TEntity,TRepo](IList`1 sampleData)
at DomainTests.Concrete.CommunicationTypeRepositoryTest.Correct_Item_Found_When_Searched_By_Code()

