 Public Shared Function GetAllProducts() As ProductCollection

        Dim Products As New ProductCollection()

        If IsNothing(System.Web.HttpContext.Current.Cache("ProductData")) Then

            '////// Database code to get products goes here //////

            System.Web.HttpContext.Current.Cache.Insert("ProductData", Products, Nothing, DateTime.Now.AddMinutes(5), TimeSpan.Zero)
        End If
        Products = System.Web.HttpContext.Current.Cache("ProductData")

        Return Products

    End Function

 Public Shared Function SearchProducts(ByVal SearchText As String) As ProductCollection

        Dim ProductSearchResults As ProductCollection = Nothing

        If SearchText <> "" Then

            SearchText = SearchText.ToLower()

            Dim Keywords As New ArrayList()
            Keywords.AddRange(SearchText.Split(" ".ToCharArray(), StringSplitOptions.RemoveEmptyEntries))

            ProductSearchResults = GetAllProducts()

            For i As Integer = 0 To Keywords.Count - 1

                For j As Integer = ProductSearchResults.Count - 1 To 0 Step -1
                    If ProductSearchResults(j).ProductName.ToLower.Contains(Keywords(i)) = False Then
                        ProductSearchResults.RemoveAt(j)
                    End If
                Next

            Next

        End If

        Return ProductSearchResults

    End Function

