  Private Sub cmbDatabase_DropDown(ByVal sender As Object, ByVal e As System.EventArgs) Handles cmbDatabase.DropDown
    Dim databaselist As New DataSet
    Dim connection As SqlClient.SqlConnection
    If txtServer.Text <> "" And txtLogin.Text <> "" And txtPassword.Text <> "" Then

        Try
        connection = New SqlClient.SqlConnection("Data Source=" + txtServer.Text + ";Initial Catalog=master;User ID=" + txtLogin.Text + ";Password=" + txtPassword.Text + ";Connect Timeout=5")
            connection.Open()
        Catch ex As Exception
        End Try


        If Not connection.State = ConnectionState.Closed Then
            Dim command As New SqlClient.SqlDataAdapter("EXEC sp_databases", connection)
            command.Fill(databaselist)
            cmbDatabase.DataSource = databaselist.Tables(0)
            cmbDatabase.DisplayMember = "DATABASE_NAME"
        End If
    End If

