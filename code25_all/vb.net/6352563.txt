    Call ReportConnection(CInspAuditList, "A")
    CInspAuditList.ReportFileName = My.Application.Info.DirectoryPath & "\A.rpt"
    Call SubReportConnection(CInspAuditList, "A")
    CInspAuditList.set_ParameterFields(0, temp1)
    CInspAuditList.set_ParameterFields(1, temp2)
    CInspAuditList.set_ParameterFields(2, temp3)
    CInspAuditList.set_ParameterFields(3, temp4)
    CInspAuditList.Action = 1

Public Function ReportConnection(ByRef CrystalReport1 As Object, ByRef dsnname As String) As Boolean

    Try
        CrystalReport1.Connect = "dsn=" & dsnname & ";UID=" & gstrID & ";PWD=" & gstrPassword & ";DSQ="
    Catch ex As Exception
        MsgBox(ex.ToString)
        End
    End Try
End Function
Public Function SubReportConnection(ByRef CrystalReport1 As Object, ByRef dsnname As String) As Object
    Dim NReport As Short
    With CrystalReport1
        NReport = .GetNSubreports
        Do While NReport > 0
            .SubreportToChange = .GetNthSubreportName(NReport - 1)
            .Connect = "dsn=" & dsnname & ";UID=" & gstrID & ";PWD=" & gstrPassword & ";DSQ="
            .SubreportToChange = ""
            NReport = NReport - 1
        Loop
    End With
End Function

Exception from HRESULT: 0x800A501B
CInspAuditList.Action = 1




