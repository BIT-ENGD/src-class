Dim imageInfo As FileInfo = Nothing
Dim data() As Byte = Nothing
imageInfo = New FileInfo(Me.UploadLogo.Value.Trim())
Dim imagestream As FileStream = New FileStream(imageInfo.ToString, FileMode.Open)

if name_id > 0
    ReDim data(imagestream.Length - 1)
    imagestream.Read(data, 0, imagestream.Length)
    imagestream.Close()
    Sqlstr = "UPDATE logos WITH(ROWLOCK) " & _
             "SET Logo=@Logo,Modified_Date=GETDATE() " & _
             "WHERE ID = " + name_id.ToString + ""
Else
    Sqlstr = "INSERT logos (Logo,Created_Date) " & _
             "VALUES ("@Logo,GETDATE())"
End If

SqlCmd = New SqlCommand(Sqlstr, SqlCnn)
Dim pictureParameter As SqlParameter = Nothing
pictureParameter = New SqlParameter("@Logo", SqlDbType.Image)
pictureParameter.Value = data
SqlCmd.Parameters.Add(pictureParameter)
SqlCmd.ExecuteScalar()

