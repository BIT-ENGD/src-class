Dim urlHost As String = "ftp://" + FWFTP.Default.TargetFTPHost.ToString()
    Dim url As String = "ftp://" + FWFTP.Default.TargetFTPHost & "/" & FWFTP.Default.TargetFolder & "/" & fileName
    Dim clsRequest As System.Net.FtpWebRequest = CType(WebRequest.Create(url), FtpWebRequest)

    clsRequest.Credentials = New System.Net.NetworkCredential(FWFTP.Default.FTPUserName.ToString(), FWFTP.Default.FTPPassword.ToString())
    clsRequest.Proxy = Nothing
    Dim target As New Uri(urlHost)
    Dim iphe() As System.Net.IPAddress = System.Net.Dns.GetHostAddresses(target.Host)

    If My.Computer.Network.Ping(iphe(0).ToString, 200) = False Then
        MsgBox("Ping: " + urlHost + ":" + iphe(0).ToString + " Failed")
        'ElseIf FTPSite <> "" Then
    End If
    clsRequest.KeepAlive = False
    clsRequest.UseBinary = False
    clsRequest.UsePassive = True


    clsRequest.Method = System.Net.WebRequestMethods.Ftp.UploadFile

    ' read in file...
    Dim bFile() As Byte = System.IO.File.ReadAllBytes(fullPath)

    ' upload file...
    Dim clsStream As System.IO.Stream = _
        clsRequest.GetRequestStream()
    clsStream.Write(bFile, 0, bFile.Length)
    clsStream.Close()
    clsStream.Dispose()

