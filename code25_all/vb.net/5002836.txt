Dim bytes() As Byte
stream.WriteByte(CmdId)
bytes = BitConverter.GetBytes(bufferSize)
stream.Write(bytes, 0, bytes.Length)
stream.Write(buffer, offset, bufferSize)
bytes = BitConverter.GetBytes(singleValue1)
stream.Write(bytes, 0, bytes.Length)
bytes = BitConverter.GetBytes(singleValue2)
stream.Write(bytes, 0, bytes.Length)
bytes = BitConverter.GetBytes(intValue1)
stream.Write(bytes, 0, bytes.Length)
bytes = BitConverter.GetBytes(intValue2)
stream.Write(bytes, 0, bytes.Length)

Dim bytes(3) As Byte
cmd = stream.readByte()
stream.Read(bytes, 0, 4)
Dim bufferSize As Integer = BitConverter.ToInt32(bytes, 0)
Dim buf(bufferSize - 1) As Byte
Dim nRead As Integer = 0
While nRead < bufferSize
  nRead += stream.Read(buf, nRead, bufferSize - nRead)
End While
stream.Read(bytes, 0, 4)
Dim s1 As Single = BitConverter.ToSingle(bytes, 0)
stream.Read(bytes, 0, 4)
Dim s2 As Single = BitConverter.ToSingle(bytes, 0)
stream.Read(bytes, 0, 4)
Dim i1 As Integer = BitConverter.ToInt32(bytes, 0)
stream.Read(bytes, 0, 4)
Dim i2 As Integer = BitConverter.ToInt32(bytes, 0)

