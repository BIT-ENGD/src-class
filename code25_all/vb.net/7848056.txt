 Dim sv As New WL.SessionVariables(Me.Context)

    If Not (sv.IsLoggedIn) Then
        Response.Redirect(WL.SiteMap.GetLoginURL())
    End If

Public Class CustomHandler
    Implements System.Web.IHttpHandler, IReadOnlySessionState

    Sub ProcessRequest(ByVal context As HttpContext) Implements IHttpHandler.ProcessRequest
        Dim sv As New WL.SessionVariables(context)
        If Not (sv.IsLoggedIn) Then
            context.Response.Write("No access unless you're the CEO!!!" & sv.IsLoggedIn)
        ElseIf sv.IsLoggedIn Then
            DownloadFile(context)
        Else
        End If
    End Sub 
   //other code
End Class

Public Sub SetCreditialCookie(ByVal accountID As Integer)
        Me.AccountID = accountID
        m_context.Session.Item("loggedInAccount") = accountID

        m_context.Response.Cookies.Add(New System.Web.HttpCookie("account_id", CStr(m_context.Session.Item("account_id"))))
        m_context.Response.Cookies("account_id").Expires = DateTime.Now.AddDays(5)
    End Sub

Public Function IsLoggedIn() As Boolean
        If Not m_context.Session.Item("loggedInAccount") Is Nothing And Me.AccountID = m_context.Session.Item("loggedInAccount") Then
            Return True
        Else
            Return False
        End If
    End Function

