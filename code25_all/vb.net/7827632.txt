' Add the event handler for handling UI thread exceptions to the event.
AddHandler Application.ThreadException, AddressOf Application_ThreadException

' Add the event handler for handling non-UI thread exceptions to the event. 
AddHandler AppDomain.CurrentDomain.UnhandledException, AddressOf CurrentDomain_UnhandledException

'For Console applications you should use the System.AppDomain.UnhandledException event
AddHandler Thread.GetDomain().UnhandledException, AddressOf CurrentDomain_UnhandledException

Imports System.Threading

Public Class Form1
    Inherits Form2

    Shared Sub New()
        ' Add the event handler for handling UI thread exceptions to the event. 
        AddHandler Application.ThreadException, AddressOf Application_ThreadException

        ' Add the event handler for handling non-UI thread exceptions to the event.  
        AddHandler AppDomain.CurrentDomain.UnhandledException, AddressOf CurrentDomain_UnhandledException

    End Sub

    Private Shared Sub CurrentDomain_UnhandledException(ByVal sender As Object, ByVal e As UnhandledExceptionEventArgs)
        MsgBox("UnhandledException caught")
    End Sub

    Private Shared Sub Application_ThreadException(ByVal sender As Object, ByVal e As ThreadExceptionEventArgs)
        MsgBox("ThreadException caught")
    End Sub

    Protected Overrides Sub Login()
        Throw New Exception("Ha!")

        MyBase.Login()
    End Sub

    Protected Overrides Sub Form2_FormClosing(sender As System.Object, e As System.Windows.Forms.FormClosingEventArgs)
        MsgBox("Form1Closing")

        MyBase.Form2_FormClosing(sender, e)
    End Sub
End Class

Public Class Form2

  Protected Overridable Sub Form2_FormClosing(sender As System.Object, e As System.Windows.Forms.FormClosingEventArgs) Handles MyBase.FormClosing
        MsgBox("Form2Closing")
    End Sub

    Private Sub Form2_Shown(sender As System.Object, e As System.EventArgs) Handles MyBase.Shown
        Login()
    End Sub

    Protected Overridable Sub Login()
        MsgBox("Form2 LoggingIn")
    End Sub
End Class

