Imports IWshRuntimeLibrary

Dim AppName As String = "StartUp ShortCut"
Dim startUpFolderPathALLUSERfWin7 As String = Environment.GetEnvironmentVariable(("ALLUSERSPROFILE") & "\Microsoft\Windows\Start Menu\Programs\Startup")

Private Sub Create_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click

    Dim lnkPathAllUserWin7 As String = startUpFolderPathALLUSERfWin7 & "\" & AppName & ".lnk" 'need permission
    Dim appPath As String = My.Computer.FileSystem.CurrentDirectory & "\" & AppName & ".exe"

    Try
        Dim wshs As IWshShell_Class = New IWshShell_Class
        Dim shortcut As IWshShortcut_Class = TryCast(wshs.CreateShortcut(lnkPathAllUserWin7), IWshShortcut_Class)
        shortcut.Description = "This is a shortcut to " & AppName
        shortcut.TargetPath = appPath
        shortcut.IconLocation = appPath + ",0"
        shortcut.Save()
        MsgBox("ShortCut File Created")
    Catch ex As Exception
        MsgBox(ex.ToString)
    End Try
End Sub

