Public Class Fields
    Private Field_Name As String
    Private Field_Type As System.Type

    Public Sub New()
    End Sub

    Protected Overrides Sub Finalize()
    End Sub

    Property Name() As String
        Get
            Return Field_Name
        End Get
        Set(ByVal value As String)
            Field_Name = value
        End Set
    End Property

    Property Type() As System.Type
        Get
            Return Field_Type
        End Get
        Set(ByVal value As System.Type)
            Field_Type = value
        End Set
    End Property
End Class

Public Function Get_List_Of_Fields(ByVal Table_Name As String, ByVal Database_Name As String) As List(Of Fields)
    Dim List_Of_Fields As New List(Of Fields)
    Dim DataModel As MetaModel = Get_Datamodel(Database_Name)

    Dim Data_Table = (From DataTable In DataModel.GetTables Where DataTable.TableName = Table_Name).FirstOrDefault

    For Each Field In Data_Table.RowType.DataMembers
        Dim Fields_Obj As New Fields
        Fields_Obj.Name = Field.Name
        Fields_Obj.Type = Field.Type
        List_Of_Fields.Add(Fields_Obj)
    Next
    Return List_Of_Fields
End Function

<WebMethod()> _
Public Function Get_List_of_Fields(ByVal Table_Name As String, ByVal Database_Name As String) As List(Of Fields)
    Return _DynaLib.Get_List_Of_Fields(Table_Name, Database_Name)
End Function

Imports Dynamic_Charting.DynamicReference 
Private _DynamicService As New DynamicServiceSoapClient

Public Function Get_List_of_Fields(ByVal Table_name As String, ByVal Database_Name As String) As List(Of Fields)
     Return _DynamicService.Get_List_of_Fields(Table_name, Database_Name)
 End Function

