<asp:DropDownList ID="ddlCompany" runat="server" DataSourceID="dsCompanyFilter"  
DataTextField="CompanyName" DataValueField="CompanyID" AppendDataBoundItems="true" 
AutoPostBack="true">

Protected Sub ddlCompany_SelectedIndexChanged(ByVal sender As Object, ByVal e As 
System.EventArgs) Handles ddlCompany.SelectedIndexChanged
    Dim CompanyID As Integer = ddlCompany.SelectedValue
    dsProductLookup.SelectCommand = "SELECT ProductName, CompanyID, CompanyName 
                                    FROM Product, Company 
                                    WHERE CompanyID = @CompanyID 
                                    ORDER BY ProductName"
    dsProductLookup.SelectParameters.Add("@CompanyID", ddlCompany.SelectedValue)
End Sub

<asp:gridview id="gvProducts" runat="server" AutoGenerateColumns="false" 
datakeynames="ProductID" datasourceid="dsProductLookup" style="margin-top: 12px;">

<asp:sqldatasource id="dsProductLookup" runat="server" 
Connectionstring="<%$ ConnectionStrings:ProductsConnectionString %>"
SelectCommand="SELECT ProductID, ProductName FROM [Product] ORDER BY [ProductName]">
</asp:sqldatasource>

<asp:SqlDataSource ID="dsCompanyFilter" runat="server" 
    ConnectionString="<%$ ConnectionStrings:ProductsConnectionString %>" 
    SelectCommand="SELECT [CompanyName], [CompanyID] FROM [Company] ORDER BY CompanyName">
</asp:SqlDataSource>

Must declare the scalar variable "@CompanyID".
Choose Company: <asp:DropDownList ID="ddlCompany" runat="server" DataSourceID="dsCompanyFilter"  DataTextField="CompanyName" DataValueField="CompanyID" AppendDataBoundItems="true" AutoPostBack="true">
<asp:ListItem Enabled="true" Text="Select an option"></asp:ListItem>
</asp:DropDownList>


<asp:gridview id="gvCategories" runat="server" AutoGenerateColumns="False"
 datakeynames="CategoryID,CompanyID" datasourceid="dsCategoryLookup" emptydatatext="No 
 categories/products found." style="margin-top: 12px;">
<Columns>
    <asp:BoundField HeaderText="Category Name" DataField="CategoryName" />
    <asp:HyperLinkField DataNavigateUrlFields="ProductID" 
    DataNavigateUrlFormatString="Product/Default.aspx?ID={0}"
    DataTextField="ProductName" 
    HeaderText="Product Name" />
</Columns>
</asp:gridview>

<asp:SqlDataSource ID="dsCategoryLookup" runat="server" 
    ConnectionString="<%$ ConnectionStrings:ProductsConnectionString %>" 
    SelectCommand="SELECT DISTINCT c.CategoryName, c.CategoryID, p.ProductName, 
                   p.ProductID, cl.CompanyID, cl.ProductID, co.CompanyID 
                   FROM Category AS c 
                   INNER JOIN CategoryLink AS l ON l.CategoryID = c.CategoryID 
                   INNER JOIN Product AS p ON p.ProductID = l.ProductID 
                   LEFT JOIN CompanyLink AS cl ON cl.ProductID = p.ProductID">
</asp:SqlDataSource>
<asp:SqlDataSource ID="dsCompanyFilter" runat="server" 
    ConnectionString="<%$ ConnectionStrings:ProductsConnectionString %>" 
    SelectCommand="SELECT [CompanyName], [CompanyID] 
                   FROM [Company] 
                   ORDER BY CompanyName">
</asp:SqlDataSource>



 Protected Sub ddlCompany_SelectedIndexChanged(ByVal sender As Object, ByVal e As 
 System.EventArgs) Handles ddlCompany.SelectedIndexChanged
    dsCategoryLookup.SelectCommand = "SELECT Category.CategoryName, 
                                     CategoryLink.ProductID, Company.CompanyName, 
                                     Company.CompanyID, CompanyLink.CompanyID AS Expr1,
                                     Product.ProductName, Product.ProductID, 
                                     CompanyLink.ProductID AS Expr2 
                                     FROM Company 
                                     LEFT JOIN CompanyLink 
                                     ON Company.CompanyID = CompanyLink.CompanyID 
                                     LEFT JOIN Product 
                                     ON CompanyLink.ProductID = Product.ProductID 
                                     LEFT JOIN CategoryLink 
                                     ON CategoryLink.ProductID = Product.ProductID 
                                     LEFT JOIN Category  
                                     ON CategoryLink.CategoryID = Category.CategoryID
                                     WHERE Company.CompanyID = @CompanyID 
                                     ORDER BY Product.ProductName"

