Private Sub winMain_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load
        ''#Load Grid
        Dim dt As New DataTable
        With dt
            .Columns.Add("Name")
            .Columns.Add("Frequency")
            .Columns.Add("Percent Spent")
            .Columns.Add("Started")
            .Columns.Add("Ends")
        End With

        Dim Budgets As New List(Of BudgetManager.DTO.Budget)
        Budgets = BudgetManager.Process.Budget.GetAllBudgets()

        Dim values(5) As String
        For Each budget In Budgets
            values(0) = budget.Name
            values(1) = BudgetManager.Lookup.GetLookupTextById(budget.FrequencyId)
            Dim total As Double = 0.0
            Dim spent As Double = 0.0
            For Each category In budget.Categories
                total += category.Amount
                spent += category.Spent
            Next
            values(2) = FormatPercent(spent / total)
            values(3) = budget.StartDate.ToString
            values(4) = budget.EndDate.ToString

            dt.Rows.Add(values)
        Next

        gridBudget.DataSource = dt
    End Sub

Budgets = BudgetManager.Process.Budget.GetAllBudgets()

