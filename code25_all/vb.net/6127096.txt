Public Sub BeginTransaction() Implements ITransactionalQueriesBase.BeginTransaction
    Me.Context.Connection.Open()
    Me.Context.Transaction = Context.Connection.BeginTransaction()
    IsInTransaction = True
End Sub

<TestMethod()>
    Public Sub FacilityService_Can_Rollback_A_Transaction()
        faciService.BeginTransaction()

        Dim devApp = UnitTestHelper.CreateDevelopmentApplication(devService.GetDevelopmentType("NEWFACI").ID, 1, 1, 1, 1)

        Dim devInsertRes = devService.InsertDevelopmentApplication(devApp)

        Assert.IsTrue(devInsertRes.ReturnValue > 0)

        For Each dir1 In devInsertRes.Messages
            Assert.Fail(dir1)
        Next

        Dim migrationResult = faciService.ProcessNewFacilityDevelopment(devInsertRes.ReturnValue)
        Assert.IsTrue(migrationResult.ReturnValue.InsertResult)

        Dim faciRetrieval1 = faciService.GetFacilityByID(migrationResult.ReturnValue.FacilityID)
        Assert.IsNotNull(faciRetrieval1.ReturnValue)

        faciService.Rollback()

        Dim faciRetrieval2 = faciService.GetFacilityByID(migrationResult.ReturnValue.FacilityID)
        Assert.IsNull(faciRetrieval2.ReturnValue)
    End Sub

