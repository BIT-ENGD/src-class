ProjAndForm = "SQLtesting.Form1"
FormInstanceType = Type.GetType(ProjAndForm, True, True)
objForm = CType(Activator.CreateInstance(FormInstanceType), Form)

Private Sub Button7_Click(ByVal sender As System.Object, ByVal e As

    Dim CtlType As Type
    Dim FormInstanceType As Type
    Dim index As Integer 
    Dim objForm As Form
    Dim ProjAndForm As String
    Dim TypeName1 As String
    Dim TypeName2 As String

    ListBox1.Sorted = True
    ListBox1.Items.Clear()

    CheckedListBox1.Sorted = True
    CheckedListBox1.Items.Clear()
    CheckedListBox1.CheckOnClick = True

    ProjAndForm = "SQLtesting.Form1"
    FormInstanceType = Type.GetType(ProjAndForm, True, True)
    objForm = CType(Activator.CreateInstance(FormInstanceType), Form)

    For Each ctl As Control In objForm.Controls 
        CtlType = ctl.GetType
        TypeName1 = CtlType.ToString.Substring(21) ' Remove system.windows.forms prefix
        index = CheckedListBox1.FindStringExact(TypeName1)
        If index = -1 Then
            CheckedListBox1.Items.Add(TypeName1)
        End If
        TypeName1 = TypeName1 & ":" & ctl.Name & ":" & ctl.Text
        ListBox1.Items.Add(TypeName1.ToString)
    Next ctl

End Sub

