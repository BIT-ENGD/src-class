    Dim dset As DataSet = New DataSet
    If (CboCustomers.SelectedValue IsNot Nothing) AndAlso (CboCustomers.SelectedValue <> "") Then
        Dim Sql As String = "Select sal.SalesOrderNo As SalesOrder,cus.CustomerName,has.SerialNo, convert(varchar,sal.Dateofpurchase,103) as Date from [dbo].[Customer_Table] as cus " & _
                                 " inner join [dbo].[Hasp_table] as has on has.CustomerID=cus.CustomerTag " & _
                                " inner join [dbo].[salesorder_table] as sal On sal.Hasp_ID =has.Hasp_ID Where cus.CustomerTag = '" & CboCustomers.SelectedValue.ToString & "'"
        Dim dap As SqlDataAdapter = New SqlDataAdapter(Sql, FormConnection)
        dap.Fill(dset, "dbo.Customer_Table")
        DGCustomer.DataSource = dset.Tables("dbo.Customer_Table")
    Else
        Dim erm As String = "wtf"
    End If

If ((Not Me.CboCustomers.SelectedValue Is Nothing) And (Not Me.CboCustomers.SelectedValue Is "")) Then

    Try
        If ((Not Me.CboCustomers.SelectedValue Is Nothing) And (Not Me.CboCustomers.SelectedValue Is "")) Then
            Dim Sql As String = "Select sal.SalesOrderNo As SalesOrder,cus.CustomerName,has.SerialNo, convert(varchar,sal.Dateofpurchase,103) as Date from [dbo].[Customer_Table] as cus " & _
                                     " inner join [dbo].[Hasp_table] as has on has.CustomerID=cus.CustomerTag " & _
                                    " inner join [dbo].[salesorder_table] as sal On sal.Hasp_ID =has.Hasp_ID Where cus.CustomerTag = '" & CboCustomers.SelectedValue.ToString & "'"
            Dim dap As SqlDataAdapter = New SqlDataAdapter(Sql, FormConnection)
            dap.Fill(dset, "dbo.Customer_Table")
            DGCustomer.DataSource = dset.Tables("dbo.Customer_Table")
        Else
            CboCustomers.SelectedIndex = 0
        End If
    Catch ex As Exception
        ' CODE REVIEW NOTE: MJR 16/06/2010
        '   1) This is very odd, i cant figure this out but this hack works.
        '   2) The try catch is here purely to make the if statement work as expected?!?!? 
        '   3) Take it out and both blocks of the if then else will execute in release mode, 
        '   at first i though "DGCustomer.DataSource = dset.Tables("dbo.Customer_Table")" raised an exception but ex is nothing.
        '   4) Ideas anyone?
    End Try

