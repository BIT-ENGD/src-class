Protected Sub Button1_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles Button1.Click
        Dim UTCTime As Date = TextBox1.Text
        Dim IndianTime As DateTime = UTCTime.AddHours(5.5)
        Dim beforeVal As New TimeSpan(168, 59, 59)
        Dim beforeVal1 As New TimeSpan(72, 59, 59)
        Dim beforeVal2 As New TimeSpan(23, 59, 59)
        Label1.Text = IndianTime.AddSeconds(-beforeVal.TotalSeconds).ToString("G")
        Label2.Text = IndianTime.AddSeconds(-beforeVal1.TotalSeconds).ToString("G")
        Label3.Text = UTCTime.AddSeconds(-beforeVal2.TotalSeconds).ToString("G")

        '////////////

        Dim UTCTime1 As Date = Date.UtcNow
        Dim IndianTime1 As DateTime = UTCTime1.AddHours(5.5)
        Label4.Text = IndianTime1.ToString("G")
        If CType(Label4.Text, Date) >= CType(Label3.Text, Date) Then
            Label5.Text = "Sorry ! Ticket cannot be cancelled on same day or after journey date"
        ElseIf CType(Label4.Text, Date) >= CType(Label2.Text, Date) Then
            Label5.Text = "Sorry ! Ticket cannot be cancelled on same day or after journey date"
        ElseIf CType(Label4.Text, Date) >= CType(Label1.Text, Date) Then
            Label5.Text = "Sorry ! Ticket cannot be cancelled on same day or after journey date"
        Else
            Label5.Text = "Print"
        End If



    End Sub

Protected Sub Button1_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles Button1.Click
        Dim UTCTime1 As Date = Date.UtcNow
        Dim IndianTime1 As DateTime = UTCTime1.AddHours(5.5)
        Label4.Text = IndianTime1.ToString("G")
        If CType(Label4.Text, Date) >= CType(Label3.Text, Date) Then
            Label5.Text = "Sorry ! Ticket cannot be cancelled on same day or after journey date"
        Else
            Label5.Text = "Print"
        End If
    End Sub
    Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
        Dim UTCTime As Date = TextBox1.Text
        Dim IndianTime As DateTime = UTCTime.AddHours(5.5)
        Dim beforeVal As New TimeSpan(168, 59, 59)
        Dim beforeVal1 As New TimeSpan(72, 59, 59)
        Dim beforeVal2 As New TimeSpan(23, 59, 59)
        Label1.Text = IndianTime.AddSeconds(-beforeVal.TotalSeconds).ToString("G")
        Label2.Text = IndianTime.AddSeconds(-beforeVal1.TotalSeconds).ToString("G")
        Label3.Text = UTCTime.AddSeconds(-beforeVal2.TotalSeconds).ToString("G")
    End Sub

