Public Class Form1
   Private Y As Integer
   Private intDirection As Integer = 1

   Private Sub timTest_Tick(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles timTest.Tick
      Me.Invalidate()
   End Sub

   Private Sub Form1_Paint(ByVal sender As Object, ByVal e As System.Windows.Forms.PaintEventArgs) Handles Me.Paint

      Dim g As Graphics = Me.CreateGraphics
      Dim myPen As New Pen(Color.Black)

      myPen.Width = 1
      g.SmoothingMode = Drawing2D.SmoothingMode.AntiAlias
      g.DrawLine(myPen, 10, 10, 200, Y)

      Y += intDirection

      If Y > Me.Height - 20 Then intDirection = -1
      If Y < 0 Then intDirection = 1
      g.Dispose()
      myPen.Dispose()
   End Sub
End Class

  Dim intAlloc As Integer = Me.Width * Me.Height * 16
  GC.AddMemoryPressure(intAlloc)

  GC.RemoveMemoryPressure(intAlloc)

