Class MainWindow
    Dim bw As BackgroundWorker = New BackgroundWorker()

    Private Sub Window_Loaded(ByVal sender As System.Object, ByVal e As System.Windows.RoutedEventArgs)
        AddHandler bw.DoWork, AddressOf bw_DoWork
        AddHandler bw.RunWorkerCompleted, AddressOf bw_RunWorkerCompleted

        bw.RunWorkerAsync()
    End Sub

    Private Sub bw_DoWork(ByVal sender As Object, ByVal e As DoWorkEventArgs)
        For i As Integer = 0 To 250000
            Dim d As New test_delegate(AddressOf test)
            Dispatcher.Invoke(d, " SUPER SUPER SUPERSPERSUPERSUPERvSUPERSUPERSUPERSUPERv LONG Test")
        Next
    End Sub

    Private Delegate Sub test_delegate(ByVal txt As String)
    Private Sub test(ByVal txt As String)
        txtTest.Text = txt
    End Sub
End Class

