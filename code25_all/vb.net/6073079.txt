Sub PrintUserNames()
    'Declare Command
    Dim de As New DirectoryEntry()
    'Nameint Place to Write file
    Dim userFile As String = "C:\DomainUsers.txt"
    Dim fileExists As Boolean = File.Exists(userFile)

    'Use Input Box for domain entry
    Dim message, Title, defaultValue As String
    Dim myValue As Object
    message = "Enter your Domain Name"
    Title = "Domain Name Entry"
    defaultValue = "Enter Domain Name"
    myValue = InputBox(message, Title, defaultValue)
    'Get List of all users on Domain using WinNT
    'Replacement Command
    Dim ReplaceCommand1 As String = de.Path.Replace("***", myValue) = "WinNT://""***"""
    Using sw As New StreamWriter(File.Open(userFile, FileMode.OpenOrCreate))
        For Each d As DirectoryEntry In de.Children()
            sw.WriteLine(d.Name)
        Next
    End Using

