Public Shared Sub ColumnImageToRight(ByVal view As ListView, ByVal index As Integer)
        Dim LVM_GETCOLUMNW As Integer = &H1000 + 95
        Dim LVM_SETCOLUMNW As Integer = &H1000 + 96
        If Not view.IsHandleCreated Then
            Throw New InvalidOperationException("ListView not yet created, wait...")
        End If
        If index >= view.Columns.Count Then
            Throw New ArgumentOutOfRangeException("Column index out of range")
        End If
        Dim buf As IntPtr = Marshal.AllocHGlobal(Marshal.SizeOf(GetType(LVCOLUMN)))
        Dim lvc As New LVCOLUMN()
        lvc.mask = &HFFFF
        Marshal.StructureToPtr(lvc, buf, False)
        Dim retval As IntPtr = SendMessageW(view.Handle, LVM_GETCOLUMNW, CType(index, IntPtr), buf)
        lvc = CType(Marshal.PtrToStructure(buf, GetType(LVCOLUMN)), LVCOLUMN)
        lvc.fmt = lvc.fmt Or &H1000
        Marshal.StructureToPtr(lvc, buf, False)
        retval = SendMessageW(view.Handle, LVM_SETCOLUMNW, CType(index, IntPtr), buf)
        Marshal.FreeHGlobal(lvc.pszText)
        Marshal.FreeHGlobal(buf)
    End Sub

