Public Sub DataReceivedHandler(ByVal sender As Object, ByVal dataReceived As DataRecievedEventArgs)
     For Each byteReceived As Byte In dataReceived.data
         rxDataStruct.dataPacket(rxDataStruct.InPacketLength) = byteReceived
         rxDataStruct.InPacketLength += 1
     Next
     rxDataReady = True

sendCommand = False
CANPort.rxDataReady = False
     Try
          Do
              Tries += 1
              If Tries > 4 Then
                  Exit Do
              End If
              CANTimer.Start()
              CANPort.transmitPacket(OutCANPacket)

              'Wait for Return Packet
              Do Until CANPort.rxDataReady = True Or _ 
                      CANTimer.ElapsedMilliseconds > timeout
                  System.Threading.Thread.Sleep(0)
              Loop
              If CANPORT.rxDataReady = True Then
                  sendCommand = True 
          Loop Until sendCommand = True

