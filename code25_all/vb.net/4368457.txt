'Check subject line
If Me.txtSubject.TextLength > 0 And Me.txtSubject.Enabled = True Then
    Dim objWA As New Word.Application

    'objWA.Visible = False
    Dim objWD As Word.Document = objWA.Documents.Add
    'objWA.WindowState = Word.WdWindowState.wdWindowStateNormal
    Try
        With objWD
            .Range.Text = Me.txtSubject.Text
            .Activate()
            .CheckSpelling()
            .Content.Copy()

            If Clipboard.GetDataObject.GetDataPresent(DataFormats.Text) Then
                Me.txtSubject.Text = CType(Clipboard.GetDataObject.GetData(DataFormats.Text), String)
            End If

            .Saved = True
            objWA.Visible = False
            .Close(Word.WdSaveOptions.wdDoNotSaveChanges)
        End With

        'Application.DoEvents()
        objWA.Quit()
        objWA.Visible = False   'need this to get around the save prompt pop up

    Catch compEx As COMException
        MessageBox.Show("Microsoft Word must be installed for Spell Check to run.", "CustomerServiceTool", MessageBoxButtons.OK, MessageBoxIcon.Error)

    Catch ex As Exception
        If Err.Number = 5 Then  'bypass Clipboard operation failed errors
            objWA.Visible = False
            objWA.Quit()
        Else
            MessageBox.Show(Err.Description, "CustomerServiceTool", MessageBoxButtons.OK, MessageBoxIcon.Error)
        End If
    Finally
        objWD = Nothing
        objWA = Nothing
    End Try


End If

'Check Message body
If Me.txtResponse.Text.Length > 0 Then
    Dim objWA1 As New Word.Application
    ' Dim objWA1 As Word._Application
    ' objWA1 = New Word.Application

    objWA1.Visible = False
    Dim objWD1 As Word.Document = objWA1.Documents.Add

    Try
        objWD1.Activate()
        With objWD1
            .Range.Text = Me.txtResponse.Text

            .CheckSpelling()
            .Content.Copy()

            If Clipboard.GetDataObject.GetDataPresent(DataFormats.Text) Then
                Me.txtResponse.Text = CType(Clipboard.GetDataObject.GetData(DataFormats.Text), String)
            End If

            .Saved = True
            objWA1.Visible = False
            .Close(Word.WdSaveOptions.wdDoNotSaveChanges)
        End With


        'Application.DoEvents()
        objWA1.Quit()
        MessageBox.Show("The spelling check is complete.", "CustomerServiceTool", MessageBoxButtons.OK, MessageBoxIcon.Information)

    Catch compEx As COMException
        MessageBox.Show("Microsoft Word must be installed for Spell Check to run.", "CustomerServiceTool", MessageBoxButtons.OK, MessageBoxIcon.Error)

    Catch ex As Exception
        If Err.Number = 5 Then  'bypass Clipboard operation failed errors
            objWA1.Visible = False
            objWA1.Quit()
        Else
            MessageBox.Show(Err.Description, "ASHLinkCST", MessageBoxButtons.OK, MessageBoxIcon.Error)
        End If
    Finally
        objWD1 = Nothing
        objWA1 = Nothing
    End Try

End If

