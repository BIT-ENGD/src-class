id
layer
x
y
<ProtoContract()> _
Public Class StrippedElement
    <ProtoMember(1)> _
    Public Property X() As Integer
        Get
            Return m_X
        End Get
        Set(ByVal value As Integer)
            m_X = value
        End Set
    End Property
    Private m_X As Integer
    <ProtoMember(2)> _
    Public Property Y() As Integer
        Get
            Return m_Y
        End Get
        Set(ByVal value As Integer)
            m_Y = value
        End Set
    End Property
    Private m_Y As Integer
    <ProtoMember(3)> _
    Public Property Id() As Long
        Get
            Return m_Id
        End Get
        Set(ByVal value As Long)
            m_Id = value
        End Set
    End Property
    Private m_Id As Long
    <ProtoMember(4)> _
    Public Property Layer() As String
        Get
            Return m_Layer
        End Get
        Set(ByVal value As String)
            m_Layer = value
        End Set
    End Property
    Private m_Layer As String
End Class

    Public Shared Sub Save(ByVal File As String, ByVal Map As RedSimEngine.Map)
        Dim nPBL As New List(Of StrippedElement)
        For z As Integer = 0 To Grid.LAYERLIMIT
            For x As Integer = 0 To Grid.GRIDLIMIT
                For y As Integer = 0 To Grid.GRIDLIMIT
                    Dim currentCell As GridElement = Map.Level.getCell(z, x, y)
                    If currentCell IsNot Nothing Then
                        If currentCell.Archivable Then
                            Dim nStEl As New StrippedElement
                            nStEl.Id = currentCell.getId()
                            nStEl.Layer = currentCell.getLayer()
                            nStEl.X = currentCell.X
                            nStEl.Y = currentCell.Y
                            nPBL.Add(nStEl)
                        End If
                    End If
                Next
            Next
        Next
        Serializer.Serialize(New FileStream(File, FileMode.Create), nPBL)
    End Sub

    Public Shared Function Load(ByVal File As String) As RedSimEngine.Map
        Dim nMap As New Map
        Dim nListOfSE As List(Of StrippedElement) = Serializer.Deserialize(Of List(Of StrippedElement))(New FileStream(File, FileMode.Open))
        For Each elm As StrippedElement In nListOfSE
            Dim nElm As GridElement = GridElement.createElementByIdAndLayer(elm.Layer, elm.Id)
            nElm.X = elm.X
            nElm.Y = elm.Y
            nMap.Level.setCell(nElm)
        Next
        Return nMap
    End Function

X
Y
Value
Name
Value
Name
ENUMVALUE
X
Y
INTEGERVALUE
