Dim retObj As New ClassLibrary1.sql_class

 For Each row As DataRow In retObj.sel_all_email_list(company).tables(0).rows
    email += row("EMAIL_ADDRESS") & "/"
 Next

query = "SELECT * " _
           & " FROM EMAIL_LIST " _
           & " WHERE UCASE(COMPANY) = '" & company & "'"

 Dim adapter As New OleDbDataAdapter(query, myConnection)
 Dim ds As New DataSet

        Try
            myConnection.Open()
            adapter2.Fill(ds, "test_table")

        *returns the dataset, didnt want to type all of the code

        Catch ex As Exception

        Finally
            myConnection.Close()
        End Try  

'*****************************************************
Error:
Exception Details: System.IndexOutOfRangeException: Cannot find table 0.

