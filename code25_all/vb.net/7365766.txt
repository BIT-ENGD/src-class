    Public Sub Connect(Optional ByVal pHostName As String = "", Optional ByVal pPort As Integer = 0)
    If pHostName.Trim <> "" Then mHostName = pHostName
    If pPort > 0 Then mPort = pPort

    Try
        Dim ipep As IPEndPoint

        If IsIPAddress(mHostName) Then
            ipep = New IPEndPoint(IPAddress.Parse(mHostName), mPort)
        Else
            ipep = New IPEndPoint(IPAddress.Parse(Dns.GetHostEntry(mHostName).AddressList(0).ToString), mPort)
        End If
        mSocket = New Socket(AddressFamily.InterNetwork, SocketType.Stream, ProtocolType.Tcp)
        mSocket.Connect(CType(ipep, EndPoint))
        mState = eState.Connected
        RaiseEvent Connected()
        mDataTimer.Start()
    Catch ex As Exception
        Me.Close()
        Throw ex
    End Try
End Sub

Public Sub SendData(ByVal pBytes() As Byte)
    mSocket.Send(pBytes)
End Sub

Public Sub SendString(ByVal pString As String)
    Dim bytes() As Byte = System.Text.Encoding.UTF8.GetBytes(pString)
    mSocket.Send(bytes)
End Sub

