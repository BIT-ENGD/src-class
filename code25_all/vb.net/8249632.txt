Class Form1
Dim Network as NetworkModule

Public Sub Button1_Click(Sender, e) Handles Button1.Click
    Network = New NetworkModule("127.0.0.1", 1234)
End Sub
End Class 'Form1

Class NetworkModule
    Private mSocket as Socket

    Public Sub New(IP as string, Port as Integer)
        Dim remoteEP as New IPEndpoint(IP.Parse(IP), Port)
        mSocket = New Socket(internetwork, stream, tcp)
        mSocket.BeginConnect(remoteEP, New AsyncCallback(AddressOf onConnect), mSocket)
        Notify("Connection to " & remoteEP.ToString)  'This one works
     End Sub 'New

     Private Sub onConnect(ar as IAsyncResult)
         mSocket = CType(ar.AsyncState, Socket)
         mSocket.EndConnect(ar)
         Notify("Connected")  'This one never shows
     End Sub 'onConnect

    Private Delegate Sub _Notify(Msg as String)
    Private Sub Notify(Msg as String)
        If Form1.txtLog.InvokeRequired Then
            Form1.txtLog.Invoke(New _Notify(AddressOf Notify), Msg)
            Exit Sub
        End if
        Form1.txtLog.Text &= Msg & vbcrlf
    End Sub 'Notify
End Class 'NetworkModule

