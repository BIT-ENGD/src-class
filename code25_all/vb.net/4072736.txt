    Try

        Dim thisListener As Socket = CType(ar.AsyncState, Socket)

        Dim handler As Socket = thisListener.EndAccept(ar)

        Dim remoteEndPoint As IPEndPoint

        remoteEndPoint = handler.RemoteEndPoint

        thisListener.Listen(10)

        thisListener.BeginAccept(New AsyncCallback(AddressOf connectionRequest), thisListener)

        thisListener.NoDelay = True

        thisListener.Ttl = 32

        Dim state As New StateObject

        state.workSocket = handler

        handler.BeginReceive(state.buffer, 0, StateObject.BufferSize, 0, New AsyncCallback(AddressOf dataArrival), state)

        handler.NoDelay = True

    Catch ex As Exception

    End Try

End Sub

