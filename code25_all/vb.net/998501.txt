Public Class SQLApplicationExceptionProvider
Inherits System.Web.Management.BufferedWebEventProvider
    Public Overrides Sub Initialize(ByVal name As String, ByVal config As System.Collections.Specialized.NameValueCollection)
        MyBase.Initialize(name, config)
    End Sub
    Public Overrides Sub ProcessEvent(ByVal eventRaised As System.Web.Management.WebBaseEvent)
        MyBase.ProcessEvent(eventRaised)
    End Sub
    Public Overrides Sub ProcessEventFlush(ByVal flushInfo As System.Web.Management.WebEventBufferFlushInfo)
    End Sub
    Public Overrides Sub Shutdown()
        Me.Flush()
    End Sub
End Class

<healthMonitoring enabled="true" heartbeatInterval="100" >
    <providers>
        <add name="DBSExceptionProvider" type="SQLApplicationExceptionProvider"
            buffer="true" bufferMode="RegularNotification" />
    </providers>
    <rules>
        <add name="DBSErrors" eventName="All Errors" provider="DBSExceptionProvider"
            profile="Critical" />
    </rules>
    <bufferModes>
        <add name="RegularNotification" maxBufferSize="10" maxFlushSize="5"
            urgentFlushThreshold="2" regularFlushInterval="Infinite"
            urgentFlushInterval="00:00:30" />
    </bufferModes>
    <profiles>
        <add name="Default" minInstances="1" maxLimit="Infinite" minInterval="00:01:00" />
        <add name="Critical" minInstances="1" maxLimit="Infinite" minInterval="00:00:00" />
    </profiles>
</healthMonitoring>

