Protected Sub editUser(ByVal sender As Object, ByVal e As System.Web.UI.WebControls.GridViewEditEventArgs)
        'set selected user from gridview.
        Dim index As Integer = e.NewEditIndex
        Dim userId As Integer = gvListUsers.DataKeys(index).Value
        Session.Item("SelectedUserId") = userId

        'show edit page, hide list and add page.
        With Page.Form.Controls(1)
            .Controls(getControlId("loadAddUser")).Visible = False
            .Controls(getControlId("loadEditUser")).Visible = True
            .Controls(getControlId("loadListUser")).Visible = False
        End With
    End Sub

Public Function getControlId(ByVal control As String) As Integer
        Dim enumer As System.Collections.IEnumerator = Page.Form.Controls.Item(1).Controls.GetEnumerator
        Dim i As Integer

        For i = 0 To (Page.Form.Controls.Item(1).Controls.Count - 1)
            If Page.Form.Controls(1).Controls.Item(i).ID = control Then
                Return i
            End If
        Next
        Return Nothing
    End Function

