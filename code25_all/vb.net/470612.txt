 DisplayString(
  StringID nvarchar(255)
  ,CultureCode varchar(25)
  ,DisplayString nvarchar(255)
 )

Dim context As New LinqTableMappingDataContext(
  My.Settings.LocalizationStringsConnectionString)

Dim arr As String() = 
  {"aaaaa",  "adsfs", "wefwf", "dfgsfg", "ergsdfg", 
   "fsdgergd", "Sdgdfgegd", "ergdfgsfd"}

  For Each a As String In arr
     addToLinq(a)
  Next

"WARNING: This computer program is protected by copyright law and international
treaties. Unauthorized reproduction of this program, or any portion of it, may
result in severe civil and criminal penalties, and will be prosecuted to the
maximum extent possible under the law."

Private Sub AddToLinq(ByVal stringID As String)

  Dim f As New DisplayString
  Try

     Dim count As Integer = (From str In context.DisplayStrings _
       Where str.StringID = stringID Select str).Count

     If count = 0 Then

        f.StringID = stringID
        f.CultureCode = "en-US"
        f.DisplayString = stringID

        context.DisplayStrings.InsertOnSubmit(f)
        context.SubmitChanges()
        Console.WriteLine("SUBMITTED: " & stringID)
    End If

  Catch ex1 As SqlException
     Console.WriteLine("------------------------------------------------")
     Console.WriteLine("EXCEPTION: " & ex1.Message)
     Console.WriteLine(stringID)
     Console.WriteLine(stringID.Length)
     Console.WriteLine("------------------------------------------------")

  Catch ex As DuplicateKeyException
     Console.WriteLine(ex.Message)

  End Try
End Sub

