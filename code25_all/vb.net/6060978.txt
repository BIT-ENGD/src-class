Dim de As New DirectoryEntry()
    'Name place to write file to
    Dim strFile As String = "C:\DomainUsers.txt"
    Dim fileExists As Boolean = File.Exists(strFile)

    'get list of all users on domain and write to file
    de.Path = "WinNT://domain.com"
    'Write each user to a text file as List
    Using sw As New StreamWriter(File.Open(strFile, FileMode.OpenOrCreate))
        MsgBox("Writing all Users to Memory, Click OK and wait for Window to Close")
        For Each d As DirectoryEntry In de.Children()
            sw.WriteLine(d.Name)
        Next
        Console.Clear()
    End Using

    'Reopen File and read each line
    'Return List of Processes for each User in Overwritefashion to New Version of File
    Using sr As New StreamReader(File.Open(strFile, FileMode.Open))
        Dim InstalledServices As List(Of String) = GetInstalledServices(sr.ReadLine.Trim)
    End Using

End Sub

'Lost as to how to go about using this function...
Function GetInstalledServices(ByVal Computer As String) As List(Of String)

End Function

