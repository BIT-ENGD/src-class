Imports System.IO

Module Module1

 Private Property fs As Object
 Private Property BaseName As Object
 Private Property FullTargetPath As Object

Sub Main()

    Dim targetfolder As String = "C:\TEST"
    Dim sourcefolder As String = "\\10.97.8.16\c$\Checks\XMLFiles"
    Dim Searchpattern As String = String.Format("{0:MM-dd-yyyy}*.xml", Date.Today)
    Dim todaysfiles() As String = Directory.GetFiles(sourcefolder, Searchpattern)
    Dim xlApp, xlWkb
    xlApp = CreateObject("excel.application")
    fs = CreateObject("Scripting.FileSystemObject")
    Const xlnormal = 1

    'Extra Dims


    'Hide Excel
    xlApp.Visible = False

    For Each file As String In todaysfiles
        ' Excel stuff... ' 

        Dim fileName As String = IO.Path.GetFileNameWithoutExtension(file)

        ' Concatenate full path. Extension will be automatically added by Excel. ' 
        Dim fullTargetPath = IO.Path.Combine(targetfolder, fileName)

        'Process each file in SourceFolder
        ' For Each file In fs.GetFolder(SourceFolder).files
        'Open file in SourceFolder
        xlWkb = xlApp.Workbooks.Open(file)
        'Get Filename
        BaseName = fs.getbasename(file)
        'Concatenate full path. Extension will be automatically added by Excel
        fullTargetPath = targetfolder & "\" & BaseName
        'Save as XLS file into TargetFolder
        xlWkb.SaveAs(fullTargetPath, xlnormal)

        'Close the file after its done
        xlWkb.close()
    Next

    xlWkb = Nothing
    xlApp = Nothing
    fs = Nothing

    ' MsgBox("Thank you. Currently the Date is: " & Date.Today & " people like to eat chicken Every " & Date.Today.Ticks & " minutes.")


    'This is for extra code below

End Sub

