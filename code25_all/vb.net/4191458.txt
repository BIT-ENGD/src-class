Protected Overloads Sub Application_BeginRequest(ByVal sender As Object, ByVal e As System.EventArgs)

        Dim CurrentPath As String = Request.Path.ToLower()
        Dim strPageName As String = CurrentPath.Substring(CurrentPath.LastIndexOf("/") + 1, (CurrentPath.LastIndexOf(".") - CurrentPath.LastIndexOf("/")) + 4)

        If strPageName.EndsWith(".html") Then
            Select Case strPageName
                Case "index.html"
                    RewriteUrl(CurrentPath)
            End Select
        End If
End Sub

Protected Sub RewriteUrl(ByVal URL As String)
    Dim CurrentPath As String = URL
    CurrentPath = CurrentPath.Replace(".html", ".aspx")
    Dim MyContext As HttpContext = HttpContext.Current
    MyContext.RewritePath(CurrentPath)
End Sub

Sub Application_Start(ByVal sender As Object, ByVal e As EventArgs)
    RegisterRoutes(RouteTable.Routes)
End Sub

Shared Sub RegisterRoutes(ByVal routes As RouteCollection)
    routes.Add("Index", New Route _
    ( _
       "index.html", New CustomRouteHandler("~/index.aspx") _
    ))
End Sub

