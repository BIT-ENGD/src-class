Imports System.Web.Services
Imports System.Web.Services.Protocols    
Imports System.ComponentModel

' To allow this Web Service to be called from script, using ASP.NET AJAX, uncomment the following line.
' <System.Web.Script.Services.ScriptService()> _
<System.Web.Services.WebService()> _
<System.Web.Services.WebServiceBinding(ConformsTo:=WsiProfiles.BasicProfile1_1)> _
<ToolboxItem(False)> _
Public Class DemoService
    Inherits System.Web.Services.WebService

       <WebMethod()> _
    Public Function XMLReceiver(ByVal XMLData As String) As Integer
        Dim retval As Integer = Validate(XMLData)
        Dim thrd As New Threading.Thread(AddressOf Process)
        thrd.Start()
        Return retval
    End Function

    Public Function Validate(ByVal XMLData As String) As Integer
        Return 0
    End Function

    Public Sub Process()
        'get time
        Dim start As Date = Date.Now
        'do work
        Threading.Thread.Sleep(1000 * 10)
        'notification (actually write to DB)
        Dim writer As New IO.StreamWriter("C:\done.txt")
        writer.WriteLine("From " & start.ToLongTimeString & " To " & Date.Now.ToLongTimeString & " done!")
        writer.Close()
    End Sub
End Class

