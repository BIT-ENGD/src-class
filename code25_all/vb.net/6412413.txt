Function create_hash(ByVal password, ByVal salt)

        Dim input As [Char]() = "string to hash".ToCharArray()
        Dim secret As New SecureString()


        For idx As Integer = 0 To input.Length - 1
            secret.AppendChar(input(idx))
        Next SecurePassword.MakeReadOnly()

        Dim pBStr As IntPtr = Marshal.SecureStringToBSTR(secret)
        Dim output As String = Marshal.PtrToStringBSTR(pBStr)
        Marshal.FreeBSTR(pBStr)
        Dim sha As SHA512 = New SHA512Managed()
        Dim result As Byte() = sha.ComputeHash(Encoding.UTF8.GetBytes(output))



        Return result
    End Function

