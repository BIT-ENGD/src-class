Try
  Using mgr As New ServerManager()
    Dim site As Site = mgr.Sites(DomainName)
    Dim app As Application = site.Applications("/") '.CreateElement() '("/" & VirDirName)
    Dim VirDir As VirtualDirectory = app.VirtualDirectories.CreateElement()
         For Each VirDir In app.VirtualDirectories
              If VirDir("path") = "/" & VirDirName Then
                    app.VirtualDirectories.Remove(VirDir)
                    Exit For
              End If
         Next
         mgr.CommitChanges()
  End Using
 Catch Err As Exception
      Ex = Err
      Throw New Exception(Err.Message, Ex)
 End Try

