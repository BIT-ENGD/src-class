'Override server certificate callback
    Dim oCertOverride As New CertificateOverride
    ServicePointManager.ServerCertificateValidationCallback = _
             AddressOf oCertOverride.RemoteCertificateValidationCallback

    'Set WS binding
    Dim binding As WSHttpBinding = New WSHttpBinding
    binding.Security.Mode = SecurityMode.Transport
    binding.Security.Transport.ClientCredentialType = _
            HttpClientCredentialType.Certificate

    'Set endpoint address
    Dim address As EndpointAddress = _
         New EndpointAddress("https://webservice-url?WSDL")

    'Create web service client
    Dim ws As wsclient = New wsclient(binding, address)

    'Set web service client certificate
    ws.ClientCredentials.ClientCertificate.SetCertificate(StoreLocation.CurrentUser, _
               StoreName.My, X509FindType.FindBySubjectName, "cert-subject-name")

    'Set username and password for server authentication
    ws.ClientCredentials.UserName.UserName = "username"
    ws.ClientCredentials.UserName.Password = "password"

    'Make test call to web service
    ws.HelloWord()

