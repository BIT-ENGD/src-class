Private Sub DataGridView1_DragDrop(ByVal sender As System.Object, 
ByVal e As System.Windows.Forms.DragEventArgs) Handles DataGridView1.DragDrop

Dim filenames As String() = DirectCast(e.Data.GetData(DataFormats.FileDrop), String())

    For Each File In filenames
        If Array.IndexOf(SupportedFormats, System.IO.Path.GetExtension(File)) <> -1 Then
            Frm = New FormRestore(ServerName, File)
            Frm.Show()

            While Frm.Visible
                Application.DoEvents()
            End While

        End If
    Next

End Sub

