Imports System.Collections.ObjectModel

Class MainWindow

Dim ServerInfoArray As ObservableCollection(Of ServerInfo) = New ObservableCollection(Of ServerInfo)

Private ReadOnly _ipAddresses As ObservableCollection(Of String) = New ObservableCollection(Of String)


Private Sub GetInfo(ByVal list As List(Of String))
    For Each server As String In list

        Dim tempip As List(Of String) = New List(Of String)
        Dim sinfo As ServerInfo = New ServerInfo

        tempip.Add("192.129.123.23")
        tempip.Add("23.213.223.21")

        sinfo.IPArray = tempip
        sinfo.Servername = server

        ServerInfoArray.Add(sinfo)

    Next
End Sub

Private Sub Button1_Click(sender As System.Object, e As System.Windows.RoutedEventArgs) Handles Button1.Click

    Dim serverlist As List(Of String) = New List(Of String)
    serverlist.Add("Test")
    serverlist.Add("Random")
    serverlist.Add("Local")
    GetInfo(serverlist)

End Sub

Private Sub Window_Loaded(sender As System.Object, e As System.Windows.RoutedEventArgs) Handles MyBase.Loaded
    Dim Col_Serial As DataGridTextColumn = New DataGridTextColumn()
    Col_Serial.Binding = New Binding("Servername")
    Col_Serial.Header = "Servername"
    Col_Serial.Width = 40

    Dim Col_IPArray = New DataGridComboBoxColumn()
    Col_IPArray.Header = "IP Addresses"
    Col_IPArray.IsReadOnly = True
    Col_IPArray.ItemsSource = Me._ipAddresses
    Col_IPArray.SelectedItemBinding = New Binding("IPArray")

    DataGrid1.Columns.Add(Col_Serial)
    DataGrid1.Columns.Add(Col_IPArray)
    DataGrid1.ItemsSource = ServerInfoArray
End Sub
End Class

Class ServerInfo

Dim _Servername As String
Dim _IPArray As List(Of String)

Public Property Servername() As String
    Get
        Return _Servername
    End Get
    Set(ByVal value As String)
        _Servername = value
    End Set
End Property

Public Property IPArray As List(Of String)
    Get
        Return _IPArray
    End Get
    Set(ByVal value As List(Of String))
        _IPArray = value
    End Set
End Property

Public Sub New()
    _Servername = Nothing
    _IPArray = New List(Of String)
End Sub

