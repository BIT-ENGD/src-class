Dim objExcel As Microsoft.Office.Interop.Excel.Application
Dim objWorkBook As Microsoft.Office.Interop.Excel.Workbook
Dim totalWorkSheets As Microsoft.Office.Interop.Excel.Worksheet

Public Sub PrintByName(ByVal s As Worksheet)


    Dim myprinter As String
    Dim printer_name As String
    printer_name = "PDF995"


    If System.IO.Directory.Exists("D:\" + objWorkBook.Name) Then
    Else
        System.IO.Directory.CreateDirectory("D:\" + objWorkBook.Name)
    End If

    myprinter = objExcel.ActivePrinter
    objExcel.ActivePrinter = printer_name
    Thread.Sleep(1000)
    s.PrintOut(Preview:=False, ActivePrinter:=printer_name, PrintToFile:=True,PrToFileName:=s.Name) 
    System.Threading.Thread.Sleep(2500)
    objExcel.ActivePrinter = myprinter
End Sub

