Option Strict On
Option Explicit On

Partial Public Class gallery_oct07

    '''<summary>
    '''Gallery1 control.
    '''</summary>
    '''<remarks>
    '''Auto-generated field.
    '''To modify move field declaration from designer file to code-behind file.
    '''</remarks>
    Protected WithEvents Gallery1 As Global.Gallery
End Class

Partial Class gallery_oct07
    Inherits System.Web.UI.Page

End Class

<%@ page language="VB" masterpagefile="~/MasterPage.master" autoeventwireup="false" inherits="WebApplication1.gallery_oct07" title="2007 Trip Photos" Codebehind="~/gallery_oct07.aspx.vb" %>

<%@ Register Src="Gallery.ascx" TagName="Gallery" TagPrefix="uc1" %>

<asp:Content ID="Content1" ContentPlaceHolderID="ContentPlaceHolder1" runat="Server">
<script language="javascript" type="text/javascript" src="js/jquery-1.3.2.min.js"></script>
<script language="javascript" type="text/javascript" src="js/thickbox.js"></script>
    <p class="title">
        Koru Care Christchurch Charitable Trust</p>
    <img src="images/green_space.gif" />
    <p class="title">
        Trip Photos</p>
    <p class="subTitle">
        Los Angeles 2007</p>
    <p class="text">
        Click for larger Image</p>
    <uc1:Gallery ID="Gallery1" runat="server" ImageFolder="images/oct2007/"  />    
</asp:Content>

<%@ Control Language="C#" AutoEventWireup="true" Codebehind="Gallery.ascx.cs" Inherits="WebApplication1.Gallery"%>

<asp:Repeater runat="server" ID="rptGallery">
    <HeaderTemplate>
        <ul class='<%#CssClass%>'>
    </HeaderTemplate>
    <ItemTemplate>
        <li><a href='<%#ImageFolder + Eval("Name") %>' class="thickbox" rel="gallery"><img src='<%#ImageFolder + "thumb/" + Eval("Name") %>' /></a></li>
            </ItemTemplate>
    <FooterTemplate>
        </ul></FooterTemplate>
</asp:Repeater>

using System;
using System.IO;

namespace WebApplication1
{
    public partial class Gallery : System.Web.UI.UserControl
    {
        public string _ImageFolder;
        public string ImageFolder
        {
            get
            {
                return _ImageFolder;
            }
            set
            {
                _ImageFolder = value;
            }
        }

        private string _cssClass = "gallery";

        public string CssClass
        {
            get
            {
                return _cssClass;
            }
            set
            {
                _cssClass = value;
            }
        }

        protected void Page_Load(object sender, EventArgs e)
        {

            DirectoryInfo dir = new DirectoryInfo(MapPath(ImageFolder));
            FileInfo[] images = dir.GetFiles("*.jpg");

            rptGallery.DataSource = images;
            rptGallery.DataBind();

        }

        protected void Page_PreRender(object sender, EventArgs e)
        {

        }
    }
}

