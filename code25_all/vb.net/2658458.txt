Sub GetPic()


        '------- Connect to Server
        ClientSocket = New Socket(AddressFamily.InterNetwork, SocketType.Stream, _ ProtocolType.Tcp)
        ClientSocket.Connect(Epoint)

        '------- Send Picture Request
        Dim Bytes() As Byte = System.Text.ASCIIEncoding.ASCII.GetBytes("Send Picture")
        ClientSocket.Send(Bytes, Bytes.Length, SocketFlags.None)

        '------- Receive Response
        Dim RecvBuffer(20000) As Byte
        Dim Numbytes As Integer

        Numbytes = ClientSocket.Receive(RecvBuffer)

        Dim Darray(Numbytes) As Byte
        Buffer.BlockCopy(RecvBuffer, 0, Darray, 0, Numbytes)

        '------- Close Connection
        ClientSocket.Shutdown(SocketShutdown.Both)
        ClientSocket.Close()

        '-------
        Dim MStrm = New MemoryStream(Darray)
        Picture = Image.FromStream(MStrm)


End Sub

'Threaded from a listener


    Sub ClientThread(ByVal Client As TcpClient)

        Dim MStrm As New MemoryStream
        Dim Rbuffer(1024) As Byte
        Dim Tbyte As Byte()
        Dim NStrm As NetworkStream = Client.GetStream()

        Dim I As Integer = NStrm.Read(Rbuffer, 0, Rbuffer.Length)
        Dim Incoming As String = System.Text.Encoding.ASCII.GetString(Rbuffer, 0, I)

        If Incoming = "Send Picture" then
                    Picture Save(MStrm, Picture.RawFormat)
                    Tbyte = MStrm.ToArray
                    NStrm.Write(Tbyte, 0, Tbyte.Length)
              End if

        Client.Close()

End Sub

