Dim token1 As Integer

Dim loggedOn As Boolean = LogonUser("scotts", "MyDomain", "AwesomePw", 3, 0, token1)

Dim mWI1 As WindowsIdentity = WindowsIdentity.GetCurrent()

Dim token2 As IntPtr = New IntPtr(token1)

Dim mWI2 As WindowsIdentity = New WindowsIdentity(token2)

'This file copies a file successfully
File.Copy("c:\LogExtractorRecipients.txt", "\\RemoteServer\SHARED\QALogFiles\LogExtractorRecipients2.txt")

Dim mWIC As WindowsImpersonationContext = mWI2.Impersonate()

'This causes the error: "Access to the path '\\RemoteServer\SHARED\QALogFiles\QALogFiles\LogExtractorRecipients.txt' is denied."
File.Copy("c:\LogExtractorRecipients.txt", "\\RemoteServer\SHARED\QALogFiles\QALogFiles\LogExtractorRecipients.txt")

