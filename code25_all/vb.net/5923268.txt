DoTest()  
  dim j as datacontext
  dim recs = from myrecs in j.mythings select myrecs where myrecs.key="key1" or  
  myrecs.key = "key2"
  if recs.count > 0
    for each rec in myrecs
      j.mythings.deleteonsubmit(rec)
    next
    j.submitchanges()
   end if
  j.dispose


  dim tc as new tablecontroller()  
  tc.addrecordtomytable("key1","value1")  
  tc.addrecordtomytable("key2","value2")  
end  

Class tablecontroller

Sub addrecordstomytable(key as string, value as string)
   dim j as new mydatacontext
   dim thing as new mything
   thing.key = key
   thing.value = value
   j.mythings.addonsubmit(thing)
   j.submitchanges
   j.dispose

