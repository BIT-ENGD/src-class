import flash.net.Socket


var socket = new Socket("localhost",8888);
socket.connect();
socket.addEventListener(Event.CONNECT, connectHandler);
socket.addEventListener(ProgressEvent.SOCKET_DATA, socketDataHandler);


function connectHandler(evt:Event) {
    trace("connectHandler: " + evt);
}

function socketDataHandler(evt:ProgressEvent) {
trace("socketDataHandler: " + evt);
}

While True

            Dim netStream As NetworkStream = Me._socket.GetStream

            Dim bytes(1) As Byte

            Dim file As New FileInfo("so-deep.ram2000.mp3")
            Dim inputStream As Stream = file.OpenRead
            Dim length As Integer = file.Length
            'Dim os As New System.IO.FileStream(file.FullName, IO.FileMode.Create)

            Dim bb As Byte
            While length > 0 AndAlso inputStream.Read(bytes, 0, bytes.Length) > -1

                netStream.Write(bytes, 0, bytes.Length)

                length -= bytes.Length

            End While



        End While

