Private Sub CreateTabs()
    Dim SQLconnect As New SQLite.SQLiteConnection()
    Dim SQLcommand As SQLiteCommand
    SQLconnect.ConnectionString = "Data Source=" & sPath & "\dock.db;"
    SQLconnect.Open()
    SQLcommand = SQLconnect.CreateCommand
    SQLcommand.CommandText = "SELECT title FROM tabs"
    Dim SQLreader As SQLiteDataReader = SQLcommand.ExecuteReader()
    Dim Tabs(25) As String
    Dim c As Integer = 1
    While SQLreader.Read()
        Tabs(c) = SQLreader(0)
        c = c + 1
    End While
    SQLcommand.Dispose()
    SQLconnect.Close()
    For i = 1 To UBound(Tabs)
        If Tabs(i) <> "" Then
            Launcher.TabPages.Add(Tabs(i))
            CreateButtons(Tabs(i))
        End If
    Next
End Sub

Private Sub CreateButtons(ByVal tab)
    Dim SQLconnect As New SQLite.SQLiteConnection()
    Dim SQLcommand As SQLiteCommand
    SQLconnect.ConnectionString = "Data Source=" & sPath & "\dock.db;"
    SQLconnect.Open()
    SQLcommand = SQLconnect.CreateCommand
    SQLcommand.CommandText = "SELECT id,name,path FROM buttons WHERE tab = '" & tab & "'"
    Dim SQLreader As SQLiteDataReader = SQLcommand.ExecuteReader()
    While SQLreader.Read()
        For i = 1 To 9
            Dim NewButton(i) As Button
            If Not SQLreader(2) Is System.DBNull.Value Then
                Dim myIcon As System.Drawing.Icon = Icon.ExtractAssociatedIcon(SQLreader(2))
            End If
            Dim toolTip1 As ToolTip = New System.Windows.Forms.ToolTip(Me.components)
            Me.Controls(tab).tabpages.add(NewButton(i)) '<--this causes my problem
            'NewButton(i).Width = 32
            'NewButton(i).Height = 32
            'NewButton(i).Text = i
            'NewButton(i).Image = myIcon.ToBitmap
            'If Not SQLreader(1) Is System.DBNull.Value Then
            'toolTip1.SetToolTip(NewButton(i), SQLreader(1))
            'toolTip1.Active = True
            'End If
        Next
    End While
    SQLcommand.Dispose()
    SQLconnect.Close()
End Sub

