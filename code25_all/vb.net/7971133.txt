<Document type="ContentPage">
<Fields>
    <Field name="FaqCategory" type="dropdown" title="Select Category:" index="FaqCategory" list="\Lists\FaqCategory" required="true">
        Online Experience
    </Field>
    <Field name="FaqSubCategory" type="dropdown" title="Select Sub Category" list="\Lists\FaqSubCategory" required="true">
        Using the site
    </Field>
    <Field name="FaqQuestion" type="text" title="Enter FAQ Question:" required="true">
        How do I find articles on the site?
    </Field>
    <Field name="FaqAnswer" type="richtext" title="Enter FAQ Answer:" editorProfile="Advanced" required="true">
        Answer to: How do I find articles on the site?
    </Field>
</Fields>
<Placeholders />
<Indexes />

    Protected Sub getFaqData(ByVal DocArray() As CMSWS.CMSDocumentRecord)
    Dim mainFaqCategoryItem As String = ""
    Dim mainCategoryList As New List(Of String)
    For Each Doc As CMSWS.CMSDocumentRecord In DocArray
        xml.LoadXml(Doc.Xml)
        Try
            mainFaqCategoryItem = CType(xml.SelectSingleNode("//Fields/Field[@name='FaqCategory']").InnerText, String)
            If Not mainCategoryList.Contains(mainFaqCategoryItem) Then
                mainCategoryList.Add(mainFaqCategoryItem)
            End If
        Catch ex As Exception
            Response.Write("ERROR getting the main category")
        End Try
    Next

    For Each item In mainCategoryList
        outputsubs(item, DocArray)
    Next
End Sub

    Protected Sub outputsubs(ByVal item As String, ByVal DocArray() As CMSWS.CMSDocumentRecord)
    Dim subFaqCategoryItem As String = ""
    Dim subcategoryList As New List(Of String)
    'Add the main Category to the HTML output:
    lblFaq.Text = lblFaq.Text & "<h1>" & item & "</h1>"

    For Each Doc As CMSWS.CMSDocumentRecord In DocArray
        xml.LoadXml(Doc.Xml)
        Try
            'If xml.SelectSingleNode("//Fields/Field[@name='FaqCategory']").InnerText = item Then
            subFaqCategoryItem = CType(xml.SelectSingleNode("//Fields/Field[@name='FaqCategory']").InnerText, String)
            If Not subcategoryList.Contains(subFaqCategoryItem) Then
                subcategoryList.Add(subFaqCategoryItem)
            End If
            'End If

        Catch ex As Exception
            Response.Write("ERROR getting the main category")
        End Try
    Next
    For Each subItem In subcategoryList
        lblFaq.Text += "<h2><a name=""subCategory"" style=""text-decoration:none;""><span class=""FAQPlusMinus""> + </span>" & subItem & "</a></h2>"
    Next
End Sub

