Private Function get_number_of_bits() As Integer
    Dim bits As Integer

    If listVersion.Value < 10 Then
        If get_binary_mode(listMode.SelectedItem) = "0001" Then
            bits = 10
        End If
        If get_binary_mode(listMode.SelectedItem) = "0010" Then
            bits = 9
        End If
        If get_binary_mode(listMode.SelectedItem) = "0100" Or _
           get_binary_mode(listMode.SelectedItem) = "1000" Then
            bits = 8
        End If
    ElseIf listVersion.Value < 27 Then
        If get_binary_mode(listMode.SelectedItem) = "0001" Then
            bits = 12
        End If
        If get_binary_mode(listMode.SelectedItem) = "0010" Then
            bits = 11
        End If
        If get_binary_mode(listMode.SelectedItem) = "0100" Then
            bits = 16
        End If
        If get_binary_mode(listMode.SelectedItem) = "1000" Then
            bits = 10
        End If
    Else
        If get_binary_mode(listMode.SelectedItem) = "0001" Then
            bits = 14
        End If
        If get_binary_mode(listMode.SelectedItem) = "0010" Then
            bits = 13
        End If
        If get_binary_mode(listMode.SelectedItem) = "0100" Then
            bits = 16
        End If
        If get_binary_mode(listMode.SelectedItem) = "1000" Then
            bits = 12
        End If
    End If

    Return bits
End Function

Private Function get_encoding_modes() As Dictionary(Of String, String)
    Dim modes As New Dictionary(Of String, String)
    modes.Add("0000", "<Auto select>")
    modes.Add("0001", "Numeric (max. 7089 chars)")
    modes.Add("0010", "Alphanumeric (max. 4296 chars)")
    modes.Add("0100", "Binary [8 bits] (max. 2953 chars)")
    modes.Add("1000", "Kanji/Kana (max. 1817 chars)")

    Return modes
End Function

Private Function get_binary_mode(ByVal mode As String) As String
    Dim modes As New Dictionary(Of String, String)
    modes = get_encoding_modes()

    Dim result As String = ""

    Dim pair As KeyValuePair(Of String, String)
    For Each pair In modes
        If pair.Value = mode Then
            result = pair.Key
        End If
    Next

    Return result
End Function

