"SELECT ID,strForenames,strSurname FROM tblAlumni"
"SELECT strForenames,strSurname FROM tblAlumni"
Imports System.Data.SqlClient
Imports System.Windows.Forms
Imports System

Public Class Form1
    Inherits System.Windows.Forms.Form

Dim sqlConn As SqlConnection

Private Sub Form1_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
    loadGRID()
End Sub

Private Sub loadGRID()
    Dim sqlConn As SqlConnection = New SqlConnection("Data Source=.\sqlexpress;Initial Catalog=aspnetdb;Integrated Security=True")
    sqlConn.Open()
    Dim dataAdapter As SqlDataAdapter = New SqlDataAdapter("SELECT " & IIf(CheckBox1.Checked, "ID,", "") & "strForenames,strSurname FROM tblAlumni", sqlConn)
    Dim ds As DataSet = New DataSet()
    dataAdapter.Fill(ds)
    dgvTest.DataSource = ds.Tables(0)
    sqlConn.Close()
End Sub

Private Sub CheckBox1_CheckedChanged(ByVal sender As Object, ByVal e As System.EventArgs) Handles CheckBox1.CheckedChanged
    loadGRID()
End Sub
End Class

    dgvTest.DataSource = Nothing
    dgvTest.Refresh()

