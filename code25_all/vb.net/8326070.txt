Throw New Win32Exception("SetupAPI error: " & DirectCast(err, SetupApiError).ToString)

Dim result As Boolean = SetupDiSetClassInstallParams(handle, diData, params, Marshal.SizeOf(params))
    If result = False Then Throw New Win32Exception
    result = SetupDiCallClassInstaller(DiFunction.PropertyChange, handle, diData)
    If result = False Then
        Dim err As Integer = Marshal.GetLastWin32Error
        Select Case err
            Case Is = SetupApiError.NotDisableable
                Throw New ArgumentException("That device can't be disabled! Look in the device manager!")
            Case SetupApiError.NoAssociatedClass To SetupApiError.OnlyValidateViaAuthenticode
                Throw New Win32Exception("SetupAPI error: " & DirectCast(err, SetupApiError).ToString)
            Case Else
                Throw New Win32Exception
        End Select
    End If

