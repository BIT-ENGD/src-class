     Private Sub RecordingWindow_Load(sender As Object, e As System.EventArgs) Handles Me.Load
            AddHandler SystemEvents.UserPreferenceChanged, AddressOf UserPreferenceChangedHandler
     End Sub

    Protected Overrides Sub WndProc(ByRef m As System.Windows.Forms.Message)

    If m.Msg = WM_MOVING Then
        ' Console.WriteLine("Window is moving")
        WindowLocBeforThemeChanged = Me.Location
    End If
    MyBase.WndProc(m)

    End Sub

    Private Sub UserPreferenceChangedHandler(ByVal sender As Object, ByVal e As   UserPreferenceChangedEventArgs)

    Select Case e.Category
        Case UserPreferenceCategory.VisualStyle
             Me.Location = _windowLocBeforThemeChanged
    End Select

    End Sub

     Private Sub RecordingWindow_LocationChanged(sender As System.Object, e As System.EventArgs) Handles MyBase.LocationChanged
         _windowLocBeforThemeChanged = Me.Location
     End Sub

