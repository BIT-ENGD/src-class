Dim mail As New MailMessage()

 mail.From = New MailAddress("me@mycompany.com")
 mail.To.Add("tom@myaddress.com")

 mail.Subject = "This is an email"

 mail.IsBodyHtml = True
 mail.Priority = MailPriority.Normal

 Dim plainView As AlternateView = AlternateView.CreateAlternateViewFromString("This is my plain text content, viewable by those clients that don't support html", Nothing, "text/plain")

 Dim logo As New LinkedResource(Server.MapPath("images1/links/beach-icon.jpg"))

 logo.ContentId = "embeddedimage"

 Dim htmlView As AlternateView = AlternateView.CreateAlternateViewFromString("<p>Here is an embedded image.</p> <p><img alt='' hspace='0' src='cid:embeddedimage' align='baseline' border='0' ></p> <p>It's pretty awesome</p>", Nothing, "text/html")

 htmlView.LinkedResources.Add(logo)

 mail.AlternateViews.Add(plainView)
 mail.AlternateViews.Add(htmlView)

 Dim smtp As New SmtpClient("localhost") 'specify the mail server address
 smtp.Send(mail)

