Public MustInherit Class EntityBase
    MustOverride Property id() As Integer
End Class

Public MustInherit Class RepositoryBase(Of T As EntityBase)
    Protected _Db As New DataClasses1DataContext

    Public Function GetById(ByVal Id As Integer) As T
        Return (From a In _Db.GetTable(Of T)() Where a.id = Id).SingleOrDefault
    End Function
End Class

Partial Public Class Entity1
    Inherits EntityBase

End Class

Public Class TestRepository
    Inherits RepositoryBase(Of Entity1)
End Class

Return (From a In _Db.GetTable(Of T)() Where a.id = Id).SingleOrDefault

