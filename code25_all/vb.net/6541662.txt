Imports System.Data.SqlClient

Public Class Form1

    Dim rcount As Integer
    Dim conn As New ADODB.Connection
    Dim rcset As New ADODB.Recordset
    Dim sqlStr As String

    Public Sub openConn()
        Dim strConnect As String
        strConnect = "DRIVER={Microsoft Access Driver (*.mdb)}; DefaultDir=" & Application.StartupPath & ";DBQ=atg;UID=;PWD=;"
        If conn.State = 0 Then
            conn.ConnectionString = strConnect
            conn.Open()
        End If
    End Sub

    Private Sub Form1_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load
    End Sub

    Public Sub rcdSet(ByVal sqlStr As String)
        If conn.State = 0 Then
            Call openConn()
        End If
        If rcset.State = 1 Then
            rcset.Close()
            rcset = Nothing
            rcset = New ADODB.Recordset
            rcset.CursorLocation = ADODB.CursorLocationEnum.adUseServer
            rcset.CursorType = ADODB.CursorTypeEnum.adOpenDynamic
            rcset.LockType = ADODB.LockTypeEnum.adLockOptimistic
        End If
        rcset.Open(sqlStr, conn)
    End Sub

    Private Sub btn_search_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btn_search.Click
        Dim sql As String
        Dim rs As New ADODB.Recordset
        Dim rs2 As New ADODB.Recordset
        Dim res As String
        res = ""
        Call openConn()
        Dim SearchString_exist As New List(Of String)(txt_exist.Text.Split(Environment.NewLine))
        '  Dim SearchString_not_exist As New List(Of String)(txt_not_exist.Text.Split(Environment.NewLine))
        '  Do Until SearchString_exist.Count = 0
        sql = "SELECT * FROM ATG WHERE Term like '%cam%'"
        rs.Open(sql, conn, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.LockTypeEnum.adLockOptimistic)
        While (rs.EOF <> True)
            res += rs.Fields("Term").Value + Environment.NewLine
            rs.MoveNext()
        End While
        rs.Close()
        SearchString_exist.RemoveAt(0)
        txt_exist.Lines = SearchString_exist.ToArray
        'Loop
        txt_result.Text = res
    End Sub
End Class

