Public Class ErrorPlugin
    ' Example Function from plug in DLL
    Public Function SimpleExample() As Double


        Dim RentedUnits As Double = 42
        Dim NumberUnits As Double = 0


        Try

            ' Just need to generate exception
            Return RentedUnits \ NumberUnits

        Catch ex As Exception

            ' Give's me no Stack Trace infomation.
            'Throw

            ' This will give me Stack Trace infomation, 
            ' but requires adjusting all the plugins.
            Throw New Exception("Stop dividing by zero.", ex)

        End Try



    End Function
End Class



Imports System.Reflection
Public Class Form1

    Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click


        Dim rpt As Object
        Dim r As Double

        Try

            rpt = LoadReport("C:\ErrorPlugin\bin\Debug\ErrorPlugin.dll")

            r = rpt.SimpleExample()

        Catch ex As Exception

            MsgBox(ex.Message & vbCrLf & ex.StackTrace)

            If ex.InnerException IsNot Nothing Then
                MsgBox(ex.InnerException.StackTrace)
            End If

        End Try


    End Sub


    Public Function LoadReport(ByVal FileName As String) As Object

        Dim m_ReportAssembly As [Assembly]
        Dim m_ReportClass As Type
        Dim rpt As Object

        Try
            m_ReportAssembly = Assembly.LoadFrom(FileName)
            For Each m_ReportClass In m_ReportAssembly.GetTypes
                If m_ReportClass.Name.ToLower = "ErrorPlugin".ToLower Then
                    rpt = Activator.CreateInstance(m_ReportClass)
                    Exit For
                End If
            Next

            Return rpt

        Catch ex As Exception
            MsgBox(ex.Message)
        End Try
    End Function

End Class

