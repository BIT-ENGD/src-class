<%@ Page Language="VB" %>
<%@ Import Namespace="System.Collections.Generic" %> 

<script runat="server">
    Protected Sub Page_PreInit(ByVal sender As Object, ByVal e As System.EventArgs)
        Page.Theme = String.Empty ' disable theme
        If (Request.ServerVariables("HTTP_USER_AGENT").IndexOf("MSIE") > 0) Then
            Response.Cache.SetCacheability(HttpCacheability.Private)
        Else
            Response.Cache.SetCacheability(HttpCacheability.NoCache)
        End If
    End Sub

    Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs)
        Dim interns As IEnumerable(Of InternMag.Intern) = InternMag.Intern.GetInternForPhotoOrResume(New Guid(Request.QueryString("studentid")))
        For Each intern As InternMag.Intern In interns
            Response.ContentType = intern.ResumeFileType
            Response.AddHeader("Content-Disposition", "attachment; filename=""Resume" & intern.ResumeFileExtension & """")
            Response.BinaryWrite(CType(intern.ResumeFile.ToArray(), Byte()))
        Next
    End Sub
</script>

