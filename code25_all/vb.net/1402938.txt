<%@ Control Language="C#" AutoEventWireup="true" CodeBehind="MailAddSubform.ascx.cs" 
Inherits="Company.Solutions.Web.Controls.MailAddSubform" %>

<%@ Register TagPrefix="st" TagName="MailActionLookup" Src="~/Controls/StMailActionLookup.ascx" %>
<div class="NinetyNinePercentWide">
    <div class="NinetyNinePercentWide EightPixelBottomMargin">
        <div class="RowHeader" style="padding-top: 20px;">
            <span class="labelfield" >Action:</span>
        </div>
        <div>
            <st:MailActionLookup ID="mailActionLookup" runat="server" />
        </div>
    </div>
    <div class="NinetyNinePercentWide EightPixelBottomMargin" >
        <br class="NinetyNinePercentWide" Text="&nbsp" />
        <div class="RowHeader" >
            <span class="labelfield" >Message:</span>    
        </div>
        <div class="TwelvePixelLeftPad" >
            <asp:TextBox ID="txtMailActionMessage" runat="server" MaxLength="40" />
        </div>
    </div>
</div>

<%@ Control Language="C#" AutoEventWireup="true"        CodeBehind="StMailActionLookup.ascx.cs"     Inherits="Company.Solutions.Web.Controls.StMailActionLookup" %>


<div id="mainControlContainer" style="width:99%; padding:8px;">

<div id="comboContainer" style="float:left; padding-top:12px;padding-left:5px; padding- right:5px; padding-bottom:3px;">
  <asp:UpdatePanel runat="server" ID="mailActionUpdater">
    <Triggers>
        <asp:AsyncPostBackTrigger ControlID="chkForms" EventName="CheckedChanged" />
        <asp:AsyncPostBackTrigger ControlID="chkRequested" EventName="CheckedChanged" />
        <asp:AsyncPostBackTrigger ControlID="chkOther" EventName="CheckedChanged" />
    </Triggers>
    <ContentTemplate>
        <asp:DropDownList runat="server" ID="ddlLookup" width="240px" ondatabound="ddlLookup_DataBound1" /> 
    </ContentTemplate>
  </asp:UpdatePanel>


</div>

<div id="filterContainer" style="text-align:left;padding-left:6px;width:275px">
    <fieldset style="width:260px;">
        <legend>Filters</legend>
        <asp:CheckBox ID="chkForms" runat="server" Text="Forms" AutoPostBack="true" />
        <asp:CheckBox ID="chkRequested" runat="server" Text="Requested Info" AutoPostBack="true" />
        <asp:CheckBox ID="chkOther" runat="server" Text="Other" AutoPostBack="true" />
    </fieldset>

</div>    
</div>

namespace Company.Solutions.Web.Controls
{
    public partial class StMailActionLookup : System.Web.UI.UserControl
    {
        protected void Page_Load(object sender, EventArgs e)
        {
           BindForm();
        }

        public void BindMailActionLookup()
        {
            BindForm();
        }

        protected void BindForm()
        {
            GetActionLevel();
            IEnumerable actions = GetClaimMailActions(GetFilter());
            ddlLookup.DataSource = actions;
            ddlLookup.DataTextField = "CodeAndDescription";
            ddlLookup.DataValueField = "ActionCd";
            ddlLookup.DataBind();
        }
    }
}

