Private _WebControls As Products.Services.IControlsRepository
Private _customerRepo As Profiles.Services.ICustomerRepository

Sub New()
    Me.New(ObjectFactory.GetInstance(Of Products.Services.IControlsRepository),
           ObjectFactory.GetInstance(Of Profiles.Services.ICustomerRepository))
End Sub

Sub New(ByVal webRepo As Products.Services.IControlsRepository, 
        ByVal custRepo As Profiles.Services.ICustomerRepository)
    _WebControls = webRepo
    _customerRepo = custRepo
End Sub

<HttpGet()>
Function SendPassword() As ActionResult
    Dim vm As New SendPasswordViewModel
    vm.Controls = _WebControls
    Return View(vm)
End Function
<HttpPost()>
Function SendPassword(ByVal model As SendPasswordViewModel) As ActionResult
    If ModelState.IsValid Then
        If _customerRepo.SendPassword(model.EmailAddress, model.Controls.WebControls.MacsDivision) = True Then
            model.SendPasswordResponseMessage = "Email successfully sent.  Please check your email for your password."
        Else
            model.SendPasswordResponseMessage = "No account was found with the email that you provided."
        End If
    End If
    Return View("SendPassword", model)
End Function

