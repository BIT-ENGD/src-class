Dim sqliProcess As New Process()
sqliProcess.StartInfo.UseShellExecute = False
sqliProcess.StartInfo.RedirectStandardOutput = True
sqliProcess.StartInfo.RedirectStandardError = True
sqliProcess.StartInfo.FileName = "C:\shell_program.exe"
sqliProcess.StartInfo.CreateNoWindow = True
sqliProcess.Start()

Do While Not bw.CancellationPending
    Try
        If Not sqliProcess.StandardOutput.EndOfStream Then
            Debug.Print(sqliProcess.StandardOutput.ReadLine)
        End If
    Catch ex As Exception
        MsgBox(ex.Message, MsgBoxStyle.Critical, "Error reading output")
    End Try

    Threading.Thread.Sleep(1)
Loop

Type a number (1/2/3/4):
