       Dim responseReader As StreamReader = Nothing   
        Dim Reader As StreamReader = Nothing
        Dim responseData As String = ""
        Dim webresponse As HttpWebResponse = Nothing
        Dim responseStream As Stream = Nothing
        Dim returnContent As String = Nothing
        Dim cdata As Integer = 0

         webRequest = TryCast(System.Net.WebRequest.Create(url), HttpWebRequest)

        Try

            webresponse = DirectCast(webRequest.GetResponse(), HttpWebResponse)
            responseStream = webresponse.GetResponseStream
            If webresponse.ContentEncoding.ToLower().Contains("gzip") Then
              responseStream = New GZipStream(responseStream,  CompressionMode.Decompress)
            ElseIf webresponse.ContentEncoding.ToLower().Contains("deflate") Then
                responseStream = New DeflateStream(responseStream, CompressionMode.Decompress)
            End If

            Reader = New StreamReader(responseStream, Encoding.Default)
            responseData = Reader.ReadToEnd()

        Catch
            Throw
        Finally
            webRequest.GetResponse().GetResponseStream().Close()
            Reader.close()

        End Try

        Return responseData

