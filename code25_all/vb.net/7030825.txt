<%@ Page Title="" Language="VB" MasterPageFile="~/Views/Shared/ViewMasterPage1.Master"           Inherits="System.Web.Mvc.ViewPage" %>
<%@ Import Namespace="System.Data" %>

<asp:Content ID="Content1" ContentPlaceHolderID="TitleContent" runat="server">
</asp:Content>

<asp:Content ID="Content2" ContentPlaceHolderID="MainContent" runat="server">
    <ul data-role="listview">
        <% Dim ds1 As DataSet = Model %>
        <li><%=Html.Label(ds1.Tables(0).Rows.Count)%></li>
    </ul>
</asp:Content>

Function CustomerShowSearch(ByVal searchterm As String) As ActionResult
    Dim searchcustomer As New GetCustomersModel
    Dim dataset As DataSet

    searchterm = Request("searchterm")
    dataset = searchcustomer.CustomerSearchResult(searchterm)

    ViewData.Model = dataset

    Return View()
End Function

<asp:Content ID="Content2" ContentPlaceHolderID="MainContent" runat="server">
    <%Using Html.BeginForm("CustomerShowSearch", "ShowCustomers", FormMethod.Post, New With  {.enctype = "multipart/form-data"})%> 

        <div data-role="fieldcontain">                          
            <label for="searchterm">Enter a name to search:</label>
            <%= Html.TextBox("searchterm", "", New With {.type = "search"})%>
            <br />
            <label for="statelist">Enter a state to search:</label>
            <%= Html.DropDownList("statelist")%>
            <input type="submit" data-icon="search" value="Search" />
        </div>

    <% End Using %>
</asp:Content>

