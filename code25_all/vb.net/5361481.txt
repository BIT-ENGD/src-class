   Dim L, Path(0) As Integer


    Open = cleara(Open)
    sealed = cleara(sealed)
     Open(0) = Agent
    sealed(0) = Agent
    Finds adjacent nodes
    L = Agent
    Do Until sealed(sealed.GetLength(0) - 1) = Targ Or Open.GetLength(0) = 0
        'Agents(0) = L
        H = Find_H(L, Targ, Open)
        'T = Find_T(L, Targ, Open)
        ReDim F(T.GetLength(0) - 1)
        For lp As Integer = 0 To F.GetLength(0) - 1
            F(lp) = H(lp) '+ H(lp)
        Next
        L = Find_lowest(F, Open)
        Open = Remove_from(Open, L)
        sealed = Add_to(sealed, L)

        Ad = Find_adjacent(L, Targ)
        For lp As Integer = 0 To Ad.GetLength(0) - 1

            If Walk(Ad(lp)) <> -1 Then
                Parents(Ad(lp)) = L
                Open = Add_to(Open, Ad(lp))
                For lp2 As Integer = 0 To sealed.GetLength(0) - 1
                    For lp3 As Integer = 0 To Open.GetLength(0) - 1
                        If lp3 < Open.GetLength(0) - 1 Then
                            If Open(lp3) = sealed(lp2) Then
                                Open = Remove_from(Open, sealed(lp2))
                            End If
                        End If
                    Next
                Next
            End If


        Next
        G.Graphics.DrawRectangle(Pens.White, Grid(Targ))
        TempDrawing()




    Loop

