    Protected Overrides Sub OnCustomCommand(ByVal command As Integer)
                StartLogFile("Custom Command {" & command & "} invoked", EventLogEntryType.Information)
                Dim Position As String
                Dim myFile As String = Nothing
                Dim myTime As String = Nothing
                Try
                    If command = SimpleServiceCustomCommands.StartWorker Then
                        Position = "GetKeyValue Time"
                        myTime = GetKeyValue("Time", "", RegPath)
                        Position = "GetKeyValue Name"
                        myFile = GetKeyValue("Name", "", RegPath)
                        StartLogFile("Notice OnCustomCommand" & vbNewLine & "MyTime= { " & myTime & "}, {MyFile= { " & myFile & "} ", EventLogEntryType.Error)
    .
    .
    .
    Catch ex As Exception
                    StartLogFile("Error OnCustomCommand" & vbNewLine & Position & vbNewLine & ex.StackTrace, EventLogEntryType.Error)
                Finally
                End Try

Public Function GetKeyValue(ByVal nKey As String, ByVal vKey As String, ByVal sPath As String) As String
        Dim RegKey As RegistryKey
        Dim kValue As String = Nothing
        Dim Pos As String
        If RegKeyExists(sPath) Then
            Try
                RegKey = Registry.CurrentUser.OpenSubKey(sPath, True)
                kValue = CStr(RegKey.GetValue(nKey))
            Catch ex As Exception
                StartLogFile(" GetKeyValue, RegKeyExists(sPath) " & vbNewLine & "{ RegKey= " & RegKey.Name & "}, { kValue= " & kValue & "}, { nKey= " & nKey & "}" & vbNewLine & "Stack Trace= " & ex.StackTrace, EventLogEntryType.Warning)
            End Try
        End If
        Return kValue
    End Function

