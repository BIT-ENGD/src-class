     Property GridViewSortDirection() As SortDirection
        Get
            If IsNothing(ViewState.Item("GridViewSortDirection")) Then
                Return SortDirection.Descending
            End If
            Return ViewState.Item("GridViewSortDirection")
        End Get

        Set(ByVal Value As SortDirection)
            ViewState.Item("GridViewSortDirection") = Value
        End Set

    End Property



    Function GetSortDirection() As SortDirection

        Dim GridViewSortDirectionNew As SortDirection

        Select Case GridViewSortDirection

            Case SortDirection.Descending
                GridViewSortDirectionNew = SortDirection.Ascending

            Case SortDirection.Ascending
                GridViewSortDirectionNew = SortDirection.Descending

            Case Else
                GridViewSortDirectionNew = SortDirection.Descending

        End Select
        GridViewSortDirection = GridViewSortDirectionNew

        Return GridViewSortDirectionNew

    End Function



    Protected Sub GridView_Sorting1(ByVal sender As Object, ByVal e As System.Web.UI.WebControls.GridViewSortEventArgs) Handles GridView2.Sorting

        'Dim myPageIndex As Integer = GridView2.PageIndex
        Dim mySortdirection As SortDirection = GetSortDirection()
        'Dim sortExpression = e.SortExpression
        'Dim dv As New DataView()


        If (GridViewSortDirection = SortDirection.Ascending) Then
            GridViewSortDirection = SortDirection.Descending
        Else
            GridViewSortDirection = SortDirection.Ascending
        End If

    End Sub

