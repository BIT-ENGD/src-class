Public Function GetFile(ByVal filename As String) As Byte()
    Dim binReader As New BinaryReader(File.Open(filename, FileMode.Open))
    binReader.BaseStream.Position = 0
    Dim binFile As Byte() = binReader.ReadBytes(Convert.ToInt32(binReader.BaseStream.Length))
    binReader.Close()
    Return binFile
End Function

   <WebMethod()> _
   Public Sub PutFile(ByVal buffer As Byte(), ByVal filename As String)
        Dim binWriter As New BinaryWriter(File.Create((filename), FileMode.CreateNew, FileAccess.ReadWrite))
        binWriter.Write(buffer)
        binWriter.Close()
    End Sub

Server was unable to process request. ---> System.ArgumentOutOfRangeException: Enum value was out of legal range. Parameter name: options    at System.IO.FileStream.Init(String path, FileMode mode, FileAccess access, Int32 rights, Boolean useRights, FileShare share, Int32 bufferSize, FileOptions options, SECURITY_ATTRIBUTES secAttrs, String msgPath, Boolean bFromProxy)

