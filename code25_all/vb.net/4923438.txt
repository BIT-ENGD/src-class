Object reference not set to an instance of an object. 

Line 27:         Dim blnMatch As Boolean = False
Line 28: 
Line 29:         For Each Me.objDR In objDT.Rows
Line 30:             If objDR("StockItemName") = Product Then
Line 31:                 objDR("Quantity") += txtQuantity.Text

<asp:DropDownList id="ddlProducts" runat="server">

Dim objDT As System.Data.DataTable
Dim objDR As System.Data.DataRow
Private Sub Page_Load(ByVal s As Object, ByVal e As EventArgs)
    If Not IsPostBack Then
        makeCart()
    End If
End Sub
'Mark Cart function
Function makeCart()
    objDT = CType(Session("Cart"), DataTable)
    objDT.Columns.Add("StockID", GetType(Integer))
    objDT.Columns("StockID").AutoIncrement = True
    objDT.Columns("StockID").AutoIncrementSeed = 1

    objDT.Columns.Add("StockItemName", GetType(String))
    objDT.Columns.Add("StockItemValue", GetType(Decimal))
    Session("Cart") = objDT
End Function
'This is for adding items to the shopping cart.
Sub AddToCart(ByVal s As Object, ByVal e As EventArgs)
    objDT = Session("Cart")
    Dim Product As String = ddlProducts.SelectedItem.Text
    Dim blnMatch As Boolean = False

    For Each Me.objDR In objDT.Rows
        If objDR("StockItemName") = Product Then
            objDR("Quantity") += txtQuantity.Text
            blnMatch = True
            Exit For
        End If
    Next

    If Not blnMatch Then
        objDR = objDT.NewRow
        objDR("Quantity") = txtQuantity.Text
        objDR("StockItemName") = ddlProducts.SelectedItem.Text
        objDR("StockItemValue") = Decimal.Parse(ddlProducts.SelectedItem.Value)
        objDT.Rows.Add(objDR)
        Session("Cart") = objDT
    End If

    dg.DataSource = objDT
    dg.DataBind()
End Sub
Function GetItemTotal() As Decimal
    Dim intCounter As Integer
    Dim decRunningTotal As Decimal

    For intCounter = 0 To objDT.Rows.Count - 1
        objDR = objDT.Rows(intCounter)
        decRunningTotal += (objDR("StockItemValue") * objDR("Quantity"))
    Next

    Return decRunningTotal
End Function
Sub Delete_Item(ByVal s As Object, ByVal e As DataGridCommandEventArgs)

    objDT = Session("Cart")
    objDT.Rows(e.Item.ItemIndex).Delete()
    Session("Cart") = objDT

    dg.DataSource = objDT
    dg.DataBind()
    lblTotal.Text = "$" & GetItemTotal()
End Sub

