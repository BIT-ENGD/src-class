Dim dept As New ArrayList
Dim forename As New ArrayList

objJSONStringBuilder = New StringBuilder()
objSQLConnection = New SqlConnection(System.Configuration.ConfigurationManager.AppSettings("connString"))

objSQLCommand = New SqlCommand("select dept, forename from table1", objSQLConnection)

objSQLCommand.Connection.Open()
objSQLDataReader = objSQLCommand.ExecuteReader()

While objSQLDataReader.Read()
    dept.Add(New With {Key .dept = objSQLDataReader("dept")})
    forename.Add(New With {Key .forename = objSQLDataReader("forename")})
End While

objSQLDataReader.Close()
objSQLCommand.Connection.Close()

Dim serializer As New JavaScriptSerializer()
Dim arrayJson As String = serializer.Serialize(dept)

Return arrayJson

[
    {
        "dept": "dept1"
    },
    {
        "dept": "dept2"
    },
    {
        "dept": "dept3"
    }
]

forename
[
    {
        "dept": "dept1",
        "forename": "adam"
    },
    {
        "dept": "dept2",
        "forename": "joe"
    },
    {
        "dept": "dept3",
        "forename": "smith"
    }
]

