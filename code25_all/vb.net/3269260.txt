     Private Sub PopulateTree(ByVal path As String, ByVal subfoldercount As Integer)

         Dim items() As String
         items = Directory.GetFileSystemEntries(path)
         Dim itm As String

         TreeVeiw1.Nodes.Add(path)
         Dim currentnode As TreeNode = TreeView1.Nodes.Item(0)
         For Each itm In items
             If Directory.Exists(itm) Then
                 Dim nodeOjb As New TreeNode
                 nodeOjb.Text = "FOLDER :: " & subfoldercount & " :: " & itm
                 nodeOjb.ForeColor = Color.Blue
                 currentnode.Nodes.Add(nodeOjb)
                 PopulateTree(itm, subfoldercount + 1)
             Else
                 Dim nodeOjb As New TreeNode
                 nodeOjb.Text = "FILE :: " & subfoldercount & " :: " & itm
                 Select Case My.Computer.FileSystem.GetFileInfo(itm).Extension
                     Case ".txt"
                         nodeOjb.ForeColor = Color.Orange
                         currentnode.Add(nodeOjb)
                     Case ".png"
                         nodeOjb.ForeColor = Color.Red
                         currentnode.Add(nodeOjb)
                    Case ".ico"
                         nodeOjb.ForeColor = Color.Green
                         currentnode.Add(nodeOjb)
                    Case ".url"
                         nodeOjb.ForeColor = Color.Black
                         currentnode.Add(nodeOjb)
                 End Select
             End If
         Next

     End Sub

