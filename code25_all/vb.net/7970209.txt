<asp:repeater id="rptLetters" runat="server" datasourceid="dsLetters">
<headertemplate>
|
</headertemplate>
<itemtemplate>
<asp:linkbutton id="btnLetter" runat="server" onclick="btnLetter_Click" 
 text='<%#Eval("Letter")%>' />
</itemtemplate>

<separatortemplate>
|
</separatortemplate>
</asp:repeater>

Protected Sub btnLetter_Click(ByVal sender As Object, ByVal e As EventArgs)
    Dim btnLetter As LinkButton = TryCast(sender, LinkButton)
    If btnLetter Is Nothing Then
        Return
    End If
    'SELECT statement to filter Gridview
    dsCategoryLookup.SelectCommand = [String].Format("SELECT 
         Category.CategoryID, Category.CategoryName, Product.ProductID, 
         Product.ProductName, Company.CompanyID
         FROM Category 
         LEFT JOIN CategoryLink 
         ON Category.CategoryID = CategoryLink.CategoryID 
         LEFT JOIN Product ON Product.ProductID = CategoryLink.ProductID
         LEFT JOIN CompanyLink ON CompanyLink.ProductID = Product.ProductID
         LEFT JOIN Company ON Company.CompanyID = CompanyLink.CompanyID 
         WHERE (Category.CategoryName LIKE '{0}%') 
         AND Company.CompanyID = @CompanyID), btnLetter.Text")

    'declare @CompanyID
    dsCategoryLookup.SelectParameters.Clear()
    Dim controlParam As ControlParameter = New ControlParameter
    controlParam.ControlID = "ddlCompany"
    controlParam.DefaultValue = "-1"
    controlParam.Name = "CompanyID"
    controlParam.PropertyName = "SelectedValue"
    controlParam.Type = TypeCode.Decimal

    dsCategoryLookup.SelectParameters.Add(controlParam)
End Sub

