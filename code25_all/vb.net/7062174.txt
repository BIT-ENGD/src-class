Public Function loadLPforGazette(ByVal blockID As Integer) As DataSet

    Dim sql As String

    sql = "select a.blockid, a.parcelno, a.schedulefileno from landparcels a "
    sql = sql + "join actions b on(a.blockid = b.blockid and a.parcelno = b.parcelno) "
    sql = sql + "where b.blockid = " & blockID & " and b.actiontaken = 'Send To Computer' "
    sql = sql + "and not exists(select 'x' from actions x "
    sql = sql + "where x.actiontaken = 'Gazetted' "
    sql = sql + "and b.blockid = x.blockid and b.parcelno = x.parcelno) order by a.blockid, a.parcelno"

    '********************* Load LandParcel Table **************************************************

    myDALand = New SqlDataAdapter(sql, sqlCon)
    myDSLand = New DataSet()
    myDALand.Fill(myDSLand, "Landparcles")

    '********************* End Load LandParcel Table ***********************************
    loadLPforGazette = myDSLand

End Function

