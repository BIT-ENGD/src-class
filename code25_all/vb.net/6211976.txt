Protected Sub dgRecord_RowCommand(ByVal sender As Object, ByVal e As System.Web.UI.WebControls.GridViewCommandEventArgs) Handles dgRecord.RowCommand

    Dim sCommandName As String = e.CommandName
    Dim iRowIndex As Integer = CType(e.CommandArgument, Integer)
    Dim oCommon As New Common

    If String.Compare(sCommandName, "EditQuotation", True) = 0 Then

        'do grabbing values from object of quotation then extract it into the forms
        Dim oQuotationmst As quotationmst = oCommon.getQuotationmstByQuotationId(dgRecord.Rows(iRowIndex).Cells(0).Text)

        lblId.Text = oQuotationmst.quotationId
        drpQuotationType.Items.FindByValue(oQuotationmst.quotationType.ToString)

        drpCompanyName.Items.FindByValue(dgRecord.Rows(iRowIndex).Cells(2).Text)

        drpTerms.Items.FindByValue(oQuotationmst.termsId)

        Dim sAddress2 As String = oQuotationmst.address2
        If sAddress2.Length <> 0 Then
            txtDeliveryAddress.Text = oQuotationmst.address2
            txtDeliveryAddress.Enabled = True
            txtCountryCode.Text = oQuotationmst.countryCode
            txtCountryCode.Enabled = True
            txtState.Text = oQuotationmst.state
            txtState.Enabled = True
            txtCity.Text = oQuotationmst.city
            txtCity.Enabled = True
            txtPostCode.Text = oQuotationmst.postCode
            txtPostCode.Enabled = True
        End If

        drpQuotationStatus.Items.FindByValue(oQuotationmst.status)

        'Product table List rendering
        Dim alProduct As ArrayList = oCommon.getProductTableObjectByQuotationId(oQuotationmst.quotationId)
        If alProduct.Count <> 0 Then
            Session("productList") = alProduct
            gridProduct.DataSource = alProduct
            btnProductListDelete.Visible = True
        Else
            gridProduct.DataSource = Nothing
            btnProductListDelete.Visible = False
        End If
        gridProduct.DataBind()


        'SLA table List rendering
        Dim alSLA As ArrayList = oCommon.getSLATableObjectByQuotationId(oQuotationmst.quotationId)
        If alSLA.Count <> 0 Then
            Session("SLAList") = alSLA
            gridSLA.DataSource = alSLA
            btnSLAListDelete.Visible = True
        Else
            gridSLA.DataSource = Nothing
            btnSLAListDelete.Visible = False
        End If
        gridSLA.DataBind()

        lblAction.Text = "Update Quotation"
        pnlAction.Visible = True
        btnAction.Text = "Update"

    ElseIf String.Compare(sCommandName, "ViewQuotation", True) = 0 Then
        'generating a quotation in a PDF Format inside the browser
    Else

    End If

End Sub

