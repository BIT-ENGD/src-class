Dim xsi = XNamespace.Get("http://www.w3.org/2001/XMLSchema-instance")

Return _
    New XElement( _
        "providers", _
        New XAttribute(XNamespace.Xmlns + "xsi", xsi.NamespaceName), _
        New XAttribute(xsi + "noNamespaceSchemaLocation", "\schema\provider_schema.xsd"), _
        From p In context.providers _
        Select New XElement( _
            "provider", _
            New XElement("external_provider_id", p.external_provider_id), _
            New XElement( _
                "demographic", _
                New XElement("record_type_id", p.demographics.Single.record_type_id), _
                New XElement("provider_number", p.demographics.Single.provider_number), _
                ...
                New XElement("provider_type_id", p.demographics.Single.provider_type_id)), _
            New XElement( _
                "provider_specialties", _
                From s In p.provider_specialties _
                Select New XElement( _
                    "provider_specialty", _
                    New XElement("external_provider_specialty_id", s.external_provider_specialty_id), _
                    New XElement("record_type_id", s.record_type_id), _
                    New XElement("effective_date", s.effective_date.TruCareFormat), _
                    ...

