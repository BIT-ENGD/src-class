Public Function getPIXELSinWINDOW(ByVal Wsize As Integer, ByVal x As Integer, ByVal y As Integer)

        Dim tempARRAY As New ArrayList()
        Dim Xwidth As Integer = Wsize
        Dim Yheight As Integer = Wsize
        Dim Xvalue As Integer = x - Wsize / 2
        Dim Yvalue As Integer = y - Wsize / 2
        Dim imgHEIGHT As Integer = Me.mysize.Height
        Dim imgWIDTH As Integer = Me.mysize.Width
        Dim i, j As Integer


        While Xvalue < 0
            Xvalue += 1
            Xwidth -= 1
        End While
        While Xvalue > imgWIDTH
            Xvalue -= 1
            Xwidth -= 1
        End While
        While Xwidth >= imgWIDTH
            Xwidth -= 1
        End While
        While Xvalue + Xwidth > imgWIDTH
            Xwidth -= 1
        End While

        While Yvalue < 0
            Yvalue += 1
            Yheight -= 1
        End While
        While Yvalue > imgHEIGHT
            Yvalue -= 1
            Yheight -= 1
        End While
        While Yheight >= imgHEIGHT
            Yheight -= 1
        End While
        While Yvalue + Yheight > imgHEIGHT
            Yheight -= 1
        End While

        For i = Xvalue To Xvalue + Xwidth
            For j = Yvalue To Yvalue + Yheight
                tempARRAY.Add(pixels(j, i))
            Next
        Next

        Return tempARRAY
    End Function

