Protected Sub Repeater1_ItemDataBound(ByVal sender As Object, ByVal e As RepeaterItemEventArgs) Handles myDataRepeater.ItemDataBound
    Dim myPanel As Panel = e.Item.FindControl("pnlImages")
    Dim myLink As New System.Web.UI.WebControls.HyperLink
    Dim myImage As New System.Web.UI.WebControls.Image
    Dim myProperty As String = Request.QueryString("ID")

    Dim dirInfo As New DirectoryInfo(Server.MapPath("~/ftp/images/"))
    Dim fs_infos() As FileInfo = dirInfo.GetFiles("*" + myProperty.Substring(1) + "*")
    For Each fs_info As FileInfo In fs_infos
        If fs_info.Name.Substring(8, 1) <> "P" Then

            myLink.ID = fs_info.Name
            myLink.NavigateUrl = "~/ftp/images/" + fs_info.Name
            myLink.Attributes.Add("onClick", "return hs.expand(this)")
            myLink.Width = 90

            myImage.ID = "img" + fs_info.Name
            myImage.ImageUrl = "~/ftp/images/" + fs_info.Name
            myImage.Width = 80
            myImage.Height = 60
            myLink.Controls.Add(myImage)
            myPanel.Controls.Add(myLink)
        End If
    Next fs_info
    fs_infos = Nothing


End Sub 

