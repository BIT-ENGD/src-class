Function News(ByVal SchoolVisit As SchoolVisitDate) As ActionResult

    Dim db As New NewsData.NewsDB
    Dim repos As New NewsRepository

    Dim _classId As Integer
    _classId = (From a In db.SchoolClasses Where a.VisitDateID = SchoolVisit.VisitDateID Select a.ClassID).Single()

    ViewData("VisitDate") = FormatDateTime(SchoolVisit.VisitDate, vbShortDate)

    ViewData("Staff") = repos.GetStaff(_classId)
    ViewData("StockArticles") = From a In db.StockArticles Select a

    ViewData("Articles") = repos.GetArticles(_classId)

    Return View()
End Function

Function FrontPage(ByVal SchoolVisit As SchoolVisitDate) As ActionResult

    Dim repos As New NewsRepository
    Dim _VisitDateID As Integer

    _VisitDateID = SchoolVisit.VisitDateID

    ViewData("Editorial") = repos.GetEditorial(_VisitDateID)
    Return View()
End Function

