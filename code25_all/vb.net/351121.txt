    <DirectoryServicesPermission(SecurityAction.LinkDemand, Unrestricted:=True)> _
    Public Overloads Shared Function GetSearchResultEntry(ByVal connection As LdapConnection, ByVal searchDirectoryPath As String, ByVal filter As String, _
                                          ByVal attributes As String(), ByVal scope As Protocols.SearchScope) As SearchResultEntry

        If connection Is Nothing Then
            Throw New ArgumentNullException("connection", "An ldap connection must be provided in order to search for a directory.")
        End If

        If Strings.IsNullOrBlank(searchDirectoryPath) Then
            Throw New ArgumentException("A directory path must be provided in order to search for a directory.", "searchDirectoryPath")
        End If

        If Strings.IsNullOrBlank(filter) Then
            Throw New ArgumentException("A search filter must be provided in order to search for a directory.", "filter")
        End If

        Dim resp As SearchResponse = CType(connection.SendRequest(New SearchRequest(searchDirectoryPath, filter, scope, attributes)), SearchResponse)

        If resp.Entries.Count > 0 Then
            Return resp.Entries(0)
        End If

        Return Nothing

    End Function

