Public Shared Sub SaveText(ByVal Text As String)
    Dim d As New _Default
    Dim FileName As String = System.IO.Path.GetRandomFileName()

    Using sw As New System.IO.StreamWriter(d.Server.MapPath(FileName + ".txt"))
        sw.WriteLine(Text)
        sw.Close()
    End Using

    Dim fs As System.IO.FileStream = Nothing


    fs = System.IO.File.Open(d.Server.MapPath(FileName + ".txt"), System.IO.FileMode.Open)
    Dim btFile(fs.Length) As Byte
    fs.Read(btFile, 0, fs.Length)
    fs.Close()

    With HttpContext.Current.Response
        .AddHeader("Content-disposition", "attachment;filename=output.txt")
        .AddHeader("Content-Length", btFile.Length.ToString)
        .ContentType = "application/octet-stream"
        .BinaryWrite(btFile)
        .End()
    End With
End Sub

