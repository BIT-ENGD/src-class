   Public Sub getDirectories(ByVal strFilepath As String, ByVal strFileExtension As String, ByVal objControl As Object)

        'Load first files from the root folder. Then loop each subfolder
        Dim di As New DirectoryInfo(strFilepath)
        Dim aryFi As IO.FileInfo() = di.GetFiles(strFileExtension, SearchOption.AllDirectories)

        Dim filePath As String
        Dim fileIcon As Icon

        ' For each file in the root folder
        For Each file In aryFi
            If file.Extension = String.Empty Then
            Else
                filePath = GetAssociatedProgram(file.Extension)
                On Error Resume Next

                'Extract icon
                fileIcon = Drawing.Icon.ExtractAssociatedIcon(filePath)
                'Add the icon if we haven't got it already
                objControl.StateImageList = Form1.iconList

                If Form1.iconList.Images.ContainsKey(filePath) Then
                Else
                    Form1.iconList.Images.Add(filePath, fileIcon)
                End If
                'Add item to list
                objControl.items.add(file.Name, filePath).Tag = file.DirectoryName
            End If
        Next

    End Sub

getDirectories(strProgramLocation, "*.exe", Form1.listViewSupSoftware)

        Dim tempstr(2) As String
        tempstr(0) = "Name of item"
        tempstr(1) = "Target folder of item"

        Dim tempNode As ListViewItem
        tempNode = New ListViewItem(tempstr)
        Form1.listViewItem.Items.Add(tempNode)

