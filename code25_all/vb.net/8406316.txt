Public Function GetQueryResults(ByVal dtStart As Date, ByVal dtEnd As Date, ByVal strFromOrgUnitID As String, ByVal strToOrgUnitID As String) _
        As List(Of String) Implements IeRefer.GetQueryResults

    Dim dc As New eReferDataContext
    dc.CommandTimeout = My.Settings.LINQTimeOut
    log.Info("Retrieving results based on from OrgUnitID of: " & strFromOrgUnitID & " and to OrgUnitID of: " & strToOrgUnitID, RequestID)

    Dim z = (From p In dc.uspReport_ReferralsSentBetweenLinesOfBusiness(dtStart, dtEnd, strFromOrgUnitID, strToOrgUnitID) _
            Group p By key = p.CreatorLineOfBusinessName _
                        Into Group Select creatorLineOfBusinessName = key, name = Group).toList

    Return z

End Function

    Dim z = (From p In dc.uspReport_ReferralsSentBetweenLinesOfBusiness(dtStart, dtEnd, strFromOrgUnitID, strToOrgUnitID) _
                Group p By key = p.CreatorLineOfBusinessName _
                Into Group Select Group)
    Return CType(z, List(Of String))

