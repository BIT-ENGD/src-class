Public Sub SendMail _
( _
ByVal strFrom As String _
, ByVal strTo As String _
 , ByVal strSubject As String, ByVal strBody As String _
 , Optional ByVal attachment As String = "" _
 , Optional ByVal filename As String = "Attachment.HTML" _
)

    Dim sendMail As New SmtpClient
    Dim mail As New MailMessage(strFrom, strTo)
    Dim userToken As New Object


        mail.Subject = strSubject
        mail.Body = strBody

        mail.IsBodyHtml = True


        Using MemoryStream = New MemoryStream

            If attachment.Length <> 0 Then
                        Dim data As Byte() = Encoding.ASCII.GetBytes(attachment)
                        MemoryStream.Write(data, 0, data.Length)
                        MemoryStream.Seek(0, SeekOrigin.Begin)
                        MemoryStream.Position = 0

                        Dim content As New ContentType()
                        content.MediaType = MediaTypeNames.Application.Octet
                        content.Name = filename

                        Dim newAttach As New Attachment(MemoryStream, content)
                        mail.Attachments.Add(newAttach)
            End If


            sendMail.DeliveryMethod = SmtpDeliveryMethod.Network
            sendMail.Host = "SERVER"
            sendMail.UseDefaultCredentials = False
            sendMail.Credentials = New System.Net.NetworkCredential("UN", "PW")

            sendMail.Send(mail)


        End Using

dim pdf as new datadynamics.activereports.export.pdf.pdfexport
sendmail("from@", "to@", "test", "test", pdf.tostring, "pdf.pdf")

