<ul id="p7menubar">
    <li><a href="<% =GetIB("http://products.pfgbest.com") %>">Home</a></li>
    <li><a href="#" class="trigger">Lookup</a>
        <ul>
        <li><a href="<% =GetIB("Default.aspx") %>">Product</a></li>
        <li><a href="<% =GetIB("/FeatureSearch.aspx") %>">Feature</a></li>
        <li><a href="<% =GetIB("/DescriptionSearch.aspx") %>">Description</a></li>
        </ul>
    </li><!--end trigger li-->
    <div id="ib">
    Enter your IB code here:
        <asp:TextBox ID="IBTextBox" runat="server"></asp:TextBox>
        <asp:Button ID="IBTextBoxButton" runat="server" Text="Submit" />
    </div>
    </ul><!--end p7menubar-->


Partial Class MasterPage
Inherits System.Web.UI.MasterPage
Private _IB As String
Public Property IB() As String
    Get
        Return _IB
    End Get
    Set(ByVal value As String)
        _IB = value
    End Set
End Property

Public Function GetIB(ByVal url As String) As String
    If (url.Contains("?")) Then
        Return "&IB=" & _IB
    Else
        Return url & "?IB=" & _IB
    End If
End Function

Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
    If Not (String.IsNullOrEmpty(Request.QueryString("IB"))) Then
        _IB = Request.QueryString("IB")
    End If
End Sub
End Class

 Protected Sub IBTextBoxButton_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles IBTextBoxButton.Click
    Session("IB") = IBTextBox.Text
    Dim IB As Integer = Session("IB")
    Response.Redirect("IBDefault.aspx?Baccount=" + Session("IB"))
End Sub

<a target="_blank" href="<%# eval("Data") %>?IB=(Session("IB"))"><%#Eval("Title")%></a>

