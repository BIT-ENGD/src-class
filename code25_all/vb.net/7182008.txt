<li>
    <asp:LinkButton ID="DocumentButton" runat="server">Document</asp:LinkButton>
    <asp:Panel ID="DocumentPanel" runat="server" CssClass="modalPopup" Style="display:none">
       Title:<asp:TextBox ID="DocumentTitle" runat="server"></asp:TextBox>
       <asp:FileUpload ID="DocumentUpload" runat="server" />
                <asp:Button ID="SubmitDocument" runat="server" Text="Upload" onclick="SubmitDocument_Click" /><asp:Button ID="CancelDocument" runat="server" Text="Cancel" /><asp:HiddenField ID="filename" runat="server" />
            </asp:Panel>       
            <asp:ModalPopupExtender ID="DocumentModal" runat="server" DropShadow="True" DynamicServicePath="" Enabled="True" PopupControlID="DocumentPanel" TargetControlID="DocumentButton"></asp:ModalPopupExtender>
</li>    

    Protected Sub SubmitDocument_Click(ByVal sender As Object, ByVal e As EventArgs) Handles SubmitDocument.Click
    DocumentModal.Hide()
    'Builds the full absolute URL to be inserted into the database. 
    Dim hostURL As String = Request.Url.Scheme & "://" & Request.Url.Host & ":" & Request.Url.Port & Request.ApplicationPath
    Dim sqlFileHREF As String = "INSERT INTO Marketing (ProductID, MarketingTypeID, MarketingTitle, MarketingData) VALUES (" & ProductID.Value & " ,4, '" & DocumentTitle.Text & "', '" & hostURL & "uploads/" & ProductID.Value & "/" & DocumentUpload.FileName & "')"
    sqlFileHREF.Replace("'", "''")
    If DocumentUpload.HasFile Then
        Try
            DocumentUpload.SaveAs("uploads" & _
               DocumentUpload.FileName)
            DocumentLabel.Text = "File name: " & _
               DocumentUpload.PostedFile.FileName & "<br>" & _
               "File Size: " & _
               DocumentUpload.PostedFile.ContentLength & " kb<br>" & _
               "Content type: " & _
               DocumentUpload.PostedFile.ContentType
        Catch ex As Exception
            DocumentLabel.Text = "ERROR: " & ex.Message.ToString()
        End Try
    Else
        DocumentLabel.Text = "You have not specified a file."
    End If

    'Create SQL Connection
    Dim SqlConnection As New SqlConnection("Server=off-db1;uid=productsDB_admin;pwd=******;database=Products")
    SqlConnection.Open()
    Dim sqlCommand As New SqlCommand(sqlFileHREF, SqlConnection)
    sqlCommand.ExecuteNonQuery()
    SqlConnection.Close()
    Response.Redirect(Request.RawUrl)
End Sub

