Public Function EncryptAES(ByVal sIn As String, ByVal sKey As String) As String
    Dim AES As New RijndaelManaged
    Dim ahashMD5 As New MD5CryptoServiceProvider()
    AES.Key = ahashMD5.ComputeHash(System.Text.ASCIIEncoding.ASCII.GetBytes(sKey))
    AES.Mode = CipherMode.ECB
    Dim AESEncrypt As ICryptoTransform = AES.CreateEncryptor()
    Dim aBuffer As Byte() = System.Text.ASCIIEncoding.ASCII.GetBytes(sIn)
    Return Convert.ToBase64String(AESEncrypt.TransformFinalBlock(aBuffer, 0, aBuffer.Length))
End Function

Public Function DecryptAES(ByVal sOut As String, ByVal sKey As String) As String
    Dim dAES As New RijndaelManaged
    Dim dahashMD5 As New MD5CryptoServiceProvider()
    dAES.Key = dahashMD5.ComputeHash(System.Text.ASCIIEncoding.ASCII.GetBytes(sKey))
    dAES.Mode = CipherMode.ECB
    Dim dAESDecrypt As ICryptoTransform = dAES.CreateDecryptor()
    sOut = Replace(sOut, " ", "+", 1, -1, CompareMethod.Text)
    Dim daBuffer As Byte() = Convert.FromBase64String(sOut)
    Return System.Text.ASCIIEncoding.ASCII.GetString(dAESDecrypt.TransformFinalBlock(daBuffer, 0, daBuffer.Length))
End Function

