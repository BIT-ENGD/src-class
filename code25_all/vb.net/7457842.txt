Dim oquery As System.Management.ObjectQuery = New System.Management.ObjectQuery("SELECT * FROM Win32_Printer")

Dim mosearcher As System.Management.ManagementObjectSearcher = New System.Management.ManagementObjectSearcher(oquery)

Dim moc As System.Management.ManagementObjectCollection = mosearcher.Get()

For Each mo As ManagementObject In moc
Dim pdc As System.Management.PropertyDataCollection = mo.Properties

    For Each pd As System.Management.PropertyData In pdc
        If CBool(mo("Network")) Then
            cmbPrinters.Items.Add(mo(pd.Name))
        End If
    Next pd
Next mo

