Class UserConnection 
   tcpClient As TcpClient

   Public Sub SendMsg(msg as String)
      ' Sending by tcpClient
   End Sub
End Class

Class UserAccount 
   userData as UserData
   conn As UserConnection
   balance as Decimal 

   Public Sub UpdateAccount(newBalance as Decimal)
       ' perform some logic
       Dim history as new AccountHistory(me.Balance, ......, ....) 
       UserMessageFormatSendService(history)
   End Sub
End Class          

Class UserMessageFormatAndSendService()
   Public Shared SendAccountUpdate(user as UserAccount, accountHistory as AccountHistory)
      ' Some code formatting it into a string message
      Dim msg = .......

      user.Conn.SendMsg(msg)
End Class

