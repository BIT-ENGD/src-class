Private WithEvents backWork As New BackgroundWorker()
Dim sit As Situation

Private Sub btnLoad_Click(ByVal sender As System.Object, ByVal e As System.Windows.RoutedEventArgs) Handles btnLoad.Click

    backWork.RunWorkerAsync()

End Sub

Private Sub backWork_DoWork(ByVal sender As Object, ByVal e As System.ComponentModel.DoWorkEventArgs) Handles backWork.DoWork
    Load()
End Sub

Private Sub backWork_ProgressChanged(ByVal sender As Object, ByVal e As System.ComponentModel.ProgressChangedEventArgs) Handles backWork.ProgressChanged
    lblLoading.Visibility = Visibility.Visible
End Sub

Private Sub backWork_RunWorkerCompleted(ByVal sender As Object, ByVal e As System.ComponentModel.RunWorkerCompletedEventArgs) Handles backWork.RunWorkerCompleted
    tab1.DataContext = sit
    lblLoading.Visibility = Visibility.Hidden
End Sub

Private Sub Load()
    backWork.WorkerReportsProgress = True
    backWork.ReportProgress(1)

    sit = New Situation

End Sub

