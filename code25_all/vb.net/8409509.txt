Public Class MenuEntry
    Public Event selected as EventHandler(of EventArgs)

    Protected Friend Overridable Sub onSelectEntry(e as EventArgs)
        RaiseEvent selected(Me, e)
    End Sub
End Class


Public Class Menu
    Private menuSelect as New inputAction(Keys.Enter)
    Private menuEntry as New List(of MenuEntry)

    'keeps track of which menu item we're currently on
    Private _selectedEntry as Integer

    Public Sub Update()
        If menuSelect.evaluate Then
            onSelectEntry(_selectedEntry)
        End If

        Protected Overridable Sub onSelectEntry(ByVal entryIndex as Integer)
            menuEntry(entryIndex).onSelectEntry(New EventArgs())
        End Sub
    End Sub
End Class


Public Class OptionsMenu
    Inherits Menu

    Private arbitraryOne as Integer
    Private arbitraryTwo as Integer

    Public Sub New()
        Dim entryOne as New MenuEntry(String)
        Dim entryTwo as New MenuEntry(String)

        AddHandler entryOne.selected, AddressOf entryOneSelected
        AddHandler entryTwo.selected, AddressOf entryTwoSelected

        MenuEntry.add(entryOne)
        MenuEntry.add(entryTwo)
    End Sub

    Private Sub entryOneSelected(ByVal entryIndex as Integer)
        arbitraryOne += 1
    End Sub

    Private Sub entryTwoSelected(ByVal entryIndex as Integer)
        arbitraryTwo += 1
    End Sub
End Class

