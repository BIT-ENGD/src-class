If String.IsNullOrEmpty(ddlProductionLocation.SelectedValue) Then
    CurrentUser.ProductionLocation = Nothing
Else
    CurrentUser.ProductionLocation = ProductionLocationRepository.Find(DataContext, Integer.Parse(ddlProductionLocation.SelectedValue))
End If

If String.IsNullOrEmpty(ddlProductionLocation.SelectedValue) Then
    If CurrentUser.ProductionLocation IsNot Nothing Then
        CurrentUser.ProductionLocation.Users.Remove(CurrentUser)
    End If
    CurrentUser.ProductionLocation = Nothing
Else
    CurrentUser.ProductionLocation = ProductionLocationRepository.Find(DataContext, Integer.Parse(ddlProductionLocation.SelectedValue))
End If

If String.IsNullOrEmpty(ddlProductionLocation.SelectedValue) Then
    Dim pl = CurrentUser.ProductionLocation 'HACK for loading Product Location before setting it
    CurrentUser.ProductionLocation = Nothing
Else
    CurrentUser.ProductionLocation = ProductionLocationRepository.Find(DataContext, Integer.Parse(ddlProductionLocation.SelectedValue))
End If

