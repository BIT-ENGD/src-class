Public Function GetNextEmployeeInQueue() As String
    Dim NextEmployeeInQueue As String = Nothing
    Dim query As [String] = "SELECT FirstName FROM tblEmployees WHERE Checked=0 LIMIT 1;"
    Try
        Dim ReturnTable As New DataTable()
        Dim mycommand As New SQLiteCommand(cnn)
        mycommand.CommandText = query
        Dim reader As SQLiteDataReader = mycommand.ExecuteReader()
        ReturnTable.Load(reader)
        reader.Close()
        If ReturnTable.Rows.Count > 0 Then
            NextEmployeeInQueue = ReturnTable.Rows(0)("FirstName").ToString()
        Else
            MsgBox("No more employees found in queue")
        End If
    Catch fail As Exception
        MessageBox.Show("Error: " & fail.Message.ToString())
    End Try
    If NextEmployeeInQueue IsNot Nothing Then
        Return NextEmployeeInQueue
    Else
        Return "No more records in queue"
    End If
End Function

