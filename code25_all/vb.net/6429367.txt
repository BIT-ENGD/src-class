Dim encryptAES As New AesCryptoServiceProvider()
Dim encoding As New UTF8Encoding()
Dim encryptor As ICryptoTransform

encryptAES.Key = encoding.GetBytes("12345678901234567890123456789032")
encryptAES.IV = encoding.GetBytes("1234567890123416")
encryptAES.Mode = CipherMode.CBC
encryptAES.Padding = PaddingMode.PKCS7
encryptor = encryptAES.CreateEncryptor

Dim input As Byte() = encoding.GetBytes("hello")

Dim result = encryptor.TransformFinalBlock(input, 0, input.Length)

Dim hex As String = ""
For i As Integer = 0 To result.Length - 1
    hex = hex & result(i).ToString("X2")
Next
ConsoleWrite(hex)

<?php
    $cipher = mcrypt_module_open(MCRYPT_RIJNDAEL_128, '', MCRYPT_MODE_CBC, '');
    $key256 = '12345678901234567890123456789032';
    $iv =  '1234567890123416';
    $cleartext = 'hello';
    printf("plainText: %s\n\n",$cleartext);
    if (mcrypt_generic_init($cipher, $key256, $iv) != -1)
    {
        $cipherText = mcrypt_generic($cipher,$cleartext );
        mcrypt_generic_deinit($cipher);
        printf("256-bit encrypted result:\n%s\n\n",bin2hex($cipherText));
    }
?>

IV = [@"1234567890123416" dataUsingEncoding:NSUTF8StringEncoding];
NSLog([IV base64EncodingWithLineLength:0]);

NSData * localKey = [@"12345678901234567890123456789032" dataUsingEncoding:NSUTF8StringEncoding];
NSLog([localKey base64EncodingWithLineLength:0]);

NSLog(@"encode plaintext:");
NSLog([self.data base64EncodingWithLineLength:0]);

CCCryptorStatus result = CCCrypt( kCCEncrypt, kCCAlgorithmAES128, kCCOptionPKCS7Padding, 
                                     localKey, kCCKeySizeAES256,
                                     IV, //initialization vector 
                                     [self.data mutableBytes], [self.data length], //input
                                     buffer, bufferSize, //output
                                     &numBytesEncrypted );

self.data = [self.data initWithBytes:buffer length:numBytesEncrypted];
NSLog(@"encode end result:");
NSLog([self.data base64EncodingWithLineLength:0]);

key: MTIzNDU2Nzg5MDEyMzQ1Njc4OTAxMjM0NTY3ODkwMzI=
iv: MTIzNDU2Nzg5MDEyMzQxNg==
plaintext: aGVsbG8=
encrypted: oiUIdi9StezV93+nXctCKw==

key: MTIzNDU2Nzg5MDEyMzQ1Njc4OTAxMjM0NTY3ODkwMzI=
iv: MTIzNDU2Nzg5MDEyMzQxNg==
plaintext: aGVsbG8=
encrypted: rU5MgfNIjx7zqD5Cdh2mlA==

oiUIdi9StezV93+nXctCKw==
K0LLXad/99XstVIvdgglog==

BfG2gjzkooiJCXgIQJKyZg== (iOS 5 on device)
n9KJXqThiuKyrNPjo7V7PA== (iOS 5 in simulator)
cCH116bIlLeUOxNDwFt2rg== (iOS 4.3 in simulator)

wjXeJNI54DzI43fGBPymew==

