Imports Microsoft.DirectX
Imports Microsoft.DirectX.DirectInput

 Dim js As Device = Nothing

 For Each DI As DeviceInstance In Manager.GetDevices(DeviceClass.GameControl, _
     EnumDevicesFlags.AttachedOnly)

     js = New Device(DI.InstanceGuid)
     Exit For
 Next

 If js Is Nothing Then
     Throw New Exception("No joystick found")
 End If

 Dim wih As New System.Windows.Interop.WindowInteropHelper(Me)
 js.SetCooperativeLevel(wih.Handle, CooperativeLevelFlags.NonExclusive Or _
     CooperativeLevelFlags.Background)
 js.Acquire()

 Dim state As JoystickState = js.CurrentJoystickState

