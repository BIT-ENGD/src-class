Protected Sub BookingsGV_SelectedIndexChanged(ByVal sender As Object, ByVal e As System.EventArgs) Handles BookingsGV.SelectedIndexChanged
    BookingID = BookingsGV.SelectedValue
    Dim query = From a In db.Approvers Where a.ApprovalStatus = False And a.BookingID = BookingID
    Select a.ApproverEmail()
    ApproverList.DataSource = query
    ApproverList.DataBind()
    EmailStatusLabel.Text = String.Empty
End Sub

Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
    Dim query = From b In db.Bookings Where b.Approved = False And (From a In db.Approvers Where a.ApprovalStatus = False Select a.BookingID).Contains(b.BookingID) Select b.BookingID, b.DateRequired Distinct Order By DateRequired
    BookingsGV.DataSource = query
    BookingsGV.DataBind()
    If ApproverList.Items.Count > 0 Then
        DetailsPanel.Visible = True
    Else
        DetailsPanel.Visible = False
    End If
End Sub

