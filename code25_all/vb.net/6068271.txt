txtFind
chkMatchCase
btnFind
Dim index As Integer = 0

Private Sub OK_Button_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnFind.Click
    Dim strSearchTerm As String
    Dim lastIndex As Integer
    Dim strLastSearch As Integer

    'Set the end of the find location to the last known instance of the search term
    lastIndex = frmMain.rtxtNotepad.Text.LastIndexOf(Me.txtFind.Text)
    'If the last known location is 0 (meaning the string is located at the beginning of the document), set strSearchTerm to 0.
    If lastIndex = 0 Then
        strSearchTerm = 0
    ElseIf lastIndex = -1 Then
        'If the search term appears not to exist, double-check (due to an error when searching using Text.LastIndexOf and the case of the search term does not match the instance):
        If frmMain.rtxtNotepad.Text = "" Then
            '   1a) If the main window's RTB is empty, warn the user
            MsgBox("Cannot find '" & txtFind.Text & "'.")
        Else
            '   1b) If the RTB is not empty, search again. 
            If frmMain.rtxtNotepad.Find(Me.txtFind.Text, 0, frmMain.rtxtNotepad.Text.Length, RichTextBoxFinds.None) = -1 Then
                '   2a) If the search string is not found again, warn the user.
                MsgBox("Cannot find '" & txtFind.Text & "'.")
            Else
                '   2b) If it is found, set strSearchTerm to the beginning index of the occurrence.
                strSearchTerm = frmMain.rtxtNotepad.Find(Me.txtFind.Text, 0, frmMain.rtxtNotepad.Text.Length, RichTextBoxFinds.None)
            End If
        End If
    Else
        'If none of the above apply, set strSearchTerm to the index of the occurence
        strSearchTerm = frmMain.rtxtNotepad.Find(Me.txtFind.Text, index, lastIndex, RichTextBoxFinds.None)
    End If

    If strSearchTerm = -1 Then
        'If the search term is found, but this is the last instance, loop back
        strLastSearch = frmMain.rtxtNotepad.Text.LastIndexOf(Me.txtFind.Text)

        frmMain.Focus()
        frmMain.rtxtNotepad.SelectionStart = strLastSearch
        frmMain.rtxtNotepad.SelectionLength = Me.txtFind.Text.Length

        index = 0
    Else
        'If the search term is found, and this is not the last instance, set the starting integer of the Find statement to bypass the previous occurrence of the search term
        frmMain.Focus()
        frmMain.rtxtNotepad.SelectionStart = strSearchTerm
        frmMain.rtxtNotepad.SelectionLength = Me.txtFind.Text.Length

        index = strSearchTerm + 1
    End If
End Sub

