    Duplicate entry '80-0--2011-06-16-0-1' for key 'idx_mt'

    Dim cols As String = ""
    Dim msi As System.Globalization.DateTimeFormatInfo = New System.Globalization.DateTimeFormatInfo()

    cols = "TEMPLATE_NAME," & _
           "DESCRIPTION," & _
           "FORMAT," & _
           "SENDER," & _
           "`REPLY-TO`," & _
           "SUBJECT," & _
           "BODYHTML," & _
           "BODYTEXT," & _
           "CAMPAIGN_ID," & _
           "SPLIT_GROUP_ID," & _
           "TEMPLATE_IDENTIFIER," & _
           "MESSAGE_SEND_DATE," & _
           "DAYS_TO_DELAY_SEND," & _
           "ACTIVE"

    Try
        Dim test As Integer = CInt(cmbEffort.Text)
    Catch ex As Exception
        MsgBox("Please use numerical values from 1 - 6 for the effort #.")
        Return
    End Try

    If (cmbEffort.Text < 1 Or cmbEffort.Text > 6) Then
        MsgBox("Please use numerical values from 1 - 6 for the effort #.")
        Return
    End If

    Dim query As String = ""
    Dim _date As Date = DateTimePicker1.Value
    Dim dateSent As String = ""
    Dim html As String = ""
    Dim temp As message

    If (_date.DayOfWeek <> DayOfWeek.Thursday) Then
        MsgBox("Selected date must be a Thursday.")
        Return
    End If

    dateSent = formatDate(_date)

    Try
        fileStreamIn = New IO.FileStream(txtHTML.Text, IO.FileMode.Open)
        streamReader = New IO.StreamReader(fileStreamIn)
    Catch ex As Exception
        MsgBox("HTML File not found.")
        Return
    End Try

    html = streamReader.ReadToEnd()
    html = html.Replace("'", "&apos")

    streamReader.Close()

    server.query("SELECT * FROM TEMPLATES_TO_COPY WHERE CAMPAIGN_ID = " & cmpgnID)
    server.read()

    temp = getMessage(cmpgnID.ToString())
    temp.bodyText = txtMessage.Text
    temp.HTML = html
    temp.sendDate = dateSent
    temp.description = txtDescription.Text & "_" & cmbEffort.Text
    temp.campaignID = cmpgnID
    temp.name = temp.name.Replace("MMM", msi.GetMonthName(_date.Month).Substring(0, 3).ToUpper())
    temp.name = temp.name.Replace("YY", _date.Year.ToString().Substring(2, 2))

    For i As Integer = 1 To cmbEffort.Text
        temp.name = temp.name.Replace("X", (i + 1).ToString())
        query = "INSERT INTO MESSAGE_TEMPLATES (" & _
                cols & ")" & _
                "VALUES ('" & temp.name & "','" & temp.description & "','" & temp.format & "','" & temp.sender & "','" & temp.replyTo & "','" & temp.subject & "','" & temp.HTML & "','" & temp.bodyText & "'," & temp.campaignID & "," & 0 & ",'','" & temp.sendDate & "'," & temp.daysToDelay & "," & temp.active & ");"

        If (Not server.query(query)) Then
            Return
        End If
        temp.name = temp.name.Replace((i + 1).ToString(), "X")
    Next

