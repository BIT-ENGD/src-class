    Using doc = New XpsDocument(TempLoc, FileAccess.Write)
        Dim writer = XpsDocument.CreateXpsDocumentWriter(doc)
        Dim collator = writer.CreateVisualsCollator()

        Dim Window1 As Window1 = New Window1()
        Window1.ShowDialog()
        Dim Window2 As Window2 = New Window2()
        Window2.ShowDialog()
        Dim WindowX As WindowX = New WindowX()
        WindowX.ShowDialog()

        collator.BeginBatchWrite()
        collator.Write(Window1)
        collator.Write(Window2)
        collator.Write(WindowX)

        collator.EndBatchWrite()
    End Using

    Dim doc2 = New XpsDocument(TempLoc, FileAccess.Read)

    Dim seq = doc2.GetFixedDocumentSequence()

    Dim window = New Window()
    window.Content = New DocumentViewer() With {.Document = seq}
    window.ShowDialog()

    doc2.Close()

