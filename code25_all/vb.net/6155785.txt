'factory defined somewhere else as DbProviderFactory
'connection is a working DbConnection
Dim selectcmd As DbCommand = connection.CreateCommand()
Dim adapter As DbDataAdapter = factory.CreateDataAdapter()
Dim builder As DbCommandBuilder = factory.CreateCommandBuilder()

selectcmd.Connection = connection
selectcmd.CommandText = "SELECT * FROM tbl1"
adapter.SelectCommand = selectcmd
builder.DataAdapter = adapter

Dim ds As New DataSet
'Fetch data
adapter.Fill(ds)

'Change something in ds

adapter.Update(ds) '<- exception occurs

CommandBuilder
Update-
Insert-
DeleteCommand
adapter.InsertCommand = builder.GetInsertCommand()
adapter.UpdateCommand = builder.GetUpdateCommand()
adapter.DeleteCommand = builder.GetDeleteCommand()

Commands
CommandBuilder
?
@param1
Parameters
INSERT INTO tbl1 (field1, field2, field3) VALUES (?, ?, ?)
InsertCommand
JOINS
