Public Class frmFoods
Dim foods() As String = IO.File.ReadAllLines("foods.txt")


Private Sub btnDisplay_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnDisplay.Click

    Dim Letter As String = txtLetter.Text.ToUpper
    Dim smallerarray() As Array
    Dim userarray As String
    lstOutput.Items.Clear()
    If IsNumeric(txtLetter.Text) = False Then
        For Each food As String In foods
            smallerarray = listfoods(Letter)
            lstOutput.Items.Add(Letter)
            userarray = Join(smallerarray, ", ")
            lstOutput.Items.Add(userarray)
        Next
    ElseIf IsNumeric(txtLetter.Text) = True Then
        MessageBox.Show("Please enter a letter.")
    Else
        MessageBox.Show("The text box is empty")
    End If
End Sub

Function listfoods(ByVal letter As String) As String()
    Dim foodarray(foods.Count - 1) As String
    Dim counter As Integer = 0
    For Each food As String In foods
        If food.StartsWith(letter) Then
            foodarray(counter) = food
            counter += 1
        End If
    Next
    ReDim Preserve foodarray(counter - 1)
    Return foodarray
End Function

