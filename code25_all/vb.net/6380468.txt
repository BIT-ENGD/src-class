Imports Microsoft.VisualBasic

Imports System.Net
Imports System.Net.Mail

Namespace websiteCode
    Public Class mailer
        Const mailTo As String = "receiver@test.com"
        Const mailFrom As String = "sender@test.com"
        Const smtpServer As String = "192.168.1.1"
        Const username As String = "user"
        Const password As String = "password"



        Public Function send(ByVal emailaddress As String, ByVal messagebody As String, ByVal subject As String) As Boolean
            'If checkdata(emailaddress, messagebody) Then
            Using mm As New MailMessage(mailFrom, mailTo)
                mm.To.Add(New MailAddress("receÄ±ver@test.com"))
                mm.Subject = subject
                mm.Body = messagebody
                mm.IsBodyHtml = True
                mm.ReplyTo = New MailAddress(emailaddress)
                Dim smtp As New SmtpClient
                smtp.Host = smtpServer
                smtp.UseDefaultCredentials = False
                smtp.Credentials = New NetworkCredential(username, password)



                Try
                    smtp.Send(mm)
                    Return True
                Catch ex As Exception
                    Return False
                End Try

            End Using
            Return True
        End Function




    End Class
End Namespace  

<%@ OutputCache CacheProfile="static" %>

