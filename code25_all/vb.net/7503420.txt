Public Function Get_URL(ByVal URL As String) As String
    Dim Content As String = Nothing
    Try
        Dim request As Net.HttpWebRequest = Net.WebRequest.Create(URL)
        ' Request Settings
        request.Method = "GET"
        request.KeepAlive = True
        request.AllowAutoRedirect = True
        request.Timeout = MaxTimeout
        request.CookieContainer = cookies
        request.UserAgent = "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/534.24 (KHTML, like Gecko) Chrome/11.0.696.60 Safari/534.24"
        request.Timeout = 60000
        request.AllowAutoRedirect = True
        Dim response As Net.HttpWebResponse = request.GetResponse()
        If response.StatusCode = Net.HttpStatusCode.OK Then
            Dim responseStream As IO.StreamReader = New IO.StreamReader(response.GetResponseStream())
            Content = responseStream.ReadToEnd()
        End If
        response.Close()
    Catch e As Exception
        HTTPError = e.Message
        Return False
    End Try
    Return Content
End Function

Dim Content As String = Get_URL("http://www.google.com/")
If Content = False Then
    MessageBox.Show("A HTTP Error Occured: " & MyBase.HTTPError)
    Exit Sub
End If

