 <div id="divItemsPerPage" runat="server" style="font-size:60%;font-weight:bolder;padding-right:15px;">
     Items per Page:
       <asp:DropDownList ID="ddlPerPage" runat="server" AutoPostBack="true">
                <asp:ListItem Text="10" Value="10" />
                <asp:ListItem Text="25" Value="25" Selected="True" />
                <asp:ListItem Text="50" Value="50" />
                <asp:ListItem Text="100" Value="100" />
       </asp:DropDownList>
 </div>

 Private Sub ddlPerPage_SelectedIndexChanged(ByVal sender As Object, ByVal e As System.EventArgs) Handles ddlPerPage.SelectedIndexChanged
        'LoadFromViewstate()
        _rowsPerPage = Convert.ToInt32(ddlPerPage.SelectedItem.Value)
        gvData.PageIndex = 0
        SaveRowsCountToCookie(_rowsPerPage)
 End Sub

 Public Property RowsPerPage() As Integer
        Get
            Return Utils.cleanInt(ddlPerPage.SelectedValue)
        End Get
        Set(ByVal value As Integer)
            Dim itmX As New ListItem(value.ToString, value.ToString)

            ddlPerPage.SelectedIndex = -1
            If ddlPerPage.Items.Contains(itmX) Then
                ddlPerPage.Items.FindByValue(value.ToString).Selected = True
            Else
                ddlPerPage.SelectedIndex = -1
                For i As Integer = 0 To ddlPerPage.Items.Count - 1
                    If Utils.cleanInt(ddlPerPage.Items(i).Value) > value Then
                        ddlPerPage.Items.Insert(i, itmX)
                        ddlPerPage.SelectedIndex = i
                        Exit For
                    End If
                Next
            End If
            _rowsPerPage = value
            ViewState("RowsPerPage") = _rowsPerPage
        End Set
    End Property

