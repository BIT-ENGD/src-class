If Not Request.IsLocal AndAlso Not Request.IsSecureConnection Then
    Dim ub As var = New UriBuilder(Request.Url)
    ub.Scheme = Uri.UriSchemeHttps
    ub.Port = -1
    ' use default port for scheme
    Response.Redirect(ub.Uri.ToString(), True)
    Return
End If

