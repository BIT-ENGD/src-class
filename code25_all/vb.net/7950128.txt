Public Class Form1


Dim con As New OleDb.OleDbConnection
Dim dbProvider As String
Dim dbSource As String

Dim ds As New DataSet 'holds table data
Dim da As OleDb.OleDbDataAdapter 'connection to database connectionobject
Dim sql As String

Dim inc As Integer
Dim MaxRows As Integer


 Private Sub Form1_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load

    dbProvider = "PROVIDER=Microsoft.Jet.OLEDB.4.0;"
    dbSource = "Data Source = C:/AddressBook.mdb"

    con.ConnectionString = dbProvider & dbSource

    'alternative way of connection
    'Dim fldr As String
    'Environment is the user profile
    'fldr = Environment.GetFolderPath(Environment.SpecialFolder.MyDocuments) & "/AddressBook.mdb"
    'dbSource = "Data Source = " & fldr

    con.Open()
    MsgBox("Database is now Open")

    sql = "select * from tblContacts"
    da = New OleDb.OleDbDataAdapter(sql, con)
    da.Fill(ds, "Addressbook")


    con.Close()
    MsgBox("Database is now Closed")



    MaxRows = ds.Tables("AddressBook").Rows.Count
    inc = -1
    MsgBox(MaxRows)

    TextBox1.Text = inc

    DataGridView1.DataSource = ds
    DataGridView1.DataMember = "AddressBook"

End Sub     

End Class

