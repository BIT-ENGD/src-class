   Private Sub SingleInstanceCheck(ByVal sender As Object, ByVal e As Microsoft.VisualBasic.ApplicationServices.StartupEventArgs) Handles Me.Startup

        Dim strLoc As String = Assembly.GetExecutingAssembly().Location
        Dim fileInfo As IO.FileSystemInfo = New IO.FileInfo(strLoc)
        Dim sExeName As String = fileInfo.Name

        strLoc = strLoc.Replace("\", "//")

        Using mutex As New Threading.Mutex(False, "Global\" + strLoc)
            If Not mutex.WaitOne(0, False) Then
                File.WriteAllText("c:\log.txt", "instance already running")
                Environment.Exit(1)
            End If

            GC.Collect()


        End Using

    End Sub

