Dim as400 As cwbx.AS400System
as400 = New cwbx.AS400SystemClass()
Dim program As cwbx.Program = New cwbx.Program()
Dim strResult(1) As String

as400.Define(RPGServer)
program.system = as400
program.system.UserID = RPGUsername
program.system.Password = RPGPassword
program.LibraryName = CurrentLibrary
program.ProgramName = EncryptionProgram

If as400.IsConnected(cwbx.cwbcoServiceEnum.cwbcoServiceRemoteCmd) = 0 Then
    as400.Disconnect(cwbx.cwbcoServiceEnum.cwbcoServiceAll)
    as400.Connect(cwbx.cwbcoServiceEnum.cwbcoServiceRemoteCmd)
End If

Dim stringConverter As cwbx.StringConverter = New cwbx.StringConverterClass()
Dim parameters As cwbx.ProgramParameters = New cwbx.ProgramParametersClass()

stringConverter.Length = 16

parameters.Append("&INNUM", cwbx.cwbrcParameterTypeEnum.cwbrcInput, 16)
parameters("&INNUM").Value = stringConverter.ToBytes(CardNo.PadRight(16, " "))

parameters.Append("&OUTNUM", cwbx.cwbrcParameterTypeEnum.cwbrcOutput, 16)

program.Call(parameters)

strResult(0) = stringConverter.FromBytes(parameters("&OUTNUM").Value)

stringConverter.Length = 16
Dim byteArr() As Byte = {22, 11, 57, 27, 0, 221, 252, 143, 52, 54, 66, 72, 31, 65, 24, 77}

Dim strValue As String = ""
For Each b As Byte In byteArr
    stringConverter.Length = 1
    If b = 0 Then
        strValue &= vbNull
    Else
        Dim tbb2() As Byte = {b}
        strValue &= stringConverter.FromBytes(tbb2)
    End If
Next
stringConverter.Length = 16

Dim tttt As Byte() = stringConverter.ToBytes(strValue)

