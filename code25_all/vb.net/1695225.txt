Root
 |
 |--Admin
 |  |
 |  |--Add.aspx
 |  |--Delete.aspx
 |
 |
 |
 |--Purchases
    |
    |--Orders.aspx
    |--Stock.aspx

Protected Sub resize(ByVal sender As Object, ByVal e As System.Web.UI.WebControls.TreeNodeEventArgs) Handles TreeView1.Load
    For Each node As TreeNode In (CType(sender, TreeView)).Nodes
        If node.NavigateUrl = GetCurrentPage() Then
            For Each parentN As TreeNode In (CType(sender, TreeView)).Nodes
                If Not (parentN.Parent.Selected = True And node.Parent.Text = parentN.Parent.Text) Then
                    parentN.Collapse()
                Else : parentN.Expand()
                End If
            Next
        End If
    Next
End Sub


Public Shared Function GetCurrentPage() As String
    Return System.IO.Path.GetFileName(HttpContext.Current.Request.Url.AbsolutePath).ToLower
End Function

