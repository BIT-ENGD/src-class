Imports System.Collections.Generic

Partial Class ALCounties
Inherits System.Web.UI.Page

Protected Sub Button1_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles Button1.Click
    Dim chkValues As Dictionary(Of String, Double) = _
        New Dictionary(Of String, Double)


    For Each Item As ListItem In CheckBoxList1.Items
        If (Item.Selected) Then
            If (Not Item.Value Is Nothing And Not String.IsNullOrEmpty(Item.Value())) Then
                chkValues(Item.Text.ToString) = Convert.ToDouble(Item.Value)
            Else
                chkValues(Item.Text.ToString) = 0
            End If

        End If
    Next Item

    Session("CheckedItems") = chkValues
    Response.Redirect("Cart.aspx")
End Sub
End Class

<asp:CheckBoxList ID="CheckBoxList1" runat="server" 
                DataSourceID="SqlDataSource1" DataTextField="AL_County" 
                DataValueField="AL_Fee">
            </asp:CheckBoxList>
       </div>
            <asp:SqlDataSource ID="SqlDataSource1" runat="server"        ConnectionString="<%$ ConnectionStrings:advancedleadsConnectionString %>" 
                SelectCommand="SELECT [AL_Fee], [AL_County]  FROM [AL]">   </asp:SqlDataSource>

        <p>&nbsp;</p>
        <p>
        <asp:Button ID="Button1" runat="server" Text="Submit" />
        </p>

