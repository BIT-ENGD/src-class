Private Sub MainForm_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load
    ' When the form loads, we want to populate the color menu item with all the possible colors that we could change the label to.
    For Each currentColor As KnownColor In [Enum].GetValues(GetType(KnownColor))
        ' Declare the knowColor again - we must do this to be able to do anonymous delegates in VB.NET
        Dim actualCurrentColor As KnownColor = currentColor

        ' Get the name for this color
        Dim colorName As String = [Enum].GetName(GetType(KnownColor), actualCurrentColor)

        ' Create a new menu item for this color
        Dim newMenuItem As ToolStripMenuItem = New ToolStripMenuItem(colorName)

        ' Add a handler to this menu item so when it is clicked, we change the heading color
        AddHandler newMenuItem.Click, Function(s As System.Object, events As System.EventArgs) (HeadingLabel.ForeColor = Color.FromKnownColor(actualCurrentColor))

        ' Add the menu item to the colors menu
        ColorToolStripMenuItem.DropDownItems.Add(newMenuItem)
    Next
End Sub

