<%@ Page Language="vb" AutoEventWireup="false" CodeBehind="gv.aspx.vb" Inherits="WebRoot.gv" %>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
   <title></title>
</head>
<body>
   <form id="form1" runat="server">
   <asp:GridView ID="gv" runat="server" AutoGenerateEditButton="true" AutoGenerateColumns="false">
      <Columns>
         <asp:TemplateField HeaderText="Foo">
            <ItemTemplate>
               <asp:Label ID="Label1" runat="server" Text="Foo" />
               <asp:Label ID="lblQuarter" runat="server" Text='<%#  Eval("fooVal") %>' />
            </ItemTemplate>
            <EditItemTemplate>
               <asp:Label ID="lblQuarter" runat="server" Text='Bar' />
               <asp:TextBox ID="TextBox1" runat="server" Text='<%#  Eval("fooVal") %>'></asp:TextBox>
            </EditItemTemplate>
         </asp:TemplateField>
  </Columns>

Public Class MyFoo
   Public ReadOnly Property FooVal() As String
      Get
         Return _val
      End Get
   End Property
   Private _val As String = String.Empty
   Public Sub New(ByVal val As String)
      _val = val
   End Sub
End Class
Partial Public Class gv
   Inherits System.Web.UI.Page

   Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
      Dim l As New List(Of MyFoo)
      l.Add(New MyFoo("first"))
      l.Add(New MyFoo("second"))

      gv.DataSource = l
      gv.DataBind()
   End Sub


   Private Sub gv_RowEditing(ByVal sender As Object, ByVal e As System.Web.UI.WebControls.GridViewEditEventArgs) Handles gv.RowEditing
      Dim x As String
      x = "foo"
   End Sub
End Class

