Dim genericRule As Rule
Dim factoryObject As String

factoryObject = _dal.GetFactoryObject(ruleId)

'Close, but not quite will keep working on it.
'Dynamic object creation using remoting to the local computer.
'Dim mArgs(1) As Object
'mArgs(0) = ruleid
'mArgs(1) = pronumber
'Dim mObj As Object
'Try
'    mObj = Activator.CreateInstance(Nothing, "DedicatedBilling.RuleFactory." + mFactoryObject, mArgs)
'    mRule = CType(mObj, Rule)
'Catch ex As Exception
'    mObj = Activator.CreateInstance(Nothing, "DedicatedBilling.RuleFactory.ErrorRule", mArgs)
'    mRule = CType(mObj, Rule)
'End Try

Select Case factoryObject
    Case "DeadHeadEntryRule"
        genericRule = New DeadHeadEntryRule(ruleId, proNumber)
    Case "DeadHeadFuelRateRule"
        genericRule = New DeadHeadFuelRateRule(ruleId, proNumber)
    Case "DeliveryStatusRule"
        genericRule = New DeliveryStatusRule(ruleId, proNumber)

    Case Else
        genericRule = New ErrorRule(ruleId, proNumber)
End Select

