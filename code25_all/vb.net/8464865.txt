sendBytes = Encoding.ASCII.GetBytes("LIST active microsoft.public*" & ControlChars.CrLf)
networkStream.Write(sendBytes, 0, sendBytes.Length)
Array.Clear(bytes, 0, bytes.Length)
If networkStream.CanRead Then
    Do
        numberOfBytesRead = networkStream.Read(myReadBuffer, 0, myReadBuffer.Length)
        myCompleteMessage.AppendFormat("{0}", Encoding.ASCII.GetString(myReadBuffer, 0, numberOfBytesRead))
        intLenMyReadBuf = myReadBuffer.Length
        intLenComplMsg = myCompleteMessage.Length
        swWriter.WriteLine("buf len = " & intLenMyReadBuf & ", msg len = " & intLenComplMsg)
        Loop While networkStream.DataAvailable
Else
    Console.WriteLine("Sorry.  You cannot read from this NetworkStream.")
End If

sendBytes = Encoding.ASCII.GetBytes("QUIT " & ControlChars.CrLf)
networkStream.Write(sendBytes, 0, sendBytes.Length)
tcpClient.Close()
networkStream.Close()

