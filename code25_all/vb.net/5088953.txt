Private Sub FormBackground_FormClosing(ByVal sender As Object, ByVal e As System.Windows.Forms.FormClosingEventArgs) Handles Me.FormClosing
    If (e.CloseReason = CloseReason.UserClosing) Then
        If (conditionIsMet) Then
            Dim res As DialogResult
            res = MessageBox.Show("Are you sure?", "Warning", MessageBoxButtons.YesNo)
            If (res <> Windows.Forms.DialogResult.Yes) Then
                e.Cancel = True
            End If
        End If
    End If
End Sub

