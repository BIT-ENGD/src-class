Public Function SetVersion(ByVal hl7Message As String, ByVal newVersion As String) As String
    Dim rgx = New Regex("^(?<pre>.+)(\|\d\.\d{1,2})$", RegexOptions.Multiline)
    Dim m = rgx.Match(hl7Message)
    Return rgx.Replace(hl7Message, "${pre}|" & newVersion, 1, 0)
End Function

dsfdsaf|2.1
wretdfg|2.2
sdafasd3|2.3

