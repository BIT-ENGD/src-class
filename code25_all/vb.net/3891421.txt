<System.Runtime.CompilerServices.Extension()> _
Public Function Search(Of T As Class)(ByVal context As DataContext, _
                                       ByVal parameters As Hashtable) As T
    Dim table = context.GetTable(Of T)()
    Dim results As Data.Linq.Table(Of T)
    For Each Parameter As DictionaryEntry In parameters
        Dim column As Object = Parameter.Key
        Dim value As String = Parameter.Value
        Dim param = Expression.Parameter(GetType(T), column)
        Dim Predicate = Expression.Lambda(Of Func(Of T, Boolean)) _
                        (Expression.[Call](Expression.Convert(Expression.Property(param, column), _
                            GetType(String)), GetType(String).GetMethod("Contains"), _
                            Expression.Constant(value)), New ParameterExpression() {param})
        Dim test = table.First(Predicate)

        Return test
        ' result.intersect(result)
    Next
    'Return results
End Function

