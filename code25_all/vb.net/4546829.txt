Private Shared Function replaceIllegalXMLChars(ByVal item As String) As String

    Dim returnValue As String = item
    returnValue = returnValue.Replace("&", "&amp;")
    returnValue = returnValue.Replace("""", "&quot;")
    returnValue = returnValue.Replace("'", "&apos;")
    returnValue = returnValue.Replace("<", "&lt;")
    returnValue = returnValue.Replace(">", "&gt;")

    Return returnValue

End Function

Private Shared Function replaceIllegalChars(ByVal state As String) As String
    'remove any hexdecimal characters like &#x19; and &#x0;
    state = Regex.Replace(state, "&\#x([0-9A-F]{1}[0-9A-F]{0,1});", " ")
    'remove any hexdecimal characters like &#19; and &#0;  (no x's)
    state = Regex.Replace(state, "&\#([0-9A-F]{1}[0-9A-F]{0,1});", " ")
    state = Regex.Replace(state, "0xFFFF", " ")
    'added on 3/19/2008 to fix a non-encoded character issue, mostly for LJ
    state = Regex.Replace(state, "&nbsp;", "&amp;nbsp;")
    'mark as completed
    Return state
End Function

         Dim xdoc As XmlDocument = New XmlDocument
        _html = replaceIllegalChars(_html)
        _html = replaceIllegalXMLChars(_html)
        _html = checkUnicode(_html)

        ' now load the file as a xml file
        xdoc.LoadXml(_html)

