Function AddUserToGroup(ByVal strUserDN As String, ByVal strGroupDN As String, ByVal strGRPDC As String, ByVal strUserDC As String) As Boolean
    Dim oUser As DirectoryEntry
    Dim oGroup As DirectoryEntry
    Dim blnStatus As Boolean
    Try
        oUser = New DirectoryEntry("LDAP://" & strUserDN)
        oGroup = New DirectoryEntry("LDAP://" & strGroupDN)
        oGroup.Invoke("Add", oUser.Path.ToString)
        oGroup.CommitChanges()
        blnStatus = True
    Catch ex As Exception
                //catch error...send email to support
    End Try
    oUser = Nothing
    oGroup = Nothing
    Return blnStatus
End Function

User: WACUSTDC2/CN=Simpson\, Homer,OU=Geo Test OU,OU=Customers,DC=customer,DC=geo,DC=com
Group: wadc4/CN=QSGEOTESTOU_RW,OU=Permission Groups,OU=Resources,DC=geo,DC=com
Error: Exception has been thrown by the target of an invocation.

