For Each x As Control In Me.Controls

        If x.GetType Is GetType(TextBox) Or x.GetType Is GetType(MaskedTextBox) Or x.GetType Is GetType(RichTextBox) Then
            If Not x.Name = "party_code" Then

                'if user has not entered a value in a textbox then incremnets the flag variable

                If (x.Text = String.Empty) Or ((x.Name = "contact1" Or x.Name = "contact2" Or x.Name = "ptcl") And (x.Text.Trim().EndsWith("-") And x.Text.Trim().StartsWith("-"))) Then
                    flag += 1
                End If

                'checks if the user has entered a value in some textbox 

                If (Not x.Text = String.Empty And Not x.Name = "contact1" And Not x.Name = "contact2" And Not x.Name = "ptcl") Or ((x.Name = "contact1" Or x.Name = "contact2" Or x.Name = "ptcl") And Not x.Text.Trim.EndsWith("-")) Then


                    'generates query text for the textbox which contains some value

                    str = str & comma & x.Name & " = @" & x.Name

                    comma = " , "
                End If
            End If
        End If

    Next

 Private Sub town_KeyDown(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs) Handles town.KeyDown
    If e.KeyData = Keys.Return Then
        address.Focus()
    End If
End Sub

 Private Sub address_KeyDown(ByVal sender As Object, ByVal e As System.Windows.Forms.KeyEventArgs) Handles address.KeyDown
    If e.KeyData = Keys.Return Then
        Button3.Focus()
    End If
End Sub

