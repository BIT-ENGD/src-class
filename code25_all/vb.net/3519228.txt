    Imports CookComputing.XmlRpc

Public Structure blogInfo
    Public title As String
    Public description As String
End Structure


<XmlRpcUrl("http://127.0.0.1/wordpress/xmlrpc.php")> _
Class MsnSpacesMetaWeblog
    Inherits XmlRpcClientProtocol


    <XmlRpcMethod("metaWeblog.newPost")> _
    Function NewPage(ByVal blogID As Integer, ByVal strUserName As String, ByVal strPassword As String, ByVal content As blogInfo, ByVal publish As Integer) As String

        Return CStr(Me.Invoke("newPost", New Object() {blogID, strUserName, strPassword, content, publish}))
    End Function

End Class

Public Class Form1

    Private Sub Button1_Click_1(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click

        Dim mw As MsnSpacesMetaWeblog = New MsnSpacesMetaWeblog

        Dim newBlogPost As blogInfo
        newBlogPost.title = TextBox1.Text
        newBlogPost.description = TextBox2.Text

        Try
            Dim id As String = mw.NewPage(1, "******", "******", newBlogPost, 1)

            MsgBox("Posted to Blog successfullly! Post ID : " + id)
            TextBox1.Text = ""
            TextBox2.Text = ""
        Catch ex As Exception
            MsgBox(ex.Message)
        End Try
    End Sub
End Class

