Imports System.IO
Imports Microsoft.VisualBasic.FileIO

Public Class Form1

    Private BagelStreamReader As StreamReader
    Private PhoneStreamWriter As StreamWriter
    Dim ResponseDialogResult As DialogResult

    Private Sub OpenToolStripMenuItem_Click(ByVal sender As System.Object, _
            ByVal e As System.EventArgs) Handles OpenToolStripMenuItem.Click

        'Dim PhoneStreamWriter As New StreamWriter(OpenFileDialog1.FileName)

        'Is file already open
        If PhoneStreamWriter IsNot Nothing Then
            PhoneStreamWriter.Close()
        End If

        With OpenFileDialog1
            .InitialDirectory = Directory.GetCurrentDirectory
            .FileName = OpenFileDialog1.FileName
            .Title = "Select File"
            ResponseDialogResult = .ShowDialog()
        End With

        'If ResponseDialogResult <> DialogResult.Cancel Then
        '    PhoneStreamWriter = New StreamWriter(OpenFileDialog1.FileName)
        'End If

        Try
            BagelStreamReader = New StreamReader(OpenFileDialog1.FileName)
            DisplayRecord()
        Catch ex As Exception
            MessageBox.Show("File not found or is invalid.", "Data Error")
        End Try  
    End Sub

    Private Sub DisplayRecord()

        Do Until BagelStreamReader.Peek = -1
            TextBox1.Text = BagelStreamReader.ReadLine()
        Loop

        'MessageBox.Show("No more records to display.", "End of File")
        'End If
    End Sub

    Private Sub SaveToolStripMenuItem_Click(ByVal sender As System.Object, _
            ByVal e As System.EventArgs) Handles SaveToolStripMenuItem.Click

        With SaveFileDialog1
            .InitialDirectory = Directory.GetCurrentDirectory
            .FileName = OpenFileDialog1.FileName
            .Title = "Select File"
            ResponseDialogResult = .ShowDialog()
        End With

        PhoneStreamWriter.WriteLine(TextBox1.Text)
        With TextBox1
            .Clear()
            .Focus()
        End With
        TextBox1.Clear()
    End Sub

    Private Sub ExitToolStripMenuItem_Click(ByVal sender As System.Object, _
            ByVal e As System.EventArgs) Handles ExitToolStripMenuItem.Click

        Dim PhoneStreamWriter As New StreamWriter(OpenFileDialog1.FileName)
        PhoneStreamWriter.Close()
        Me.Close()

    End Sub
End Class

