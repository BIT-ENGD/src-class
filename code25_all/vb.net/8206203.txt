Dim dinvs = AcStudentInvoiceDetails _
            .GroupBy(Function(di) di.InvoiceID) _
            .Select(Function(di2) New With { _
                .InvoiceID = di2.Key, _
                .DebitSum = di2.Sum(Function(di3) di3.Debit), _
                .CreditSum = di2.Sum(Function(di3) di3.Credit) }) _
            .Where(Function(dd) dd.DebitSum > dd.CreditSum)

Dim invs = From i In AcStudentInvoices _
           Join di In dinvs On i.ID Equals di.InvoiceID _
           Select i

Where
