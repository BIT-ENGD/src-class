<Root>
    <Result img="1.png" name="a">
        <Programs>
            <Program name="foo1">
                <ProgramID>1</ProgramID>
            </Program>
        </Programs>
    </Result>
    <Result img="2.png" name="b">
        <Programs>
            <Program name="foo1">
                <ProgramID>1</ProgramID>
            </Program>
            <Program name="foo2">
                <ProgramID>2</ProgramID>
            </Program>
        </Programs>
    </Result>
    <Result img="3.png" name="c">
        <Programs>
              <Program name="foo1">
                <ProgramID>1</ProgramID>
            </Program>
        </Programs>
    </Result>
    <Result img="4.png" name="d">
        <Programs>
             <Program name="foo1">
                <ProgramID>1</ProgramID>
            </Program>
        </Programs>
    </Result>
</Root>

xOut = New XElement("Root", _
                                   From s In x...<Result> _
                                   Where s.<Programs>.<Program>.<ProgramID>.Value = 2 _
                                   Select s)

