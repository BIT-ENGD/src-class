Dim UpdateThreadStart As New ThreadStart(AddressOf QueryDataBase)
Dim CallDataBindToDataGrid As New MethodInvoker(AddressOf Me.DataBindToDataGrid)
Dim MyDataSet As New DataSet
Dim MyDataAdapter As SqlDataAdapter
Dim MyQueryString As String = ""
Dim MyConnection As New SqlConnection("ConnectionString")

Private Sub BtnSearch_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles BtnSearch.Click
    Try
        MyQueryString = "SELECT * FROM TABLE;"
        UpdateThread = New Thread(UpdateThreadStart)
        UpdateThread.IsBackground = True
        UpdateThread.Name = "UpdateThread"
        UpdateThread.Start()
        While UpdateThread.IsAlive
            Application.DoEvents()
        End While
    Catch ex As Exception
            MessageBox.Show(ex.Message)
    End Try

End Sub

Public Sub DataBindToDataGrid()
    DGVSearchResults.DataSource = MyDataSet
    DGVSearchResults.DataMember = "MyTable"
    MyDataAdapter = Nothing
    MyDataSet = Nothing

End Sub

' Sub routine used by the background thread to query database.
Public Sub QueryDataBase()
    MyDataSet = New DataSet()
    MyConnection.Open()
    Dim cmd As New SqlCommand(MyQueryString, MyConnection)
    MyDataAdapter = New SqlDataAdapter(cmd)
    MyDataAdapter.Fill(MyDataSet, "MyTable")
    MyConnection.Close()
    ' Make asynchronous function call to Form's thread.
    Me.BeginInvoke(CallDataBindToDataGrid)
End Sub

