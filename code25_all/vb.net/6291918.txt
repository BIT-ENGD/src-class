Protected Sub Page_Init(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Init

        If ViewState.Item("nameload") IsNot Nothing Then
            If ViewState.Item("nameload").ToString = "True" Then
                Getname(Me, New EventArgs)
            ElseIf ViewState.Item("Getnameload").ToString = "True" Then
                GetnameDetails(Me, New EventArgs)
            Else
                CreateNamesButton()
            End If
        Else
            CreateNamesButton()
        End If

Private Sub CreateNamesButton()
        Dim btnName As New LinkButton
        btnName .Text = "Name"
        Panel1.Controls.Add(btnName)
        AddHandler btnName .Click, AddressOf Getname
        ViewState.Item("nameload") = False.ToString
    End Sub

Private Sub Getname(ByVal sender As Object, ByVal e As EventArgs)
        ' get products list here
        ' and set handlers for each link

        Dim testDb As New customer
        Dim arr As ArrayList = testDb.DbLoop()
        Dim ObjCustList As CustomerBo
        Dim CustInt As Integer
        Dim str As String

        Dim link As LinkButton

        For Each ObjCustList In arr
            CustInt = ObjCustList.Cus_Id
            link = New LinkButton
            Panel1.Controls.Add(New LiteralControl("<br />"))
            link.ID = CustInt
            link.Text = ObjCustList.FirstName
            link.CommandArgument = CustInt
            str = link.CommandArgument
            AddHandler link.Click, AddressOf GetnameDetails
            Me.Panel1.Controls.Add(link)

        Next ObjCustList

        ViewState.Item("nameload") = True.ToString

    End Sub

Private Sub GetnameDetails(ByVal sender As Object, ByVal e As EventArgs)

        Dim getRecord As New CustomerBo
        Dim lbLink As LinkButton = CType(sender, LinkButton)
        Dim CustomerID As String = lbLink.CommandArgument
        Dim getLink As String = lbLink.Text
        Dim SendCustID As Integer
        SendCustID = CInt(CustomerID)
        getRecord.Cus_Id = SendCustID

        Dim getAllcatInfo As New customer
        getRecord = getAllcatInfo.R_List(getRecord)
        Panel1.Controls.Add(New LiteralControl("<table><tr>"))
        Panel1.Controls.Add(New LiteralControl("<td colspan=2 align=center    valign=middle >"))
        Panel1.Controls.Add(New LiteralControl(getRecord.FirstName))
        Panel1.Controls.Add(New LiteralControl("</td>"))
        Panel1.Controls.Add(New LiteralControl("<td>"))
        Panel1.Controls.Add(New LiteralControl(getRecord.LastName))
        Panel1.Controls.Add(New LiteralControl("</td>"))
        Panel1.Controls.Add(New LiteralControl("<td>"))
        Panel1.Controls.Add(New LiteralControl(getRecord.Telephone))
        Panel1.Controls.Add(New LiteralControl("</td></tr></table>"))
        ViewState.Item("Getnameload") = True.ToString

        'get product details here
    End Sub

