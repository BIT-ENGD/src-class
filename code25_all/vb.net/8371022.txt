Private MainNlogConfig As New LoggingConfiguration()
Dim locallogtarget As New FileTarget()
Dim labelmessengertarget As New FormControlTarget()
Dim localrule As New LoggingRule("*", LogLevel.Info, locallogtarget)
MainNlogConfig.AddTarget("file", locallogtarget)
MainNlogConfigAddTarget("FormControl", richtextmessengertarget)

With locallogtarget
    .Layout = "${longdate} ${logger} ${message}"
    .FileName = appdir & appName & ".log"
End With
Dim filteringTarget As New FilteringTargetWrapper()
filteringTarget.WrappedTarget = locallogtarget
filteringTarget.Condition = "not equals('${logger}', 'messenger')"
SimpleConfigurator.ConfigureForTargetLogging(filteringTarget, LogLevel.Info)

With richtextmessengertarget
    .Layout = "${message} ${logger}" & vbCrLf
    .FormName = "form_myform"
    .ControlName = "richtext_messenger"
    .Append = True
End With

LogManager.Configuration = MainNlogConfig

Public MessengerLogger = LogManager.GetLogger("messenger")
MessengerLogger.Info("This message should go to richtext control, but not log file.")

