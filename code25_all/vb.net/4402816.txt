HtmlForm form = new HtmlForm(); 
string attachment = "attachment; filename=Patients.xls"; 
Response.ClearContent(); 
Response.AddHeader("content-disposition", attachment); 
Response.ContentType = "application/ms-excel"; 
StringWriter stw = new StringWriter(); 
HtmlTextWriter htextw = new HtmlTextWriter(stw); 
form.Controls.Add(gridview1); 
this.Controls.Add(form); 
form.RenderControl(htextw); 
Response.Write(stw.ToString()); 
Response.End(); 

