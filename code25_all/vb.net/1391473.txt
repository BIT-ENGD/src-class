Public Sub ActiveRecord_Find_By_NonKey_Returns_123()

  Dim orders = Order.Find(Function(item As Order) item.EmployeeID = 1)

  Assert.Equal(Of Integer)(123, orders.Count)

End Sub

item.EmployeeID = 1
item.EmployeeID
item.EmployeeID = 1
Convert
WHERE
WHERE ([t0].[EmployeeID] = 1) <> 0

Public Sub ActiveRecord_Find_By_NonKey_Returns_123_Linq()

  Dim orders = From item In Order.All Where item.EmployeeID = 1 Select item

  Assert.Equal(Of Integer)(123, orders.Count)

End Sub

WHERE
WHERE COALESCE(CASE WHEN (([t0].[EmployeeID] = 1)) THEN 1 ELSE 0 END, 0) <> 0

Public Sub ActiveRecord_Find_By_NonKey_Returns_123_Fix()

  Dim orders = Order.Find(Function(item As Order) If(item.EmployeeID, 0) = 1)

  Assert.Equal(Of Integer)(123, orders.Count)

End Sub

WHERE
WHERE (COALESCE([t0].[EmployeeID], 0) = 1)

ISNULL
COALESCE
