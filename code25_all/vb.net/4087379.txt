   Dim tclient As TcpClient = New TcpClient(url, "80")
   nstream = tclient.GetStream() 
  If nstream.CanRead Then
              defaultsize = 8000, BUFFER_SIZE = 1024
                Dim bufferread(defaultSize) As Byte
                Dim data As String
                mstring = New StringBuilder
                numbytesread = 0
                Dim timestamp As DateTime = DateTime.Now

                Do
                    numbytesread = nstream.Read(bufferread, 0, BUFFER_SIZE)

                    If numbytesread > 1 Then
                        timestamp = DateTime.Now
                        data = Encoding.UTF8.GetString(bufferread, 0, numbytesread)
                        parsingUtilities.appendXMLtoFile(data)
                    End If
                    If DateTime.Now.Subtract(timestamp).TotalSeconds > 60 Then
            'timestamp shows no bytesread for more than 60 seconds, then reconnect
                        Exit Sub
                    End If

                Loop While tclient.Connected
            End If

