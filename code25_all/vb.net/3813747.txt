For Each prod In querylist
    If myfetcher.getHtml(prod, userAgent, page) Then
      ' The lines below I use to find proxy ip
      ' but error name 'Request' not declared
        ' Dim nowip As String
        ' nowip = Request.ServerVariables("HTTP_X_FORWARDED_FOR")
        ' If nowip = "" Then
        'nowip = Request.ServerVariables("REMOTE_ADDR")
        'End If
        '

        If prod.Contains("http://") Then
            prod = Regex.Replace(prod, "http://", "")
        End If
        badHost = prod
        Dim ipEntry As IPHostEntry = Dns.GetHostByName(prod)
        Dim IPAdd As IPAddress() = ipEntry.AddressList
        Dim i As Integer = 0
        For i = 0 To IPAdd.GetUpperBound(0)
            number = number & "IP Address {0}:{1}" & IPAdd(i).ToString
        Next
        IPList.Add(prod & " " & number)
        number = ""
    Else
        badList.Add(prod)
        number = ""
    End If
    count = count + 1
Next

