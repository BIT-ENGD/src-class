Error   1   'TextBoxFor' is not a member of 'System.Web.Mvc.HtmlHelper(Of TModel)'...

FImports System.Runtime.CompilerServices

Public Module HtmlHelperExtension

<Extension()> _
Public Function WatermarkedTextBoxFor(Of TModel, TProperty)(ByVal htmlHelper As System.Web.Mvc.HtmlHelper(Of TModel), ByVal expression As Linq.Expressions.Expression(Of Func(Of TModel, TProperty)), ByVal htmlAttributes As IDictionary(Of String, Object)) As MvcHtmlString

    Dim propertyMetaData = ModelMetadata.FromLambdaExpression(expression, htmlHelper.ViewData)

    Return htmlHelper.TextBoxFor(expression, New RouteValueDictionary(htmlAttributes) From {
                                 {"class", "jq_watermark"},
                                 {"title", If(Not String.IsNullOrEmpty(propertyMetaData.Watermark), propertyMetaData.Watermark, propertyMetaData.GetDisplayName())}
                             })

End Function
End Module

