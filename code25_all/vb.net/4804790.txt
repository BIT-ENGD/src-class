<asp:AsyncFileUpload ID="PictureUpload" runat="server" UploaderStyle="Traditional"
ThrobberID="spinner" PersistFile="true" OnClientUploadComplete="uploadComplete" OnClientUploadStarted="uploadStart"  />

Dim bmp As New Bitmap(PictureUpload.PostedFile.InputStream)

Dim sourceImage As System.Drawing.Image = System.Drawing.Image.FromStream(PictureUpload.PostedFile.InputStream)

            Dim strm As System.IO.Stream = PictureUpload.PostedFile.InputStream
            Dim memStream As New IO.MemoryStream()
            Dim buffer(2048) As Byte
            Dim bytesRead As Integer = 1
            While (bytesRead <> 0)
                bytesRead = strm.Read(buffer, 0, buffer.Length)
                memStream.Write(buffer, 0, bytesRead)
            End While

            Dim sourceImage As System.Drawing.Image = System.Drawing.Image.FromStream(memStream)

<httpRuntime
  maxRequestLength="1048576"
  executionTimeout="3600"
/>
<sessionState
  timeout="60"
/>

enctype="multipart/form-data"

PictureUpload.PostedFile.InputStream.Seek(0, SeekOrigin.Begin)

PictureUpload.PostedFile.InputStream.Position = 0

