    Dim sURL As String
    sURL = "https://graph.facebook.com"

    Dim wrGETURL As WebRequest
    wrGETURL = WebRequest.Create(sURL)
    wrGETURL.Method = "POST"
    wrGETURL.Proxy = WebRequest.DefaultWebProxy
    Dim reqStream As IO.Stream = wrGETURL.GetRequestStream()

    Dim access_token As String = "..." ' Access token removed, but it is valid

    Dim jsonReq As String = """access_token"": """ + access_token + """"
    jsonReq = jsonReq + """batch"": ["

    AddBatchRequest(jsonReq, "email1@gmail.com")
    AddBatchRequest(jsonReq, "email2@gmail.com")

    jsonReq = jsonReq + "]"

    Dim enc As New System.Text.UTF8Encoding()
    Dim jsonBytes As Byte() = enc.GetBytes(jsonReq)

    reqStream.Write(jsonBytes, 0, jsonBytes.Length)

    reqStream.Close()

    Dim oLabel As Label = output_label

    Dim objStream As Stream
    Try
        objStream = wrGETURL.GetResponse.GetResponseStream() '<<<<Crashes here

        Dim objReader As New StreamReader(objStream)
        Dim sLine As String = ""
        Dim i As Integer = 0

        Dim ostr As String = ""

        Do While Not sLine Is Nothing
            i += 1
            sLine = objReader.ReadLine
            If Not sLine Is Nothing Then
                ostr = ostr + sLine

            End If
        Loop

        oLabel.Text = ostr
    Catch ex As Exception
        oLabel.Text = ex.Message
    End Try

Private Sub AddBatchRequest(ByRef json As String, ByVal email As String)
    If json.EndsWith("}") Then
        json = json + ","
    End If
    json = json + "{""method: ""GET"", ""relative_url"": ""search?q=" + email + "&type=user""}"
End Sub

