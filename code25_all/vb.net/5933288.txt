 Private Function UploadFileToServer(ByVal sSourceFile As String, ByVal sTargetFile As String) As Boolean
    Dim objCredential As NetworkCredential
    Dim objRequest As FtpWebRequest
    Dim objReader As FileStream
    Dim objStream As Stream
    Dim objResponse As FtpWebResponse
    Dim bResult As Boolean = False

    Try
        objRequest = DirectCast(WebRequest.Create(sTargetFile), FtpWebRequest)
        'objRequest = FtpWebRequest.Create(sTargetFile)
        objRequest.Method = WebRequestMethods.Ftp.UploadFile
        objCredential = New NetworkCredential(USER_NAME, PASSWORD)
        objRequest.Credentials = objCredential
        objReader = New FileStream(sSourceFile, FileMode.Open)
        Dim objBuffer(Convert.ToInt32(objReader.Length - 1)) As Byte
        objReader.Read(objBuffer, 0, objBuffer.Length)

        objReader.Close()
        objRequest.ContentLength = objBuffer.Length
        objStream = objRequest.GetRequestStream()
        objStream.Write(objBuffer, 0, objBuffer.Length)
        objStream.Close()
        objResponse = DirectCast(objRequest.GetResponse, FtpWebResponse)

        objResponse.Close()
        bResult = True
    Catch ex As Exception

    End Try

    Return bResult
End Function

Dim objBuffer(Convert.ToInt32(objReader.Length - 1)) As Byte

