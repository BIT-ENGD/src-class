   Sub Application_Error(ByVal sender As Object, ByVal e As EventArgs)
    'Get MemberNumber
    Dim MemberNumber As String
    MemberNumber = User.Identity.Name.ToString
    If Len(User.Identity.Name.ToString) < 1 Then
        MemberNumber = "Guest"
    End If

    ' Code that runs when an unhandled error occurs
    Dim objErr As Exception = Server.GetLastError().GetBaseException()

    Dim ErrorDescription As String = "<b>Error Caught in Page_Error event</b><hr><br>" & _
 "<br><b>Member:</b> " & MemberNumber & _
 "<br><b>Error in: </b>" & Request.Url.ToString() & _
 "<br><b>Source Error:</b><br>" & objErr.Source.ToString() & _
 "<br><b>Error Message: </b>" & objErr.Message.ToString() & _
 "<br><b>Stack Trace:</b><br>" & _
 objErr.StackTrace.ToString()

    ErrorDescription = ErrorDescription & "<br />&nbsp;<br /><b>Form Variables</b>"
    For Each x As String In Request.Form
        If Trim(Request.Form(x).ToString).Contains("__VIEWSTATE") = False Then ErrorDescription = ErrorDescription & (x & ": ") & Request.Form(x) & "<br />"
    Next

