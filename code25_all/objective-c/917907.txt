- (IBAction)addAttachment:(id)sender
{
    panel = [NSOpenPanel openPanel];
    [panel beginSheetForDirectory:nil
                 file:nil
              modalForWindow:[NSApp mainWindow]
            modalDelegate:self
             didEndSelector:@selector(openPanelDidEnd:
                            returnCode:
                            contextInfo:)
              contextInfo:NULL];
}

- (void)openPanelDidEnd:(NSOpenPanel *)openPanel
             returnCode:(int)returnCode
             contextInfo:(void *)x
{
    if (returnCode == NSOKButton)
    {
        NSArray *files = [openPanel filenames];

        int i;
        for (i = 0; i < [files count]; i++)
        {
            NSString *file = [files objectAtIndex:i];
            [attachmentController add:x];
            // How do I add filenames here?
            // I'm assuming it involves KVC like
            // [something setValue:@"file" forKey:@"filename"];
            // But I don't know hot to get the something
            // i.e. since I have multiple attachments,
            // how do I get the one I just created
        }
    }
}

        NSString *filename = [files objectAtIndex:i];
        MySchoolPlanner_AppDelegate *myAppDelegate = [[MySchoolPlanner_AppDelegate init] alloc];
        [NSEntityDescription insertNewObjectForEntityForName:@"Attachment"
                                      inManagedObjectContext:[myAppDelegate managedObjectContext]];
        [myAppDelegate release];

