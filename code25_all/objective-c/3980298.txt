#import <Cocoa/Cocoa.h>

@interface AppController : NSWindowController {

    IBOutlet NSArrayController *arrayController;
    IBOutlet NSButton *btnAdRunner;
    IBOutlet NSButton *btnAddItem;
    IBOutlet NSButton *btnDelteItem;
    IBOutlet NSButton *btnLoadSheet;
    IBOutlet NSButton *btnQuit;
    IBOutlet NSTableView *tblAdList;

    NSMutableArray* fileList; 
}

@property (copy) NSMutableArray* fileList;

- (IBAction)AdRun:(id)sender;
- (IBAction)AddItem:(id)sender;
- (IBAction)DeleteItem:(id)sender;
- (IBAction)LoadSheet:(id)sender;
- (IBAction)QuitApp:(id)sender;
@end

#import "AppController.h"

@implementation AppController

@synthesize fileList; 

- (IBAction)LoadSheet:(id)sender {

    //define the ad array (this will be pulled from the run sheet
    fileList = [NSMutableArray arrayWithObjects:@"Ad1, 1, 2.5", @"Ad2, 1, 3", @"Ad3, 2, 1", @"Ad4, 1, 2.5", @"Ad5, 2, 4", nil];

    int i=0;
    for(NSString* thisdatarow in fileList) {

        //increase i
        i++;

        //make ad id
        NSString* adID = [NSString stringWithFormat:@"ad%d", i];

        //convert add data to an array from a string
        NSArray* templist = [thisdatarow componentsSeparatedByString:@","];

        //get ad items
        NSString* adname = [templist objectAtIndex: 0];
        NSString* adcols = [templist objectAtIndex:1];
        NSString* adheight = [templist objectAtIndex:2];

        //declare an array
        NSMutableArray* temparray = [[NSMutableArray alloc] initWithObjects:  adname, adcols, adheight];

        //dump temp array into arrayController
        [arrayController addObject:temparray];

    }

}

@end

