    contacts = [[db getContacts:@"Contacts"] componentsSeparatedByString:@","];
    [db cleanup];

    NSMutableArray *tempArray = [[NSMutableArray alloc] init];
    NSString *charString;
    for (int i=65; i<91; i++) {
        charString = [NSString stringWithFormat:@"%c",(char *)i];
        [tempArray addObject:charString];
    }
    [charString release];

    NSMutableDictionary *dict = [[NSMutableDictionary alloc] init];


    for (int i=0; i<[tempArray count]; i++) {
        NSMutableArray *contactsByIndex = [[[NSMutableArray alloc] init]autorelease];
        NSString *tempChar = [tempArray objectAtIndex:i];

        for (int j=0; j<[contacts count]-1; j++)
        {

            NSString *test = [contacts objectAtIndex:j];
            NSString *tempString = [test substringToIndex:1];

            if ([tempString isEqualToString:tempChar]) {
                [contactsByIndex addObject:[contacts objectAtIndex:j]];
            }


        }
        [dict setObject:contactsByIndex forKey:[tempArray objectAtIndex:i]];
    }
        self.contactNames = dict;

    NSArray *array = [[contactNames allKeys] sortedArrayUsingSelector:@selector(caseInsensitiveCompare:)];

    self.contactKeys = array;

    [dict release];
    [tempArray release];

    //---display the searchbar--- 
    self.tableView.tableHeaderView = searchBar; 
    searchBar.autocorrectionType = UITextAutocorrectionTypeYes;

    listOfContacts = [[NSMutableArray alloc] init]; 
    for (NSString *key in array)  
    {

        NSArray *contactsArray = [contactNames objectForKey:key]; 
        for (NSString *name in contactsArray) {
            [listOfContacts addObject:name];
        }
    }


   - (void) searchContactsTableView {

    //---clears the search result--- 
    [searchResult removeAllObjects];
    for (NSString *str in listOfContacts) {
        NSRange titleResultsRange = [str rangeOfString:searchBar.text options:NSCaseInsensitiveSearch];
        if (titleResultsRange.length > 0) 
            [searchResult addObject:str];

    }

}



- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath {
    // Navigation logic may go here. Create and push another view controller.
    NSString *selectedRow=nil;
    if (isSearchOn) {
        selectedRow=[searchResult objectAtIndex:indexPath.row];
    }

    DetailViewController *detailViewController;
    int section_index=[indexPath indexAtPosition:[indexPath length]-2];
    int sugarid_Index = [indexPath indexAtPosition: [indexPath length]-1];
    NSString* sectionName=[contactKeys objectAtIndex:section_index];
    NSLog(@"%@",sectionName);

//This is a method which gets the details of a particular contact based on the section and the row selected..Contacts is the table name

    NSString *getContact=[db getId:@"Contacts" bySection:sectionName andIndex:sugarid_Index];
    id=[db getContact:@"Contacts" id:getContact];
    // Pass the selected object to the new view controller.
    detailViewController = [[DetailViewController alloc] initWithNibName:@"DetailViewController" bundle:nil];
    detailViewController.eachContact=contactForSugarId;
    [self.navigationController pushViewController:detailViewController animated:YES];

}

