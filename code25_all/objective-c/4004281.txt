Category
types
Subcategory
types
Category
types
types
Subcategory
    -(void)newCat:(NSString*)catName subCat:(NSArray*)subCatNames types:(NSArray*)typeNames{
 //get the context
 NSManagedObjectContext *context = [self managedObjectContext];

 //make a category
 Category *theCat = [NSEntityDescription
      insertNewObjectForEntityForName:@"Category" 
      inManagedObjectContext:context];
 theCat.name = catName;

 //make default types and put it in the category
 for (int i = 0; i < [typeNames count]; i++) {
  Type *type = [NSEntityDescription
       insertNewObjectForEntityForName:@"Type" 
       inManagedObjectContext:context];
  type.name = [typeNames objectAtIndex:i];
  [theCat addTypesObject:type];
 }

 //make some subcategories
 //copy default types from category to subcategory
 for (int i = 0; i < [subCatNames count]; i++) {
  Subcategory *newSubcat = [NSEntityDescription
       insertNewObjectForEntityForName:@"Subcategory" 
       inManagedObjectContext:context];

  newSubcat.name = [logbookNames objectAtIndex:i];
  newSubcat.category = theCat;
  [newSubcat addTypes:theCat.types];
 }

 //save the context
 [self save];

 }

Subcategory
types
Subcategory
types
types
Category
Category.types
Subcategory.types
