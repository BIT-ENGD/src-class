NSArray *user = [[xmlParser createArrayWithDictionaries:dataAsXML
                                              withXPath:kUserXPath] retain];
if([user count] > 0) {
    self.name = [[user valueForKey:@"name"] copy];
}

// Crash happens if I leave the next line un-commented.
// But then we have a memory leak.
[user release]; 

[xmlParser release];

[user release]
createArrayWithDictionaries:withXPath:
- (NSArray *)createArrayWithDictionaries:(NSString *)xmlDocument 
                               withXPath:(NSString *)XPathStr {
    NSError *theError = nil;
    NSMutableArray *dictionaries = [NSMutableArray array];
    CXMLDocument *theXMLDocument = [CXMLDocument alloc];
    theXMLDocument = [theXMLDocument initWithXMLString:xmlDocument
                                               options:0
                                                 error:&theError]; 
    NSArray *nodes = [theXMLDocument nodesForXPath:XPathStr error:&theError];

    for (CXMLElement *xmlElement in nodes) {
        NSArray *attributes = [xmlElement attributes];
        NSMutableDictionary *attributeDictionary;
        attributeDictionary = [NSMutableDictionary dictionary];
        for (CXMLNode *attribute in attributes) {
            [attributeDictionary setObject:[attribute stringValue]
                                    forKey:[attribute name]];
        }

        [dictionaries addObject:attributeDictionary];
    }

    [theXMLDocument release];
    return dictionaries;
} 

self.name
NSZombieEnabled
User *u = self.user;
NSString *uri = [NSString stringWithFormat:@"%@/user/%@/%@",
                         [self groupName], u.userId, kLocationsUri];

createArrayWithDictionaries:withXPath
