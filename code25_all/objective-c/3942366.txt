NSURL *dataUrl = [NSURL URLWithString:@"http://nne.ezadspro.co.uk/cms/testmap.txt"];

NSString *fileString = [NSString stringWithContentsOfURL:dataUrl
                                                encoding:NSUTF8StringEncoding
                                                   error:nil];
int count = 0;
NSScanner *scanner = [NSScanner scannerWithString:fileString];

eventPoints = [[NSMutableArray array] retain];
Locations *event;
NSString *line;
NSArray *values;
while ([scanner isAtEnd] == NO) {
    [scanner scanUpToString:@"\n" intoString:&line];
    //skip the first line
    if(count > 0) {
        values = [line componentsSeparatedByString:@","];
        event = [[[Locations alloc] init] autorelease];
        event.latitude = [[values objectAtIndex:5] floatValue];
        event.longitude = [[values objectAtIndex:6] floatValue];
        //event.companyID = [[values objectAtIndex:0]intValue];
        event.title = [values objectAtIndex:1];
        event.subtitle = [values objectAtIndex:2];
        //event.magnitude = [[values objectAtIndex:4] floatValue];
        //event.depth = [[values objectAtIndex:5] floatValue];
        [eventPoints addObject:event];
    }
    count++;
    if(count == 300) {
        //limit number of events to 300
        break;
    }
}
//UIButton *infoButton = [UIButton buttonWithType:UIButtonTypeDetailDisclosure];

[mapView addAnnotations: eventPoints];

