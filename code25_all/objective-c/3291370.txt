- (BOOL)createAnError:(NSError **)error {
    NSMutableDictionary *errorDetail = [NSMutableDictionary dictionary];
    [errorDetail setValue:NSLocalizedString(@"This error should be testable", @"")
                   forKey:NSLocalizedDescriptionKey];
    [errorDetail setObject:self
                    forKey:NSValidationObjectErrorKey];
    NSError *cannotDeleteError = [NSError errorWithDomain:@"myErrorDomain" 
                                                     code:12345 
                                                 userInfo:errorDetail];
    if (*error = nil)
        *error = cannotDeleteError;

    return NO;
}

- (void)testNSErrors {
    Unit *myObj = [NSEntityDescription insertNewObjectForEntityForName:@"TestObject" 
                                                  inManagedObjectContext:managedObjectContext];
    NSError *error = nil;
    STAssertFalse([myObj createAnError:&error], @"This method should return NO");
    STAssertEquals([error code], 12345, @"The error code is incorrect. (error = %@)", error);
}

error: -[LogicTests testNSErrors] : '0' should be equal to '12345': The error code is incorrect. (error = (null))
