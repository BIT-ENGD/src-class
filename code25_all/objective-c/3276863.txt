- (void)viewDidLoad {
OnTVXMLParser *xmlParser = [[OnTVXMLParser alloc] init];

/* Runs the parse command in the background */
[NSThread detachNewThreadSelector:@selector(parse) toTarget:xmlParser withObject:self];

//[xmlParser parse];

// new view to disable user interaction during downloading.
loadView = [[UIView alloc] initWithFrame: [[UIScreen mainScreen] bounds]];
loadView.backgroundColor = [UIColor darkGrayColor];
//Loader spinner
UIActivityIndicatorView *act = [[UIActivityIndicatorView alloc] initWithActivityIndicatorStyle:UIActivityIndicatorViewStyleWhiteLarge];
[loadView addSubview:act]; 
act.center =loadView.center;
[self.view addSubview:loadView];
[self.view bringSubviewToFront:loadView];
[act startAnimating];
[act release];  

[super viewDidLoad];
}

- (void)removeActivityView {
//[loadView removeFromSuperview];
NSLog(@"Should remove activity view here");
}

- (BOOL)parse{
NSAutoreleasePool *pool = [[NSAutoreleasePool alloc] init];
NSLog(@"Sleeping for 5 seconds");
[NSThread sleepForTimeInterval:5.0];
NSLog(@"Sleep finished");

// Simulated some elapsed time. I want to remove the Activity View
[self performSelectorOnMainThread:@selector(removeActivityView) withObject:nil waitUntilDone:false];

// Create and initialize an NSURL with the RSS feed address and use it to instantiate NSXMLParser
NSURL *url = [[NSURL alloc] initWithString:@"http://aurl.com/xml"];
NSXMLParser *parser = [[NSXMLParser alloc] initWithContentsOfURL:url];

// Lots of parsing stuff snipped, this all runs fine

[pool release];
return YES;
}

