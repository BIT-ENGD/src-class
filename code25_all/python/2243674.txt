VIDIOC_DQBUF: Inappropriate ioctl for device

import pygame
import Image
from pygame.locals import *
import sys
import time, os

import opencv
from opencv import highgui 

camera = highgui.cvCreateCameraCapture(0)
fps = 10.0
pygame.init()
window = pygame.display.set_mode((640,480))
pygame.display.set_caption("WebCam Demo")
screen = pygame.display.get_surface()

while True:
 events = pygame.event.get()
 for event in events:
  if event.type == QUIT or event.type == KEYDOWN:
   sys.exit(0)
 while True:
  try:
   ima = highgui.cvQueryFrame(camera)
   im = opencv.adaptors.Ipl2PIL(ima)
   break;
  except TypeError:
   print 'No camera'
   os.system('sudo modprobe uvcvideo')
   time.sleep(1)
   camera = highgui.cvCreateCameraCapture(0)

 pg_img = pygame.image.frombuffer(im.tostring(), im.size, im.mode)
 screen.blit(pg_img, (0,0))
 pygame.display.flip()
 pygame.time.delay(int(1000 * 1.0/fps))

