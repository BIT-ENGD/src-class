import SocketServer
import sys
import threading

buffer_size = 8182
ports = {'toserver': int(sys.argv[1]), 'fromserver': int(sys.argv[2])}

class ConnectionHandler(SocketServer.BaseRequestHandler):

    def handle(self):
        # I need to send the data received from the client connected to port 'toserver'
        # to the client connected to port 'fromserver' - see variable 'ports' above

class TwoWayConnectionServer(threading.Thread):

    def __init__(self):
        self.to_server = SocketServer.ThreadingTCPServer(("", ports['toserver']), ConnectionHandler)
        self.from_server = SocketServer.ThreadingTCPServer(("", ports['fromserver']), ConnectionHandler)
        threading.Thread.__init__(self)

    def run(self):
        while (1):
            self.to_server.handle_request()
            self.from_server.handle_request()

def serve_non_blocking():

    server = TwoWayConnectionServer()
    server.run()

if __name__ == '__main__':

    serve_non_blocking()

