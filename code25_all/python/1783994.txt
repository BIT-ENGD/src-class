#!/usr/bin/python
import os.path
import os
import shutil
import csv
import re

# Create the videos directory in the current directory
# If the directory exists ignore it.
#
# Moves all files with the .wmv extenstion to the
# videos folder for file structure
#
#Crawl the videos directory then change to videos directory
# create the videos.csv file in the videos directory
# replace any drive letter A:-Y: with Z:
def createCSV():
    directory = "videos"
    if not os.path.isdir("." + directory + "/"):
        os.mkdir("./" + directory + "/")
    for file in os.listdir("./"):
        if os.path.splitext(file)[1] == ".wmv":
            shutil.move(file, os.path.join("videos", file))
    listDirectory = os.listdir("videos")
    os.chdir(directory)
    f = open("videos.csv", "w")
    f.writelines(os.path.join(os.getcwd(), f + '\n') for f in listDirectory)
    f = open('videos.csv', 'r')
    w = open('output.csv', 'w')
    f_cont = f.readlines()
    for line in f_cont:
        regex = re.compile("\b[GHI]:")
        re.sub(regex, "Z:", line)
        w.write(line)
        f.close()

createCSV()

