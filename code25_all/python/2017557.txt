def run_program(cmd_str):
    """Run the specified command, returning its output as an array of lines"""
    dprint("run_program(%s): entering" % cmd_str)
    cmd_args = cmd_str.split()
    subproc = subprocess.Popen(cmd_args, stdout=subprocess.PIPE,
                               stderr=subprocess.PIPE, shell=True)
    (outf, errf) = (subproc.stdout, subproc.stderr)
    olines = outf.readlines()
    elines = errf.readlines()
    if Options.debug:
        if elines:
            dprint('Error output:')
            for line in elines:
                dprint(line.rstrip())
        if olines:
            dprint('Normal output:')
            for line in olines:
                dprint(line.rstrip())
    errf.close()
    outf.close()
    res = subproc.wait()
    dprint('wait result=', res)
    return (res, olines)

(res, o) = run_program('bcdedit /set {current} MSI forcedisable')

bcdedit is not recognized as an internal or external command,
operable program or batch file

