import router, pdb

# creates nodes which encapsulate RandomVector and VectorAdder objects
a = router.LocalNode(router.RandomVector, '/topic/a_c')
b = router.LocalNode(router.RandomVector, '/topic/b_c')
c = router.LocalNode(router.VectorAdder)
c.registerAsListener('/topic/a_c')
c.registerAsListener('/topic/b_c')

def conn():
    global a
    global b
    a.onConnect()
    b.onConnect()


router.r.loadOnConnect(conn)
router.STOMPconnect(router.r)
router.reactor.run()

def onConnect(self):
    self._lc = LoopingCall(self.advance)
    self._lc.start(1)

