 COPY  tmp_geoheader  FROM  '/<census_upload_root>/acs2010_5yr/All_Geographies_Not_Tracts_Block_Groups/g20105ak.txt';
COPY  tmp_geoheader  FROM  '/<census_upload_root>/acs2010_5yr/All_Geographies_Not_Tracts_Block_Groups/g20105al.txt';
COPY  tmp_geoheader  FROM  '/<census_upload_root>/acs2010_5yr/All_Geographies_Not_Tracts_Block_Groups/g20105ar.txt';
COPY  tmp_geoheader  FROM  '/<census_upload_root>/acs2010_5yr/All_Geographies_Not_Tracts_Block_Groups/g20105az.txt';
COPY  tmp_geoheader  FROM  '/<census_upload_root>/acs2010_5yr/All_Geographies_Not_Tracts_Block_Groups/g20105ca.txt';
COPY  tmp_geoheader  FROM  '/<census_upload_root>/acs2010_5yr/All_Geographies_Not_Tracts_Block_Groups/g20105co.txt';
COPY  tmp_geoheader  FROM  '/<census_upload_root>/acs2010_5yr/All_Geographies_Not_Tracts_Block_Groups/g20105ct.txt';
COPY  tmp_geoheader  FROM  '/<census_upload_root>/acs2010_5yr/All_Geographies_Not_Tracts_Block_Groups/g20105dc.txt';
COPY  tmp_geoheader  FROM  '/<census_upload_root>/acs2010_5yr/All_Geographies_Not_Tracts_Block_Groups/g20105de.txt';
COPY  tmp_geoheader  FROM  '/<census_upload_root>/acs2010_5yr/All_Geographies_Not_Tracts_Block_Groups/g20105fl.txt';
COPY  tmp_geoheader  FROM  '/<census_upload_root>/acs2010_5yr/All_Geographies_Not_Tracts_Block_Groups/g20105ga.txt';
COPY  tmp_geoheader  FROM  '/<census_upload_root>/acs2010_5yr/All_Geographies_Not_Tracts_Block_Groups/g20105hi.txt';
COPY  tmp_geoheader  FROM  '/<census_upload_root>/acs2010_5yr/All_Geographies_Not_Tracts_Block_Groups/g20105ia.txt';
COPY  tmp_geoheader  FROM  '/<census_upload_root>/acs2010_5yr/All_Geographies_Not_Tracts_Block_Groups/g20105id.txt';
COPY  tmp_geoheader  FROM  '/<census_upload_root>/acs2010_5yr/All_Geographies_Not_Tracts_Block_Groups/g20105il.txt';
COPY  tmp_geoheader  FROM  '/<census_upload_root>/acs2010_5yr/All_Geographies_Not_Tracts_Block_Groups/g20105in.txt';
COPY  tmp_geoheader  FROM  '/<census_upload_root>/acs2010_5yr/All_Geographies_Not_Tracts_Block_Groups/g20105ks.txt';
COPY  tmp_geoheader  FROM  '/<census_upload_root>/acs2010_5yr/All_Geographies_Not_Tracts_Block_Groups/g20105ky.txt';
COPY  tmp_geoheader  FROM  '/<census_upload_root>/acs2010_5yr/All_Geographies_Not_Tracts_Block_Groups/g20105la.txt';
COPY  tmp_geoheader  FROM  '/<census_upload_root>/acs2010_5yr/All_Geographies_Not_Tracts_Block_Groups/g20105ma.txt';
COPY  tmp_geoheader  FROM  '/<census_upload_root>/acs2010_5yr/All_Geographies_Not_Tracts_Block_Groups/g20105md.txt';
COPY  tmp_geoheader  FROM  '/<census_upload_root>/acs2010_5yr/All_Geographies_Not_Tracts_Block_Groups/g20105me.txt';
COPY  tmp_geoheader  FROM  '/<census_upload_root>/acs2010_5yr/All_Geographies_Not_Tracts_Block_Groups/g20105mi.txt';
COPY  tmp_geoheader  FROM  '/<census_upload_root>/acs2010_5yr/All_Geographies_Not_Tracts_Block_Groups/g20105mn.txt';
COPY  tmp_geoheader  FROM  '/<census_upload_root>/acs2010_5yr/All_Geographies_Not_Tracts_Block_Groups/g20105mo.txt';
COPY  tmp_geoheader  FROM  '/<census_upload_root>/acs2010_5yr/All_Geographies_Not_Tracts_Block_Groups/g20105ms.txt';
COPY  tmp_geoheader  FROM  '/<census_upload_root>/acs2010_5yr/All_Geographies_Not_Tracts_Block_Groups/g20105mt.txt';
COPY  tmp_geoheader  FROM  '/<census_upload_root>/acs2010_5yr/All_Geographies_Not_Tracts_Block_Groups/g20105nc.txt';
COPY  tmp_geoheader  FROM  '/<census_upload_root>/acs2010_5yr/All_Geographies_Not_Tracts_Block_Groups/g20105nd.txt';
COPY  tmp_geoheader  FROM  '/<census_upload_root>/acs2010_5yr/All_Geographies_Not_Tracts_Block_Groups/g20105ne.txt';
COPY  tmp_geoheader  FROM  '/<census_upload_root>/acs2010_5yr/All_Geographies_Not_Tracts_Block_Groups/g20105nh.txt';
COPY  tmp_geoheader  FROM  '/<census_upload_root>/acs2010_5yr/All_Geographies_Not_Tracts_Block_Groups/g20105nj.txt';
COPY  tmp_geoheader  FROM  '/<census_upload_root>/acs2010_5yr/All_Geographies_Not_Tracts_Block_Groups/g20105nm.txt';
COPY  tmp_geoheader  FROM  '/<census_upload_root>/acs2010_5yr/All_Geographies_Not_Tracts_Block_Groups/g20105nv.txt';
COPY  tmp_geoheader  FROM  '/<census_upload_root>/acs2010_5yr/All_Geographies_Not_Tracts_Block_Groups/g20105ny.txt';
COPY  tmp_geoheader  FROM  '/<census_upload_root>/acs2010_5yr/All_Geographies_Not_Tracts_Block_Groups/g20105oh.txt';
COPY  tmp_geoheader  FROM  '/<census_upload_root>/acs2010_5yr/All_Geographies_Not_Tracts_Block_Groups/g20105ok.txt';
COPY  tmp_geoheader  FROM  '/<census_upload_root>/acs2010_5yr/All_Geographies_Not_Tracts_Block_Groups/g20105or.txt';
COPY  tmp_geoheader  FROM  '/<census_upload_root>/acs2010_5yr/All_Geographies_Not_Tracts_Block_Groups/g20105pa.txt';
COPY  tmp_geoheader  FROM  '/<census_upload_root>/acs2010_5yr/All_Geographies_Not_Tracts_Block_Groups/g20105pr.txt';
COPY  tmp_geoheader  FROM  '/<census_upload_root>/acs2010_5yr/All_Geographies_Not_Tracts_Block_Groups/g20105ri.txt';
COPY  tmp_geoheader  FROM  '/<census_upload_root>/acs2010_5yr/All_Geographies_Not_Tracts_Block_Groups/g20105sc.txt';
COPY  tmp_geoheader  FROM  '/<census_upload_root>/acs2010_5yr/All_Geographies_Not_Tracts_Block_Groups/g20105sd.txt';
COPY  tmp_geoheader  FROM  '/<census_upload_root>/acs2010_5yr/All_Geographies_Not_Tracts_Block_Groups/g20105tn.txt';
COPY  tmp_geoheader  FROM  '/<census_upload_root>/acs2010_5yr/All_Geographies_Not_Tracts_Block_Groups/g20105tx.txt';
COPY  tmp_geoheader  FROM  '/<census_upload_root>/acs2010_5yr/All_Geographies_Not_Tracts_Block_Groups/g20105us.txt';
COPY  tmp_geoheader  FROM  '/<census_upload_root>/acs2010_5yr/All_Geographies_Not_Tracts_Block_Groups/g20105ut.txt';
COPY  tmp_geoheader  FROM  '/<census_upload_root>/acs2010_5yr/All_Geographies_Not_Tracts_Block_Groups/g20105va.txt';
COPY  tmp_geoheader  FROM  '/<census_upload_root>/acs2010_5yr/All_Geographies_Not_Tracts_Block_Groups/g20105vt.txt';
COPY  tmp_geoheader  FROM  '/<census_upload_root>/acs2010_5yr/All_Geographies_Not_Tracts_Block_Groups/g20105wa.txt';
COPY  tmp_geoheader  FROM  '/<census_upload_root>/acs2010_5yr/All_Geographies_Not_Tracts_Block_Groups/g20105wi.txt';
COPY  tmp_geoheader  FROM  '/<census_upload_root>/acs2010_5yr/All_Geographies_Not_Tracts_Block_Groups/g20105wv.txt';
COPY  tmp_geoheader  FROM  '/<census_upload_root>/acs2010_5yr/All_Geographies_Not_Tracts_Block_Groups/g20105wy.txt';
 
ï»¿--Requires PostGIS Extension!

SET search_path = acs2010_5yr, public; --Change target schema if other than acs2010_5yr

CREATE SEQUENCE geoheader_gid_seq;
ALTER TABLE geoheader 
	ADD COLUMN geom geometry(MultiPolygon, 4269),
	ADD COLUMN gid int NOT NULL DEFAULT nextval('geoheader_gid_seq');
CREATE INDEX ON geoheader USING gist (geom);

--Add spatial layers for some common Census geographies.
--Assumes spatial tables have names matching filename from Census FTP site.

--States (sumlevel = 40 or '040')
--Import tl_2010_us_state10 with shp2pgsql
UPDATE geoheader g
SET geom = t.geom
FROM tl_2010_us_state10 t
WHERE g.sumlevel = 40 AND split_part(g.geoid, 'US', 2) = t.geoid10
;

CREATE OR REPLACE VIEW geo_state AS
SELECT 
	gid,
	geoid,
	name,
	geom
FROM geoheader
WHERE sumlevel = 40 and component = '00'
;

--Counties (sumlevel = 50 or '050')
--Import tl_2010_us_county10 with shp2pgsql
UPDATE geoheader g
SET geom = t.geom
FROM tl_2010_us_county10 t
WHERE g.sumlevel = 50 AND split_part(g.geoid, 'US', 2) = t.geoid10
;

CREATE OR REPLACE VIEW geo_county AS
SELECT 
	gid,
	geoid,
	name,
	geom
FROM geoheader
WHERE sumlevel = 50 and component = '00'
;

--Tracts (sumlevel = 140)
--Import tl_2010_*_tract10 by state with shp2pgsql
UPDATE geoheader g
SET geom = t.geom
FROM tl_2010_us_tract10 t
WHERE g.sumlevel = 140 AND split_part(g.geoid, 'US', 2) = t.geoid10
;

CREATE OR REPLACE VIEW geo_tract AS
SELECT 
	gid,
	geoid,
	name,
	geom
FROM geoheader
WHERE sumlevel = 140 and component = '00'
;
