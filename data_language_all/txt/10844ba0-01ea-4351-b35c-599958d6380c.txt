Important Note
This program is not bug free and it may not work on all the devices.
If you have a working program, feel free to make a pull request.