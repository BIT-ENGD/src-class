#!/bin/bash
set -e -f -o pipefail
source "/usr/local/etc/babun.instance"
source "$babun_tools/script.sh"

for root_dir in $(find / -maxdepth 1 -type l)
do		
	link_target=$(readlink $root_dir)

	if [[ "$link_target" =~ ^\/cygdrive\/.$ ]]; then
		rm "$root_dir" || true
	fi
done

if ! [[ "$DISABLE_PLUGIN_CYGDRIVE" == "true" ]]; then

	for cygdrive_dir in $(find /cygdrive/ -maxdepth 1 -type d 2>/dev/null)
	do
		drive_name=$(basename $cygdrive_dir)

		if [[ "$drive_name" != "cygdrive" ]]; then
			ln -s "$cygdrive_dir" "/$drive_name"
		fi
	done
	
ficite 'about-alias'
about-alias 'homesick aliases'

# Aliases
alias sikhm="homesick cd dotfiles"
alias sikclone="homesick clone"
alias sikcomt="homesick commit dotfiles"
alias sikdstry="homesick destroy"
alias sikdif="homesick diff dotfiles"
alias sikexec="homesick exec dotfiles"
alias sikexeca="homesick exec_all"
alias sikgen="homesick generate"
alias sikhlp="homesick help"
alias siklnk="homesick link dotfiles"
alias sikls="homesick list"
alias sikopn="homesick open dotfiles"
alias sikpll="homesick pull dotfiles"
alias sikpsh="homesick push dotfiles"
alias sikrc="homesick rc dotfiles"
alias sikpth="homesick show_path dotfiles"
alias sikst="homesick status dotfiles"
alias siktrk="homesick track $1 dotfiles"
alias sikulnk="homesick unlink dotfiles"
alias sikv="homesick version"
cite 'about-alias'
about-alias 'jitsu task abbreviations'

# jitsu
alias j='jitsu'
alias jl='jitsu login'
alias jo='jitsu logout'

# deploy and update
alias jd='jitsu apps deploy'
alias ju='jitsu apps update'

# new and start, restart, stop
alias jn='jitsu apps create'
alias js='jitsu apps start'
alias jr='jitsu apps restart'
alias jx='jitsu apps stop'

# logs
alias jll='jitsu logs'
alias jlog='jitsu logs'
alias jlogs='jitsu logs'

# env
alias je='jitsu env'
alias jel='jitsu env list'
alias jes='jitsu env set'
alias jeg='jitsu env get'
alias jed='jitsu env delete'
alias jec='jitsu env clear'
alias jesv='jitsu env save'
alias jeld='jitsu env load'

# configuration
alias jc='jitsu conf'
alias jcl='jitsu config list'
alias jcs='jitsu config set'
alias jcg='jitsu config get'
alias jcd='jitsu config delete'

#  list and install, view
alias jls='jitsu list'
alias jin='jitsu install'
alias jv='jitsu apps view'

# Database, Snapshots and Tokens
alias jdb='jitsu databases'
alias jss='jitsu snapshots'
alias jto='jitsu tokens'
