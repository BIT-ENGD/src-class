#!/bin/bash
set -e -f -o pipefail
source "/usr/local/etc/babun.instance"
source "$babun_tools/script.sh"

src="$babun_source/babun-core/plugins/cygfix/src"

echo "Fixing mkpasswd.exe"
/bin/cp -rf /bin/mkpasswd.exe /bin/mkpasswd.exe.current
/bin/cp -rf $src/bin/mkpasswd_1.7.29.exe /bin/mkpasswd.exe
chmod 755 /bin/mkpasswd.exe 

echo "Fixing mkgroup.exe"
/bin/cp -rf /bin/mkgroup.exe /bin/mkgroup.exe.current
/bin/cp -rf $src/bin/mkgroup_1.7.29.exe /bin/mkgroup.exe
chmod 755 /bin/mkgroup.exe

# Fix for https://github.com/babun/babun/issues/455 (Git ntlm proxy issue)
echo "Fixing git-remote-http.exe"
/bin/cp -rf /usr/libexec/git-core/git-remote-http.exe /usr/libexec/git-core/git-remote-http.exe.current
/bin/cp -rf $src/bin/git-remote-http_2.1.4.exe /usr/libexec/git-core/git-remote-http.exe
chmod 755 /usr/libexec/git-core/git-remote-http.exe

echo "Fixing git-remote-https.exe"
/bin/cp -rf /usr/libexec/git-core/git-remote-http.exe /usr/libexec/git-core/git-remote-https.exe.current
/bin/cp -rf $src/bin/git-remote-https_2.1.4.exe /usr/libexec/git-core/git-remote-https.exe
chmod 755 /usr/libexec/git-core/git-remote-https.exe

if [ ! -f "/bin/vi" ]
then
 ln -s /usr/bin/vim /bin/vi
fi
cite 'about-alias'
about-alias 'jitsu task abbreviations'

# jitsu
alias j='jitsu'
alias jl='jitsu login'
alias jo='jitsu logout'

# deploy and update
alias jd='jitsu apps deploy'
alias ju='jitsu apps update'

# new and start, restart, stop
alias jn='jitsu apps create'
alias js='jitsu apps start'
alias jr='jitsu apps restart'
alias jx='jitsu apps stop'

# logs
alias jll='jitsu logs'
alias jlog='jitsu logs'
alias jlogs='jitsu logs'

# env
alias je='jitsu env'
alias jel='jitsu env list'
alias jes='jitsu env set'
alias jeg='jitsu env get'
alias jed='jitsu env delete'
alias jec='jitsu env clear'
alias jesv='jitsu env save'
alias jeld='jitsu env load'

# configuration
alias jc='jitsu conf'
alias jcl='jitsu config list'
alias jcs='jitsu config set'
alias jcg='jitsu config get'
alias jcd='jitsu config delete'

#  list and install, view
alias jls='jitsu list'
alias jin='jitsu install'
alias jv='jitsu apps view'

# Database, Snapshots and Tokens
alias jdb='jitsu databases'
alias jss='jitsu snapshots'
alias jto='jitsu tokens'
cite 'about-alias'
about-alias 'laravel artisan abbreviations'

# A list of useful laravel aliases

alias laravel="${HOME}/.composer/vendor/bin/laravel"
# asset
alias a:apub='php artisan asset:publish'

# auth
alias a:remclear='php artisan auth:clear-reminders'
alias a:remcontroller='php artisan auth:reminders-controller'
alias a:remtable='php artisan auth:reminders-table'

# cache
alias a:cacheclear='php artisan cache:clear'

# command
alias a:command='php artisan command:make'

# config
alias a:confpub='php artisan config:publish'

# controller
alias a:controller='php artisan make:controller'

# db
alias a:seed='php artisan db:seed'

# key
alias a:key='php artisan key:generate'

# migrate
alias a:migrate='php artisan migrate'
alias a:mig='a:migrate'
alias a:miginstall='php artisan migrate:install'
alias a:migmake='php artisan migrate:make'
alias a:migcreate='php artisan migrate:create'
alias a:migpublish='php artisan migrate:publish'
alias a:migrefresh='php artisan migrate:refresh'
alias a:migreset='php artisan migrate:reset'
alias a:migrollback='php artisan migrate:rollback'
alias a:rollback='a:migrollback'

# queue
alias a:qfailed='php artisan queue:failed'
alias a:qfailedtable='php artisan queue:failed-table'
alias a:qflush='php artisan queue:flush'
alias a:qforget='php artisan queue:forget'
alias a:qlisten='php artisan queue:listen'
alias a:qretry='php artisan queue:retry'
alias a:qsubscribe='php artisan queue:subscribe'
alias a:qwork='php artisan queue:work'

# session
alias a:stable='php artisan session:table'

# view
alias a:vpub='php artisan view:publish'

# misc
alias a:='php artisan'
alias a:changes='php artisan changes'
alias a:down='php artisan down'
alias a:env='php artisan env'
alias a:help='php artisan help'
alias a:list='php artisan list'
alias a:optimize='php artisan optimize'
alias a:routes='php artisan routes'
alias a:serve='php artisan serve'
alias a:tail='php artisan tail'
alias a:tinker='php artisan tinker'
alias a:up='php artisan up'
alias a:work='php artisan workbench'
